
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mak et al, 2015 &#8212; LivingPark Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'replications/mak-etal-2015/mak-etal-2015';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Replication of [E. Mak et al., 2017]" href="../mak-etal-2017/README.html" />
    <link rel="prev" title="Replication of [E. Mak et al., 2015]" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="LivingPark Book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="LivingPark Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    LivingPark
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">A note on Reproducibility vs. Replicability</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../technical_challenges.html">Data Usage Agreement</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reproducibility studies (Harmonization [WIP])</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../agosta-etal-2013/README.html">F. Agosta et al., 2013</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../agosta-etal-2013/agosta-etal.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hanganu-etal-2014/README.html">A. Hanganu et al., 2014</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hanganu-etal-2014/hanganu-etal-2014.html">Replication: Hanganu <em>et al.</em>, 2014</a></li>














</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">E. Mak et al., 2015</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Mak et al, 2015</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mak-etal-2017/README.html">E. Mak et al., 2017</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2017/cohort_definition.html">Replication: Mak et al., 2017</a></li>



<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2017/fsl_siena.html">Failed DICOM to NIfTI conversion</a></li>

<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2017/stat_analysis.html">Comparisons of percentage brain volume change and ventricular enlargement</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rahayel-etal-2018/README.html">S. Rahayel et al., 2018</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../rahayel-etal-2018/rahayel-etal-2018.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scherfler-etal-2011/README.html">C. Scherfler et al., 2011</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../scherfler-etal-2011/scherfler-etal.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shu-etal-2021/README.html">Z. Shu et al., 2021</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shu-etal-2021/shu-etal.html">Replication: Shu <em>et al</em>, 2020</a></li>




</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sterling-etal-2016/README.html">N. W. Sterling et al., 2016</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sterling-etal-2016/sterling-etal-2016.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tessa-etal-2014/README.html">C. Tessa et al., 2014</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tessa-etal-2014/Replication%20-%20%20Tessa%20et%20al.%202014.html">Introduction</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../zeighami-etal-2015/README.html">Y. Zeighami et al., 2015</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../zeighami-etal-2015/Yashar%20et.%20al%202015.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../zeighami-etal-2019/README.html">Y. Zeighami et al., 2019</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../zeighami-etal-2019/zeighami-etal-2019.html">Replication</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Utility packages</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../packages/ppmi_downloader.html">PPMI_Downloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../packages/livingpark_utils.html">LivingPark_Utils</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About LivingPark</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/LivingPark-MRI/">Organization repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/LivingPark-MRI/livingpark-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/LivingPark-MRI/livingpark-book/issues/new?title=Issue%20on%20page%20%2Freplications/mak-etal-2015/mak-etal-2015.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/replications/mak-etal-2015/mak-etal-2015.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mak et al, 2015</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Mak et al, 2015</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-modules">Importing modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-preparation">Cohort Preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ppmi-study-data-files-download">PPMI study data files download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#livingpark-utility-notebook-download">LivingPark utility notebook download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data Exploration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demographics-characteristics">Demographics Characteristics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-definition">Cohort Definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cognitive-state">Cognitive State</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#age-at-visit">Age at visit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gender">Gender</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#education">Education</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disease-duration">Disease duration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clinical-characteristics">Clinical Characteristics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#levodopa-equivalent-daily-dose-ledd">Levodopa equivalent daily dose (LEDD)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hoehn-and-yahr-staging-h-y">Hoehn and Yahr staging (H&amp;Y)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unified-parkinsons-disease-rating-scale-updrs-iii">Unified Parkinson’s Disease Rating Scale (UPDRS III)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#montreal-cognitive-assessment-moca">Montreal Cognitive Assessment (MoCA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-mental-state-examination-mmse">Mini-Mental State Examination (MMSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geriatric-depression-scale-gds">Geriatric Depression Scale (GDS)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mri-availabilty">MRI Availabilty</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-aggregation">Data aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acceptable-visit-pairs">Acceptable visit pairs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-summary">Cohort Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-with-follow-up-after-12-months">Cohort with follow-up after 12 months</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-with-follow-up-after-24-months">Cohort with follow-up after 24 months</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-follow-up-after-both-12-and-24-months">Cohort follow up after both 12 and 24 months</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paper-replication">Paper replication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-processing">Image Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subcortical-structures">Subcortical Structures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-1-cross-sectional">preprocessing step 1 - cross-sectional</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-2-base-template">preprocessing step 2 - base template</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-3-longitudinally-processed-timepoints">preprocessing step 3 - longitudinally processed timepoints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-4-qcache">preprocessing step 4 - Qcache</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-quality-control">Image quality control</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axial-baseline">Axial - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coronal-baseline">Coronal - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sagittal-baseline">Sagittal - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axial-longitudinal">Axial - longitudinal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coronal-longitudinal">Coronal - longitudinal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sagittal-longitudinal">Sagittal - longitudinal</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subcortical-structures-volume-computation">Subcortical Structures volume computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volumetric-analysis-of-subcortical-structures">Volumetric analysis of subcortical structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-covariance-ancova">Analysis of covariance (ANCOVA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-hoc-tukey-kramer-pairwise-comparisons">Post hoc Tukey-Kramer pairwise comparisons</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline-volumes">Baseline volumes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change">% change</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-analysis">Vertex-wise analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-the-vertex-data-with-long-mris-slopes-for-longitudinal-two-stage-model">Prepare the vertex data with long_mris_slopes for longitudinal two stage model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-baseline-t-test">Create FSGD file for the group analysis - baseline - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-baseline-t-test">Stack images for group analyses - baseline - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-longitudinal-t-test">Create FSGD file for the group analysis - longitudinal - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-longitudinal-t-test">Stack images for group analyses - longitudinal - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-baseline-t-test">Run GLM model for the group analysis - baseline - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-longitudinal-t-test">Run GLM model for the group analysis - longitudinal - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-for-multiple-comparison-with-mri-glmfit-sim-t-test">Correction for multiple comparison (with mri_glmfit-sim) - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-baseline-ancova">Create FSGD file for the group analysis - baseline - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-baseline-ancova">Stack images for group analyses - baseline - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-longitudinal-ancova">Create FSGD file for the group analysis - longitudinal - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-longitudinal-ancova">Stack images for group analyses - longitudinal - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-correlational-analysis-baseline">Create FSGD file for the correlational analysis - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-correlational-analyses-baseline">Stack images for correlational analyses - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-correlational-analysis-baseline">Run GLM model for the correlational analysis - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-baseline-ancova">Run GLM model for the group analysis - baseline - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-longitudinal-ancova">Run GLM model for the group analysis - longitudinal - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-for-multiple-comparison-with-mri-glmfit-sim">Correction for multiple comparison (with mri_glmfit-sim)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-results">Vertex-wise results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-with-moca-baseline">correlation with MoCA - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-baseline-ancova">group differences - baseline - ANCOVA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differences-in-baseline-cortical-thickness-in-patients-with-parkinsons-disease">Differences in baseline cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-longitudinal-data-ancova">group differences - longitudinal data - ANCOVA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#longitudinal-differences-in-the-cortical-thickness-in-patients-with-parkinsons-disease">Longitudinal differences in the cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-baseline-t-test">group differences - baseline - t-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differences-in-the-baseline-cortical-thickness-in-patients-with-parkinsons-disease">Differences in the baseline cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-longitudinal-t-test">group differences - longitudinal - t-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Longitudinal differences in the cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mak-et-al-2015">
<h1>Mak et al, 2015<a class="headerlink" href="#mak-et-al-2015" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this notebook we will identify PPMI subjects to reproduce the following paper:</p>
<div class="alert alert-block alert-success"> E. Mak et al., <a href="https://academic.oup.com/brain/article/138/10/2974/2468704?login=false" style="text-decoration: none;">“Baseline and longitudinal grey matter changes in newly diagnosed Parkinson’s disease: ICICLE-PD study,”</a> Brain, vol. 138, no. 10, pp. 2974–2986, 2015.
</div><p>This study involved 105 subjects with newly diagnosed idiopathic Parkinson’s disease (PD) and 37 healthy matched controls.</p>
<p>Among the 105 PD subjects, they classified 39 subjects as PD with mild cognitive impairment (PD-MCI) and 66 subjects as PD with no cognitive impairment (PD-NC).</p>
<p>The demographics and clinical characteristics were as follows (table extracted from the paper):</p>
<img src="images/cohort_table.jpeg"/><p>The subjects had a serial 3 T structural magnetic resonance imaging (MRI) scans with clinical and neuropsychological assessments at baseline and, at 18 months follow-up.</p>
<p>These MRI were processed with Freesurfer, an image processing software, to measure the cortical thickness and subcortical volumes at baseline and follow-up.</p>
<p>The key result of the paper reveals that PD-MCI shows more extensive atrophy and greater percentage of cortical thinning compared to PD-NC, as illustrated below in Table 2 and Figure 2C (extracted from paper) respectively.</p>
<img src="images/change_in_subcortical_volumes.jpeg"/><figure>
<img src="images/change_in_cortical_thinning.jpg"/>
<figcaption>
    <b>Figure 2C. Vertex-wise comparisons of percentage change in cortical thinning over 18 months.</b>
    The colour bar shows the logarithmic scale of P-values (−log10). Lh = left hemisphere; Rh = right hemisphere.</figcaption>
</figure>
<p>In this notebook, we aim at reproducing these results using the PPMI dataset.</p>
</section>
<section id="importing-modules">
<h2>Importing modules<a class="headerlink" href="#importing-modules" title="Link to this heading">#</a></h2>
<p>First, let’s initialize the notebook by installing software dependencies and importing libraries that we’re going to use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rich</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">getpass</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">paramiko</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">livingpark_utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pingouin</span><span class="w"> </span><span class="kn">import</span> <span class="n">ancova</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rich.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.notebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Iterable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">clinical</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils.scripts</span><span class="w"> </span><span class="kn">import</span> <span class="n">run</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">ppmi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils.maketal</span><span class="w"> </span><span class="kn">import</span> <span class="n">maketal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">livingpark_utils.visualization</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">visualization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.multicomp</span><span class="w"> </span><span class="kn">import</span> <span class="n">pairwise_tukeyhsd</span>

<span class="n">inputs_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;inputs/study_files&quot;</span><span class="p">)</span>
<span class="n">outputs_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;outputs&quot;</span><span class="p">)</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>

<span class="n">utils</span> <span class="o">=</span> <span class="n">livingpark_utils</span><span class="o">.</span><span class="n">LivingParkUtils</span><span class="p">()</span>
<span class="n">downloader</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">ppmi</span><span class="o">.</span><span class="n">Downloader</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">notebook_init</span><span class="p">()</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This notebook was run on 2023-03-03 19:34:19 UTC +0000
</pre></div>
</div>
</div>
</div>
</section>
<section id="cohort-preparation">
<h2>Cohort Preparation<a class="headerlink" href="#cohort-preparation" title="Link to this heading">#</a></h2>
<p>The first step in reproducing the paper is to build a PPMI cohort that looks the closest to Table 1. For this, we will use PPMI Study Data files.</p>
</section>
<section id="ppmi-study-data-files-download">
<h2>PPMI study data files download<a class="headerlink" href="#ppmi-study-data-files-download" title="Link to this heading">#</a></h2>
<p>The required PPMI study files to build the cohort are:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Files</p></th>
<th class="head text-left"><p>Used to retrieve</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Demographics</p></td>
<td class="text-left"><p>gender</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Age at visit</p></td>
<td class="text-left"><p>age</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Socio-Economics</p></td>
<td class="text-left"><p>years of education</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Participant Status</p></td>
<td class="text-left"><p>PD subjects and healthy controls</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Primary Clinical Diagnosis</p></td>
<td class="text-left"><p>subjects with no PD nor other neurological disorder</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Cognitive Categorization</p></td>
<td class="text-left"><p>PD-MCI and PD-NC subjects</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>PD Diagnosis History</p></td>
<td class="text-left"><p>disease duration</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>MDS UPDRS Part III</p></td>
<td class="text-left"><p>Hoehn and Yahr scores</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>LEDD Concomitant Medication Log</p></td>
<td class="text-left"><p>LEDD scores</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Montreal Cognitive Assessment MoCA</p></td>
<td class="text-left"><p>MoCA and MMSE scores</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Geriatric Depression Scale Short Version</p></td>
<td class="text-left"><p>GDS scores</p></td>
</tr>
</tbody>
</table>
</div>
<p>We will use the LivingPark utils library to download these files from the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">required_files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Demographics.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Age_at_visit.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MDS_UPDRS_Part_III.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Socio-Economics.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LEDD_Concomitant_Medication_Log.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Montreal_Cognitive_Assessment__MoCA_.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PD_Diagnosis_History.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cognitive_Categorization.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Participant_Status.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Primary_Clinical_Diagnosis.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Geriatric_Depression_Scale__Short_Version_.csv&quot;</span>
<span class="p">]</span>

<span class="n">utils</span><span class="o">.</span><span class="n">get_study_files</span><span class="p">(</span><span class="n">required_files</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">downloader</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download skipped: No missing files!
</pre></div>
</div>
</div>
</div>
</section>
<section id="livingpark-utility-notebook-download">
<h2>LivingPark utility notebook download<a class="headerlink" href="#livingpark-utility-notebook-download" title="Link to this heading">#</a></h2>
<p>We will also import notebooks from LivingPark utils to clean data which produce the following files:</p>
<ul class="simple">
<li><p><code>MRI_info.csv</code>: contains 3D T1-weighted images by visit</p></li>
<li><p><code>MDS_UPDRS_Part_III_clean.csv</code>: contains cleaned-up PDSTATE and PDTRTMNT</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils.scripts</span><span class="w"> </span><span class="kn">import</span> <span class="n">mri_metadata</span>
<span class="n">run</span><span class="o">.</span><span class="n">mri_metadata</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">livingpark_utils.scripts</span><span class="w"> </span><span class="kn">import</span> <span class="n">pd_status</span>
<span class="n">run</span><span class="o">.</span><span class="n">pd_status</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-exploration">
<h2>Data Exploration<a class="headerlink" href="#data-exploration" title="Link to this heading">#</a></h2>
<p>Now that we have all the required files, we will start by preparing the data for cohort matching.</p>
<p>We will also analyze the PPMI dataset in order to gain a better understanding of the demographics and clinical characteristics of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Styling visualization plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#F2F5F9&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.edgecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#2A2A2A&#39;</span>
</pre></div>
</div>
</div>
</div>
<section id="demographics-characteristics">
<h3>Demographics Characteristics<a class="headerlink" href="#demographics-characteristics" title="Link to this heading">#</a></h3>
</section>
<section id="cohort-definition">
<h3>Cohort Definition<a class="headerlink" href="#cohort-definition" title="Link to this heading">#</a></h3>
<p>First, we will extract participants defined as healthy controls and diagnosed with Parkinson’s disease.</p>
<p>We obtain the following distribution of participants across the cohort in the PPMI dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">participants</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span> <span class="s2">&quot;Participant_Status.csv&quot;</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;COHORT&quot;</span><span class="p">])</span>
<span class="n">participants</span> <span class="o">=</span> <span class="n">participants</span><span class="p">[</span><span class="n">participants</span><span class="p">[</span><span class="s2">&quot;COHORT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span> <span class="c1"># Only keep PD(1) and HC(2).</span>

<span class="n">pd_patients</span> <span class="o">=</span> <span class="n">participants</span><span class="p">[</span><span class="n">participants</span><span class="p">[</span><span class="s2">&quot;COHORT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># Dataframe with PD only</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">participants</span><span class="p">[</span><span class="n">participants</span><span class="p">[</span><span class="s2">&quot;COHORT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># Dataframe with HC only</span>

<span class="n">prim_diag</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span> <span class="s2">&quot;Primary_Clinical_Diagnosis.csv&quot;</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;PRIMDIAG&quot;</span><span class="p">])</span>

<span class="c1"># Only keep no PD nor other neurological disorder (PRIMDIAG 17)</span>
<span class="n">prim_diag</span> <span class="o">=</span> <span class="n">prim_diag</span><span class="p">[</span><span class="n">prim_diag</span><span class="p">[</span><span class="s2">&quot;PRIMDIAG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">17</span><span class="p">])]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># If patient status is both PRIMDIAG 17 and COHORT 2, </span>
<span class="c1"># then patient is defined as healthy control</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">prim_diag</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PRIMDIAG&#39;</span><span class="p">])</span>

<span class="c1"># Merge PD, HC and PRIMDIAG</span>
<span class="n">cohort_def</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd_patients</span><span class="p">,</span> <span class="n">hc</span><span class="p">])</span>
<span class="n">cohort_def</span> <span class="o">=</span> <span class="n">cohort_def</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">cohort_def</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cohort</span> <span class="o">=</span> <span class="n">cohort_def</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;COHORT&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s2">&quot;Parkinson&#39;s Disease&quot;</span><span class="p">,</span> <span class="s2">&quot;Healthy Controls&quot;</span><span class="p">],</span> <span class="n">cohort</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Participants&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1b8c492831e7a2f6d14b50f67f6e295ffbab757a1652bc82745254215db57663.png" src="../../_images/1b8c492831e7a2f6d14b50f67f6e295ffbab757a1652bc82745254215db57663.png" />
</div>
</div>
</section>
<section id="cognitive-state">
<h3>Cognitive State<a class="headerlink" href="#cognitive-state" title="Link to this heading">#</a></h3>
<p>The original study differentiates between PD patients with and without MCI.</p>
<p>We will consult PPMI’s cognitive categorization to obtain its distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cogstate_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;Cognitive_Categorization.csv&quot;</span><span class="p">),</span>
                          <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;COGSTATE&quot;</span><span class="p">])</span>
<span class="c1"># Drop nan</span>
<span class="n">cogstate_df</span> <span class="o">=</span> <span class="n">cogstate_df</span><span class="p">[</span><span class="n">cogstate_df</span><span class="p">[</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span> 
<span class="c1"># Dropping all subjects with PDD</span>
<span class="n">cogstate_df</span> <span class="o">=</span> <span class="n">cogstate_df</span><span class="p">[</span><span class="n">cogstate_df</span><span class="p">[</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">]</span> 

<span class="n">cogstate</span> <span class="o">=</span> <span class="n">cogstate_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">])[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;NC&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;MCI&quot;</span><span class="p">})</span>
<span class="n">shared_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">cogstate</span><span class="p">[</span><span class="s2">&quot;NC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">cogstate</span><span class="p">[</span><span class="s2">&quot;MCI&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">cogstate</span><span class="p">[</span><span class="s2">&quot;NC&quot;</span><span class="p">][</span><span class="n">shared_index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distribution of Available NC Data by Visit&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Type of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">cogstate</span><span class="p">[</span><span class="s2">&quot;MCI&quot;</span><span class="p">][</span><span class="n">shared_index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distribution of Available MCI Data by Visit&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Type of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ebd289180fa2bddc10c560a2e3e541ccab5c882a1769dd59ebfbff8af7c8c8f7.png" src="../../_images/ebd289180fa2bddc10c560a2e3e541ccab5c882a1769dd59ebfbff8af7c8c8f7.png" />
<img alt="../../_images/45f0066d99c7ab01b9ba271df9ea714b73c5cd8d7e8345b20e9dc62d8fe7dd09.png" src="../../_images/45f0066d99c7ab01b9ba271df9ea714b73c5cd8d7e8345b20e9dc62d8fe7dd09.png" />
</div>
</div>
<p>Types of visits expressed as: BL-Baseline, PW-Premature Withdrawal, ST-Symptomatic Therapy, V<em>xx</em>-Visit <em>xx</em></p>
<p>The number of subjects with NC is significantly higher, as seen on the graphs above. Therefore, we will make sure to obtain MCI patients before NC ones.</p>
</section>
<section id="age-at-visit">
<h3>Age at visit<a class="headerlink" href="#age-at-visit" title="Link to this heading">#</a></h3>
<p>The patient’s age was recorded at each visit. To keep it simple, we will only show the age distribution at baseline while considering the age at specific visits for the cohort.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span> <span class="s2">&quot;Age_at_visit.csv&quot;</span><span class="p">),</span>
                     <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">])</span>

<span class="n">age_df</span><span class="p">[</span><span class="n">age_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BL&quot;</span><span class="p">][</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age(years)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of visits&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Age at Baseline&quot;</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Age range:&quot;</span><span class="p">,</span> <span class="n">age_df</span><span class="p">[</span><span class="n">age_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BL&quot;</span><span class="p">][</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> 
      <span class="n">age_df</span><span class="p">[</span><span class="n">age_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BL&quot;</span><span class="p">][</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average age:&quot;</span><span class="p">,</span><span class="n">age_df</span><span class="p">[</span><span class="n">age_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BL&quot;</span><span class="p">][</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Most common age:&quot;</span><span class="p">,</span><span class="n">age_df</span><span class="p">[</span><span class="n">age_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BL&quot;</span><span class="p">][</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Age range: 26.4 - 86.5
Average age: 62.87042594385285
Most common age: 63.3
</pre></div>
</div>
<img alt="../../_images/4f8535d80c771e3d7116789701ec922de4e39a7648639937f4adffbf5a5bf993.png" src="../../_images/4f8535d80c771e3d7116789701ec922de4e39a7648639937f4adffbf5a5bf993.png" />
</div>
</div>
<p>The age of the subjects ranges from 26 to 86, with an average age of 62. The most common age among the subjects is 63.</p>
</section>
<section id="gender">
<h3>Gender<a class="headerlink" href="#gender" title="Link to this heading">#</a></h3>
<p>We will look at PPMI’s demographics to get the gender distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">demo_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;Demographics.csv&quot;</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;SEX&quot;</span><span class="p">])</span>
<span class="n">demo_df</span><span class="p">[</span><span class="s2">&quot;SEX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">demo_df</span><span class="p">[</span><span class="s2">&quot;SEX&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">gender</span> <span class="o">=</span> <span class="n">demo_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;SEX&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Male&quot;</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">gender</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">gender</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Gender&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a2b8e028ba21292ca94778295d91e9e5389b91db5306c33da8387e228ab955df.png" src="../../_images/a2b8e028ba21292ca94778295d91e9e5389b91db5306c33da8387e228ab955df.png" />
</div>
</div>
<p>There is a higher number of males than females in the study.</p>
</section>
<section id="education">
<h3>Education<a class="headerlink" href="#education" title="Link to this heading">#</a></h3>
<p>Looking at PPMI’s socioeconomics, we obtain the following distribution by visit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socioecon_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;Socio-Economics.csv&quot;</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;EDUCYRS&quot;</span><span class="p">])</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">socioecon_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">events</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Type of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of </span><span class="se">\&quot;</span><span class="s2">Years of Education</span><span class="se">\&quot;</span><span class="s2"> records available by visit&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a410f7c70ed189b026097f952f82aa85f17acb6e976b5da9ca3730d2460b358d.png" src="../../_images/a410f7c70ed189b026097f952f82aa85f17acb6e976b5da9ca3730d2460b358d.png" />
</div>
</div>
<p>We notice that in the above graph, the years of education were mostly recorded at screening. Thus, we will only consider the latter as the other visits might limit the possibility to perform data aggregation for the cohort matching.</p>
<p>We obtain the following distribution of years of education at screening:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socioecon_df</span> <span class="o">=</span> <span class="n">socioecon_df</span><span class="p">[</span><span class="n">socioecon_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SC&quot;</span><span class="p">]</span>
<span class="n">socioecon_df</span> <span class="o">=</span> <span class="n">socioecon_df</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span>

<span class="n">socioecon_df</span><span class="p">[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Education (Years)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of </span><span class="se">\&quot;</span><span class="s2">Years of Education</span><span class="se">\&quot;</span><span class="s2"> records available at Screening&quot;</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Range of years of education:&quot;</span><span class="p">,</span> <span class="n">socioecon_df</span><span class="p">[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> 
      <span class="n">socioecon_df</span><span class="p">[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average years of education:&quot;</span><span class="p">,</span> <span class="n">socioecon_df</span><span class="p">[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Range of years of education: 0.0 - 30.0
Average years of education: 15.936936936936936
</pre></div>
</div>
<img alt="../../_images/6cbf19f68ee36adf6145da5a69f9e3487097598f4c60f4beda8982cc14712819.png" src="../../_images/6cbf19f68ee36adf6145da5a69f9e3487097598f4c60f4beda8982cc14712819.png" />
</div>
</div>
<p>The education levels of the subjects vary from 0 to 30 years, with an average of 15 years of education.</p>
</section>
<section id="disease-duration">
<h3>Disease duration<a class="headerlink" href="#disease-duration" title="Link to this heading">#</a></h3>
<p>Looking at the disease duration of the subjects, we obtain the following distribution by visit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pddxdt_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;PD_Diagnosis_History.csv&quot;</span><span class="p">),</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;PDDXDT&quot;</span><span class="p">])</span>

<span class="n">events</span> <span class="o">=</span> <span class="n">pddxdt_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">events</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of </span><span class="se">\&quot;</span><span class="s2">Disease Duration</span><span class="se">\&quot;</span><span class="s2"> records available by visit&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/476f261a8c0538cc951b6bce9603722f8875ce4ee1f4ad9174b866aad8482a6a.png" src="../../_images/476f261a8c0538cc951b6bce9603722f8875ce4ee1f4ad9174b866aad8482a6a.png" />
</div>
</div>
<p>Similar to the previous section, we will only use PD diagnosis duration taken at screening since it has the most records as shown in the graph above.</p>
<p>We obtain the following distribution of disease duration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdxdur_df</span> <span class="o">=</span> <span class="n">ppmi</span><span class="o">.</span><span class="n">disease_duration</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">)</span>

<span class="n">pdxdur_df</span><span class="p">[</span><span class="s2">&quot;PDXDUR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Disease duration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of </span><span class="se">\&quot;</span><span class="s2">Disease Duration</span><span class="se">\&quot;</span><span class="s2"> records&quot;</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average duration of disease:&quot;</span><span class="p">,</span> <span class="n">pdxdur_df</span><span class="p">[</span><span class="s2">&quot;PDXDUR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Most common disease duration:&quot;</span><span class="p">,</span> <span class="n">pdxdur_df</span><span class="p">[</span><span class="s2">&quot;PDXDUR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download skipped: No missing files!
Average duration of disease: 5.196050995024875
Most common disease duration: 2.0
</pre></div>
</div>
<img alt="../../_images/6eb40da2a6e565d7cc79c80982d78079c3cf1a2402f415b4d1d4cb2180153a64.png" src="../../_images/6eb40da2a6e565d7cc79c80982d78079c3cf1a2402f415b4d1d4cb2180153a64.png" />
</div>
</div>
<p>The average duration of the disease among the subjects is 5 months, with the most common disease duration being 2 months.</p>
</section>
<section id="clinical-characteristics">
<h3>Clinical Characteristics<a class="headerlink" href="#clinical-characteristics" title="Link to this heading">#</a></h3>
</section>
<section id="levodopa-equivalent-daily-dose-ledd">
<h3>Levodopa equivalent daily dose (LEDD)<a class="headerlink" href="#levodopa-equivalent-daily-dose-ledd" title="Link to this heading">#</a></h3>
<p>Analyzing the LEDD of the subjects, we observe the following distribution by visit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ledd_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;LEDD_Concomitant_Medication_Log.csv&quot;</span><span class="p">),</span>
                     <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;LEDD&quot;</span><span class="p">])</span>

<span class="n">events</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">events</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of </span><span class="se">\&quot;</span><span class="s2">Levodopa equivalent daily dose</span><span class="se">\&quot;</span><span class="s2"> records available by visit&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/647f4e797d71797294029465840533ca89ed214aaf0b2f18ff77afc2c6c8c421.png" src="../../_images/647f4e797d71797294029465840533ca89ed214aaf0b2f18ff77afc2c6c8c421.png" />
</div>
</div>
<p>Likewise, as seen in the graph above, LEDD was mostly recorded at logs. Therefore, we will only consider LEDD at logs.</p>
<p>The distribution of LEDD is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ledd_df</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="p">[</span><span class="n">ledd_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LOG&quot;</span><span class="p">]</span>
<span class="n">ledd_df</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;LEDD&quot;</span><span class="p">]]</span>

<span class="c1"># For PD medications except COMT inhibitors, the column LEDD will show the value of the</span>
<span class="c1"># Levodopa equivalent dose for that medication. </span>

<span class="c1"># For COMT inhibitors, the column LEDD will read “LD x 0.33” (for Entacapone) or “LD x 0.5” </span>
<span class="c1"># (for Tolcapone). </span>

<span class="c1"># To find the LEDD for COMT inhibitors, first find the total dose of Levodopa only, </span>
<span class="c1"># and then multiply the Levodopa dose by either 0.33 or 0.5 as instructed. </span>

<span class="c1"># Since Levodopa dose is mostly missing we will drop those.</span>

<span class="n">ledd_df</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="p">[</span><span class="n">ledd_df</span><span class="p">[</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span> <span class="c1"># Drop nan</span>
<span class="n">ledd_df</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="p">[</span><span class="n">ledd_df</span><span class="p">[</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;LD x 0.33&quot;</span><span class="p">]</span> <span class="c1"># Drop LD x 0.33</span>
<span class="n">ledd_df</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="p">[</span><span class="n">ledd_df</span><span class="p">[</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;LD x 0.5&quot;</span><span class="p">]</span> <span class="c1"># Drop LD x 0.5</span>

<span class="n">ledd_df</span><span class="p">[</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="p">[</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="n">ledd</span> <span class="o">=</span> <span class="n">ledd_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;LEDD&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ledd_df</span><span class="p">[</span><span class="s1">&#39;LEDD&#39;</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ledd</span><span class="o">.</span><span class="n">index</span><span class="p">),</span><span class="n">rwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LEDD (mg/d)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of </span><span class="se">\&quot;</span><span class="s2">Levodopa equivalent daily dose</span><span class="se">\&quot;</span><span class="s2"> records&quot;</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average LEDD dose:&quot;</span><span class="p">,</span> <span class="n">ledd_df</span><span class="p">[</span><span class="s1">&#39;LEDD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Most common LEDD dose:&quot;</span><span class="p">,</span> <span class="n">ledd_df</span><span class="p">[</span><span class="s1">&#39;LEDD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average LEDD dose: 264.99988
Most common LEDD dose: 100.0
</pre></div>
</div>
<img alt="../../_images/b024ea3515ba45d7061f7f97979152139551b6c84ea96579634226db9dad5c1c.png" src="../../_images/b024ea3515ba45d7061f7f97979152139551b6c84ea96579634226db9dad5c1c.png" />
</div>
</div>
<p>The average LEDD dose among the subjects is 264 mg/d, with the most common LEDD dose being 100 mg/d.</p>
</section>
<section id="hoehn-and-yahr-staging-h-y">
<h3>Hoehn and Yahr staging (H&amp;Y)<a class="headerlink" href="#hoehn-and-yahr-staging-h-y" title="Link to this heading">#</a></h3>
<p>We obtain the following distribution of H&amp;Y scores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">updrs3_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;MDS_UPDRS_Part_III_clean.csv&quot;</span><span class="p">),</span>
                     <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;PDSTATE&quot;</span><span class="p">,</span> <span class="s2">&quot;PDTRTMNT&quot;</span><span class="p">,</span> <span class="s2">&quot;NP3TOT&quot;</span><span class="p">,</span> <span class="s2">&quot;NHY&quot;</span><span class="p">])</span>
<span class="n">updrs3_df</span> <span class="o">=</span> <span class="n">updrs3_df</span><span class="p">[</span><span class="n">updrs3_df</span><span class="p">[</span><span class="s2">&quot;NHY&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span> <span class="c1"># Drop nan</span>
<span class="n">updrs3</span> <span class="o">=</span> <span class="n">updrs3_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;NHY&quot;</span><span class="p">],</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">updrs3</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">updrs3</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scores&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of H&amp;Y scores&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/372e42f4cc8aea5093081828e88e4fcdc8a0e89d65edab6c68f805ace45d1445.png" src="../../_images/372e42f4cc8aea5093081828e88e4fcdc8a0e89d65edab6c68f805ace45d1445.png" />
</div>
</div>
<p>As we can see, the most common H&amp;Y score is 2 representing a bilateral or midline involvement without impairment of balance.</p>
<p>UR is used to indicate that the examiners were unable to rate the H&amp;Y score for some subjects. To ensure the reliability of our analysis, we will remove these subjects from our dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove UR patients</span>
<span class="n">updrs3_df</span> <span class="o">=</span> <span class="n">updrs3_df</span><span class="p">[</span><span class="n">updrs3_df</span><span class="p">[</span><span class="s2">&quot;NHY&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;UR&quot;</span><span class="p">]</span>
<span class="n">updrs3_df</span><span class="p">[</span><span class="s2">&quot;NHY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">updrs3_df</span><span class="p">[</span><span class="s2">&quot;NHY&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unified-parkinsons-disease-rating-scale-updrs-iii">
<h3>Unified Parkinson’s Disease Rating Scale (UPDRS III)<a class="headerlink" href="#unified-parkinsons-disease-rating-scale-updrs-iii" title="Link to this heading">#</a></h3>
<p>We obtain the following distribution of UPDRS III scores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">updrs3_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;NP3TOT&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">dist</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scores&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of UDPRS III scores&quot;</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">reformat_plot_labels</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b71a8e2979e12cc88078dcba17ed8709f693403d6f46f5e35537bb56a622cba6.png" src="../../_images/b71a8e2979e12cc88078dcba17ed8709f693403d6f46f5e35537bb56a622cba6.png" />
</div>
</div>
<p>The most common Unified Parkinson’s Disease Rating Scale score among the subjects is 0 representing no disability.</p>
</section>
<section id="montreal-cognitive-assessment-moca">
<h3>Montreal Cognitive Assessment (MoCA)<a class="headerlink" href="#montreal-cognitive-assessment-moca" title="Link to this heading">#</a></h3>
<p>We obtain the following distribution of MoCA scores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moca_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;Montreal_Cognitive_Assessment__MoCA_.csv&quot;</span><span class="p">),</span>
                   <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;MCATOT&quot;</span><span class="p">,</span><span class="s2">&quot;INFODT&quot;</span><span class="p">])</span>

<span class="c1"># Use screening instead of baseline.</span>
<span class="n">moca_df</span> <span class="o">=</span> <span class="n">moca_df</span><span class="p">[</span><span class="n">moca_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;BL&quot;</span><span class="p">]</span>
<span class="n">moca_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">moca_df</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SC&quot;</span><span class="p">,</span> <span class="s2">&quot;BL&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">moca_df</span> <span class="o">=</span> <span class="n">moca_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">moca</span> <span class="o">=</span> <span class="n">moca_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;MCATOT&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">moca</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">moca</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of MoCA scores&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5175fa10e6f6f0b264ad45250703cc9ed1b3b737ab776662435f2363651e5e72.png" src="../../_images/5175fa10e6f6f0b264ad45250703cc9ed1b3b737ab776662435f2363651e5e72.png" />
</div>
</div>
<p>The most common MoCA score among the subjects is 29 which is considered to be normal.</p>
</section>
<section id="mini-mental-state-examination-mmse">
<h3>Mini-Mental State Examination (MMSE)<a class="headerlink" href="#mini-mental-state-examination-mmse" title="Link to this heading">#</a></h3>
<p>We obtain the following distribution of MMSE scores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moca_df</span><span class="p">[</span><span class="s2">&quot;MMSETOT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">moca_df</span><span class="p">[</span><span class="s2">&quot;MCATOT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clinical</span><span class="o">.</span><span class="n">moca2mmse</span><span class="p">)</span>

<span class="n">mmse</span> <span class="o">=</span> <span class="n">moca_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;MMSETOT&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mmse</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">mmse</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of MMSE scores&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
<img alt="../../_images/52b962e117a40dd9b0bbe7f3d146a31ff97339e2ecaa4e7697e85ca064e66164.png" src="../../_images/52b962e117a40dd9b0bbe7f3d146a31ff97339e2ecaa4e7697e85ca064e66164.png" />
</div>
</div>
<p>The most common MMSE score among the subjects is 30 which is considered to be normal.</p>
</section>
<section id="geriatric-depression-scale-gds">
<h3>Geriatric Depression Scale (GDS)<a class="headerlink" href="#geriatric-depression-scale-gds" title="Link to this heading">#</a></h3>
<p>The original study used the GDS long form to calculate the GDS scores. However, GDS short form is only available in  PPMI. Therefore, the GDS scores will be out of 15 instead of 30. With this, we obtain the following distribution of GDS scores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdsshort_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;Geriatric_Depression_Scale__Short_Version_.csv&quot;</span><span class="p">))</span>
<span class="n">gdsshort_df</span> <span class="o">=</span> <span class="n">gdsshort_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;REC_ID&quot;</span><span class="p">,</span><span class="s2">&quot;PAG_NAME&quot;</span><span class="p">,</span> <span class="s2">&quot;INFODT&quot;</span><span class="p">,</span><span class="s2">&quot;ORIG_ENTRY&quot;</span><span class="p">,</span><span class="s2">&quot;LAST_UPDATE&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate GDS score for each patients</span>
<span class="n">gds</span> <span class="o">=</span> <span class="n">gdsshort_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>
<span class="n">gds</span> <span class="o">=</span> <span class="n">gds</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sum&quot;</span><span class="p">:</span> <span class="s2">&quot;GDSTOT&quot;</span><span class="p">})</span>

<span class="c1"># Add gds score for each patients to DF</span>
<span class="n">gdsshort_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gdsshort_df</span><span class="p">[[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENT_ID&#39;</span><span class="p">]],</span> <span class="n">gds</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gds</span> <span class="o">=</span> <span class="n">gdsshort_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;GDSTOT&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">gds</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">gds</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scores&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Geriatric Depression Scale scores&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a74e6bf6a6cfb9d226c8c342bd38d63705d27c2394036aef15feb3645fdada9c.png" src="../../_images/a74e6bf6a6cfb9d226c8c342bd38d63705d27c2394036aef15feb3645fdada9c.png" />
</div>
</div>
<p>The most common GDS score among the subjects is 5 indicating mild depression.</p>
</section>
<section id="mri-availabilty">
<h3>MRI Availabilty<a class="headerlink" href="#mri-availabilty" title="Link to this heading">#</a></h3>
<p>So far we have gathered both demographics and clinical characteristics from the PPMI dataset, we need to make sure that there are enough MRI available to replicate the study. To check this, we will get the distribution of events based on MRI availability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mri</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputs_dir</span><span class="p">,</span><span class="s2">&quot;MRI_info.csv&quot;</span><span class="p">))</span>
<span class="n">mri</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mri</span><span class="p">[</span><span class="s2">&quot;Visit code&quot;</span><span class="p">]</span>
<span class="n">mri</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mri</span><span class="p">[</span><span class="s2">&quot;Subject ID&quot;</span><span class="p">]</span>
<span class="n">mri</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mri</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">mri</span> <span class="o">=</span> <span class="n">mri</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;Subject ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Visit code&quot;</span><span class="p">,</span> <span class="s2">&quot;Visit&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">mri_events</span> <span class="o">=</span> <span class="n">mri</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mri_events</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">mri_events</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of MRI available&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Type of visits&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of MRI available by visit&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5f5b8e57b4af5f893265d9e466907601e1290ddfc6c0179aabab5cc9162b995a.png" src="../../_images/5f5b8e57b4af5f893265d9e466907601e1290ddfc6c0179aabab5cc9162b995a.png" />
</div>
</div>
<p>As we can see in the graph above, BL (baseline), V10, V06 and V04 are the most frequent. Hence, we will only consider MRI with those visits.</p>
</section>
</section>
<section id="data-aggregation">
<h2>Data aggregation<a class="headerlink" href="#data-aggregation" title="Link to this heading">#</a></h2>
<p>Now that we have prepared all of our data, we will combine them into two respective dataframes, one for PD subjects and one for healthy controls.</p>
<p>Below is a summary of the number of subjects collected:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span>
<span class="n">pd_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">cohort_def</span><span class="p">[</span><span class="n">cohort_def</span><span class="p">[</span><span class="s2">&quot;COHORT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mri</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cogstate_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">age_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">demo_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">socioecon_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">updrs3_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">moca_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pdxdur_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ledd_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gdsshort_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;PATNO&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">hc_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">cohort_def</span><span class="p">[</span><span class="n">cohort_def</span><span class="p">[</span><span class="s2">&quot;COHORT&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mri</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">age_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">demo_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">socioecon_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">moca_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gdsshort_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">nc_patno</span> <span class="o">=</span> <span class="n">pd_df</span><span class="p">[</span><span class="n">pd_df</span><span class="p">[</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span>
<span class="n">mci_patno</span> <span class="o">=</span> <span class="n">pd_df</span><span class="p">[</span><span class="n">pd_df</span><span class="p">[</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">][</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unique number of HC patients: </span><span class="si">{</span><span class="n">hc_df</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unique number of NC patients: </span><span class="si">{</span><span class="n">nc_patno</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unique number of MCI patients: </span><span class="si">{</span><span class="n">mci_patno</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique number of HC patients: 203
Unique number of NC patients: 147
Unique number of MCI patients: 47
</pre></div>
</div>
</div>
</div>
<section id="acceptable-visit-pairs">
<h3>Acceptable visit pairs<a class="headerlink" href="#acceptable-visit-pairs" title="Link to this heading">#</a></h3>
<p>To be able to replicate our cohort, we need subjects with follow-up scans. The original study followed up each subjects for 18 months. Below we will find the number of unique PD-MCI, PD-NC and HC subjects per visit pairs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maketal</span><span class="o">.</span><span class="n">find_acceptable_visit_pairs</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span><span class="n">hc_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique PD-MCI subjects per visit pairs:
BL  &amp; V04 =   2 | Month difference:                 12
BL  &amp; V06 =   3 | Month difference:                 24
BL  &amp; V10 =   3 | Month difference:                 48
V04 &amp; V06 =  12 | Month difference:                 12
V04 &amp; V10 =   9 | Month difference:                 36
V06 &amp; V10 =  16 | Month difference:                 24

Unique PD-NC subjects per visit pairs:
BL  &amp; V04 =  31 | Month difference:                 12
BL  &amp; V06 =  43 | Month difference:                 24
BL  &amp; V10 =  39 | Month difference:                 48
V04 &amp; V06 =  72 | Month difference:                 12
V04 &amp; V10 =  63 | Month difference:                 36
V06 &amp; V10 =  84 | Month difference:                 24

Unique HC subjects per visit pairs:
BL  &amp; V04 =  63 | Month difference:                 12
BL  &amp; V06 =   9 | Month difference:                 24
BL  &amp; V08 =   2 | Month difference:                 36
BL  &amp; V10 =  12 | Month difference:                 48
V04 &amp; V06 =   8 | Month difference:                 12
V04 &amp; V08 =   1 | Month difference:                 24
V04 &amp; V10 =  11 | Month difference:                 36
V06 &amp; V08 =   2 | Month difference:                 12
V06 &amp; V10 =   2 | Month difference:                 24
</pre></div>
</div>
</div>
</div>
<p>Since the number of MCI subjects is quite low, we will focus on the pairs of visit that has the most number of MCI subjects, i.e, we will use a time interval of 12 and 24 months to replicate our cohort.</p>
<p>Now that the number of the months between baseline and follow-up is determined, we can now proceed to cohort matching.</p>
</section>
</section>
<section id="cohort-summary">
<h2>Cohort Summary<a class="headerlink" href="#cohort-summary" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cohort_summary</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">hc</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">mci</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">agg</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s2">&quot;4.1f&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; ± &quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agg</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agg</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="si">:{</span><span class="n">f</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">agg</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">D</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">agg</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="si">:{</span><span class="n">f</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">D</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">gender_ratio</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
        <span class="n">male_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;SEX&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">male_count</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">male_count</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span>

    <span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="n">hc</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">nc</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">mci</span><span class="o">.</span><span class="n">describe</span><span class="p">()]</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">rich</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">HORIZONTALS</span><span class="p">,</span> <span class="n">show_footer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">style</span><span class="o">=</span><span class="s2">&quot;#cfd5e4&quot;</span><span class="p">,</span> <span class="n">row_styles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;on #f2f5f9&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">])</span>

    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span> <span class="n">footer</span><span class="o">=</span><span class="s2">&quot;Values expressed as mean ± SD.&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Healthy Controls&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;PD-NC&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;PD-MCI&quot;</span><span class="p">)</span>
<span class="c1">#     table.add_column(&quot;[italic]P[not italic]-value&quot;)  # TODO</span>
    
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s2">&quot;.0f&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Age (y)&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;Age range&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; - &quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;Gender (male, %)&quot;</span><span class="p">,</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">nc</span><span class="p">),</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">mci</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Education (y)&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;Disease duration (mo)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;PDXDUR&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;LEDD (mg/d) baseline&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;LEDD&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;LEDD (mg/d) follow-up&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;LEDD_NX&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;H&amp;Y baseline&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;NHY&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;H&amp;Y follow-up&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;NHY_NX&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;UPDRS III baseline&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;NP3TOT&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;UPDRS III follow-up&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;NP3TOT_NX&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;MMSE baseline&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;MMSETOT&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;MMSE follow-up&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;MMSETOT_NX&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;MoCA baseline&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;MCATOT&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;MoCA follow-up&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;MCATOT_NX&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;GDS baseline&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;GDSTOT&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;GDS follow-up&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;GDSTOT_NX&quot;</span><span class="p">))</span>

    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="cohort-with-follow-up-after-12-months">
<h3>Cohort with follow-up after 12 months<a class="headerlink" href="#cohort-with-follow-up-after-12-months" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mci</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">hc</span> <span class="o">=</span> <span class="n">maketal</span><span class="o">.</span><span class="n">create_cohort</span><span class="p">(</span><span class="n">pd_df</span><span class="o">=</span><span class="n">pd_df</span><span class="p">,</span> <span class="n">hc_df</span><span class="o">=</span><span class="n">hc_df</span><span class="p">,</span> <span class="n">months</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Unique number of:</span>
<span class="s2">  - HC subjects:     </span><span class="si">{</span><span class="n">hc</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/37)</span>
<span class="s2">  - PD-NC subjects:  </span><span class="si">{</span><span class="n">nc</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/66)</span>
<span class="s2">  - PD-MCI subjects: </span><span class="si">{</span><span class="n">mci</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/39)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique number of:
  - HC subjects:     37 (/37)
  - PD-NC subjects:  64 (/66)
  - PD-MCI subjects: 13 (/39)
</pre></div>
</div>
</div>
</div>
<p>With a follow-up of 12 months, more than 60% of PD-MCI subjects are missing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohort_summary</span><span class="p">(</span>
    <span class="n">hc</span><span class="o">=</span><span class="n">hc</span><span class="p">,</span>
    <span class="n">nc</span><span class="o">=</span><span class="n">nc</span><span class="p">,</span>
    <span class="n">mci</span><span class="o">=</span><span class="n">mci</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Demographic and clinical characteristics</span><span class="se">\n</span><span class="s2">(12 months follow-up)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">                                     Demographic and clinical characteristics                                      </span>
<span style="font-style: italic">                                               (12 months follow-up)                                               </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                                            </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> Healthy Controls        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> PD-NC               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> PD-MCI             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> n                                          </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 37                      </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 64                  </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 13                 </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Age (y)                                    <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 60.5 ± 11.2             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 60.8 ±  9.1         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 65.3 ±  8.5        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> Age range                                  </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 32.3 - 79.8             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 38.3 - 78.3         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 50.4 - 72.7        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Gender (male, %)                           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 24, 64.9%               <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 39, 60.9%           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 9, 69.2%           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> Education (y)                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 15.8 ±  3.1             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 15.3 ±  2.7         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 15.1 ±  2.9        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Disease duration (mo)                      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.2 ±  2.9         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.8 ±  4.0        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> LEDD (mg/d) baseline                       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 263.8 ± 220.9       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 265.8 ± 145.1      </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> LEDD (mg/d) follow-up                      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 263.8 ± 220.9       <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 265.8 ± 145.1      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> H&amp;Y baseline                               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  1.7 ±  0.6         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  1.8 ±  0.6        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> H&amp;Y follow-up                              <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  1.7 ±  0.5         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  1.7 ±  0.5        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> UPDRS III baseline                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 19.1 ±  8.6         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 21.0 ± 12.2        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> UPDRS III follow-up                        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 20.4 ±  9.9         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 25.3 ± 12.8        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> MMSE baseline                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.6 ±  0.5             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.3 ±  1.0         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 28.2 ±  1.1        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> MMSE follow-up                             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 29.3 ±  0.9             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 29.3 ±  1.0         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 28.4 ±  1.4        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> MoCA baseline                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 28.2 ±  1.2             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 27.4 ±  2.2         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 25.1 ±  2.3        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> MoCA follow-up                             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 27.5 ±  2.2             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 27.4 ±  2.2         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 25.6 ±  2.8        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> GDS baseline                               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.3 ±  1.5             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.4 ±  1.4         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.5 ±  1.2        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> GDS follow-up                              <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.8 ±  1.1             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.4 ±  1.7         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.6 ±  1.7        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> Values expressed as mean ± SD.             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                     </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                    </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
</pre>
</div></div>
</div>
</section>
<section id="cohort-with-follow-up-after-24-months">
<h3>Cohort with follow-up after 24 months<a class="headerlink" href="#cohort-with-follow-up-after-24-months" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mci_</span><span class="p">,</span> <span class="n">nc_</span><span class="p">,</span> <span class="n">hc_</span> <span class="o">=</span> <span class="n">maketal</span><span class="o">.</span><span class="n">create_cohort</span><span class="p">(</span><span class="n">pd_df</span><span class="o">=</span><span class="n">pd_df</span><span class="p">,</span> <span class="n">hc_df</span><span class="o">=</span><span class="n">hc_df</span><span class="p">,</span> <span class="n">months</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Unique number of:</span>
<span class="s2">  - HC subjects:     </span><span class="si">{</span><span class="n">hc_</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/37)</span>
<span class="s2">  - PD-NC subjects:  </span><span class="si">{</span><span class="n">nc_</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/66)</span>
<span class="s2">  - PD-MCI subjects: </span><span class="si">{</span><span class="n">mci_</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/39)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique number of:
  - HC subjects:     9 (/37)
  - PD-NC subjects:  64 (/66)
  - PD-MCI subjects: 18 (/39)
</pre></div>
</div>
</div>
</div>
<p>With a follow-up of 24 months, 75% of Healthy Controls and more than 50% of PD-MCI subjects are missing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohort_summary</span><span class="p">(</span>
    <span class="n">hc</span><span class="o">=</span><span class="n">hc_</span><span class="p">,</span>
    <span class="n">nc</span><span class="o">=</span><span class="n">nc_</span><span class="p">,</span>
    <span class="n">mci</span><span class="o">=</span><span class="n">mci_</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Demographic and clinical characteristics</span><span class="se">\n</span><span class="s2">(24 months follow-up)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">                                     Demographic and clinical characteristics                                      </span>
<span style="font-style: italic">                                               (24 months follow-up)                                               </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                                            </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> Healthy Controls        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> PD-NC               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> PD-MCI             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> n                                          </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 9                       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 64                  </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 18                 </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Age (y)                                    <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 54.6 ± 15.5             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 62.9 ±  9.1         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 65.8 ±  8.7        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> Age range                                  </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 30.6 - 76.8             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 38.3 - 82.3         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 49.9 - 79.2        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Gender (male, %)                           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 6, 66.7%                <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 38, 59.4%           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 16, 88.9%          <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> Education (y)                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 14.2 ±  4.3             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 16.2 ±  2.6         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 14.6 ±  2.5        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Disease duration (mo)                      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.6 ±  2.7         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.1 ±  3.2        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> LEDD (mg/d) baseline                       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 243.9 ± 187.8       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 243.5 ± 221.3      </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> LEDD (mg/d) follow-up                      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 243.9 ± 187.8       <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 243.5 ± 221.3      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> H&amp;Y baseline                               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  1.8 ±  0.5         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  1.9 ±  0.2        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> H&amp;Y follow-up                              <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  1.9 ±  0.7         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  2.1 ±  0.7        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> UPDRS III baseline                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 22.1 ± 11.0         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 26.6 ± 11.5        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> UPDRS III follow-up                        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 26.2 ± 14.7         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 27.9 ± 13.7        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> MMSE baseline                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.8 ±  0.4             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.3 ±  1.0         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 28.5 ±  0.7        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> MMSE follow-up                             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 29.8 ±  0.4             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 29.3 ±  1.0         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 28.3 ±  1.4        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> MoCA baseline                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.0 ±  1.2             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 27.6 ±  2.2         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 25.6 ±  1.6        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> MoCA follow-up                             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 28.7 ±  1.1             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 27.5 ±  2.2         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 25.3 ±  2.6        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> GDS baseline                               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.1 ±  0.6             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.3 ±  1.5         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  6.1 ±  2.0        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> GDS follow-up                              <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.0 ±  0.5             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.2 ±  1.2         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.8 ±  1.4        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> Values expressed as mean ± SD.             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                     </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                    </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
</pre>
</div></div>
</div>
</section>
<section id="cohort-follow-up-after-both-12-and-24-months">
<h3>Cohort follow up after both 12 and 24 months<a class="headerlink" href="#cohort-follow-up-after-both-12-and-24-months" title="Link to this heading">#</a></h3>
<p>Since the two previous cohorts are no where near the original paper’s cohort, we will try to merge subjects with both a follow-up of 12 and 24 months in one cohort.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merging PD-MCI</span>
<span class="n">mci_mix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mci</span><span class="p">,</span> <span class="n">mci_</span><span class="p">])</span>
<span class="n">mci_mix</span> <span class="o">=</span> <span class="n">mci_mix</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">mci_mix</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merging PD-NC</span>
<span class="n">nc_mix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">nc</span><span class="p">,</span> <span class="n">nc_</span><span class="p">])</span>
<span class="n">nc_mix</span> <span class="o">=</span> <span class="n">nc_mix</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">nc_mix</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merging HC subjecs</span>
<span class="n">hc_mix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hc</span><span class="p">,</span> <span class="n">hc_</span><span class="p">])</span>
<span class="n">hc_mix</span> <span class="o">=</span> <span class="n">hc_mix</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">hc_mix</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Removing subjects that appears in more than one group</span>
<span class="n">pd_mix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mci_mix</span><span class="p">,</span> <span class="n">nc_mix</span><span class="p">])</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">pd_mix</span><span class="p">[</span><span class="n">pd_mix</span><span class="o">.</span><span class="n">duplicated</span><span class="p">([</span><span class="s1">&#39;PATNO&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">index</span>
<span class="n">nc_mix</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">duplicates</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">hc_mix</span> <span class="o">=</span> <span class="n">hc_mix</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="n">nc_mix</span> <span class="o">=</span> <span class="n">nc_mix</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Unique number of:</span>
<span class="s2">  - HC subjects:     </span><span class="si">{</span><span class="n">hc_mix</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/37)</span>
<span class="s2">  - PD-NC subjects:  </span><span class="si">{</span><span class="n">nc_mix</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/66)</span>
<span class="s2">  - PD-MCI subjects: </span><span class="si">{</span><span class="n">mci_mix</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (/39)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique number of:
  - HC subjects:     37 (/37)
  - PD-NC subjects:  66 (/66)
  - PD-MCI subjects: 27 (/39)
</pre></div>
</div>
</div>
</div>
<p>By doing so, we were able to collect more than 70% of PD-MCI subjects. This is by far the closest we can get to the original cohort.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohort_summary</span><span class="p">(</span>
    <span class="n">hc</span><span class="o">=</span><span class="n">hc_mix</span><span class="p">,</span>
    <span class="n">nc</span><span class="o">=</span><span class="n">nc_mix</span><span class="p">,</span>
    <span class="n">mci</span><span class="o">=</span><span class="n">mci_mix</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Demographic and clinical characteristics</span><span class="se">\n</span><span class="s2">(12 &amp; 24 months follow-up)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">                                     Demographic and clinical characteristics                                      </span>
<span style="font-style: italic">                                            (12 &amp; 24 months follow-up)                                             </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                                            </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> Healthy Controls        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> PD-NC               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> PD-MCI             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> n                                          </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 37                      </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 66                  </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 27                 </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Age (y)                                    <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 59.3 ± 12.0             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 60.8 ±  9.6         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 64.9 ±  8.9        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> Age range                                  </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 30.6 - 79.8             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 38.3 - 82.3         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 49.9 - 79.2        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Gender (male, %)                           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 23, 62.2%               <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 40, 60.6%           <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 21, 77.8%          <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> Education (y)                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 15.5 ±  3.2             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 15.8 ±  2.6         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 14.9 ±  2.5        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> Disease duration (mo)                      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.2 ±  2.4         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.7 ±  3.4        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> LEDD (mg/d) baseline                       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 267.0 ± 213.0       </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 249.0 ± 199.7      </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> LEDD (mg/d) follow-up                      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 267.0 ± 213.0       <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 249.0 ± 199.7      <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> H&amp;Y baseline                               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  1.7 ±  0.5         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  1.9 ±  0.4        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> H&amp;Y follow-up                              <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  1.9 ±  0.6         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  2.0 ±  0.6        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> UPDRS III baseline                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 20.2 ±  9.8         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 23.9 ± 12.0        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> UPDRS III follow-up                        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>                         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 21.1 ± 12.2         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 26.6 ± 13.5        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> MMSE baseline                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.7 ±  0.5             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 29.4 ±  0.8         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 28.3 ±  0.9        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> MMSE follow-up                             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 29.4 ±  0.8             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 29.4 ±  1.0         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 28.5 ±  1.3        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> MoCA baseline                              </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 28.4 ±  1.2             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 27.7 ±  1.9         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9"> 25.3 ±  2.0        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> MoCA follow-up                             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 27.6 ±  2.0             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 27.8 ±  2.2         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> 25.7 ±  2.4        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="background-color: #f2f5f9"> GDS baseline                               </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.3 ±  1.4             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.2 ±  1.2         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4; background-color: #f2f5f9"> </span><span style="background-color: #f2f5f9">  5.8 ±  1.7        </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span> GDS follow-up                              <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  4.9 ±  1.0             <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.2 ±  1.4         <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>  5.9 ±  1.5        <span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold"> Values expressed as mean ± SD.             </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                         </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                     </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span><span style="font-weight: bold">                    </span><span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> </span>
<span style="color: #cfd5e4; text-decoration-color: #cfd5e4"> ───────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span>
</pre>
</div></div>
</div>
</section>
</section>
<section id="paper-replication">
<h2>Paper replication<a class="headerlink" href="#paper-replication" title="Link to this heading">#</a></h2>
<p>Having our cohort is ready, we will now proceed to reproduce the MRI-based results of the paper.</p>
</section>
<section id="image-processing">
<h2>Image Processing<a class="headerlink" href="#image-processing" title="Link to this heading">#</a></h2>
<p>The authors conducted cortical reconstruction and volumetric segmentation on the MRI data using the Freesurfer 5.3 image analysis software, following standard procedures.</p>
<p>The initial processing of T1 MRI images for each subject at each time point (baseline and follow-up) involves the following steps:</p>
<ul class="simple">
<li><p>removal of non-brain tissue</p></li>
<li><p>transformation using the Talairach method</p></li>
<li><p>segmentation of subcortical white matter and deep grey matter structures</p></li>
<li><p>normalization of intensity, tessellation of the grey matter/white matter boundary</p></li>
<li><p>correction of topology</p></li>
<li><p>surface deformation to correctly position the grey matter/white matter and grey matter/CSF boundaries.</p></li>
</ul>
<p>Since there is already PPMI image processed with Freesurfer 6.0.1 on the BIC server, we will start the volumetric analysis of subcortical structures from there.</p>
<section id="subcortical-structures">
<h3>Subcortical Structures<a class="headerlink" href="#subcortical-structures" title="Link to this heading">#</a></h3>
<p>The mapping between <code>EVENT_ID</code> and <code>session_id</code> is as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Session</p></th>
<th class="head text-left"><p>EVENT_ID</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1</p></td>
<td class="text-left"><p>Baseline</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>5</p></td>
<td class="text-left"><p>Month 12</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>7</p></td>
<td class="text-left"><p>Month 24</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>11</p></td>
<td class="text-left"><p>Month 48</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;COGSTATE&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;NEXT_VISIT&quot;</span><span class="p">]</span>
<span class="n">sessions</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;BL&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;V04&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;V06&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;V10&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">}</span>

<span class="n">cohort_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hc_mix</span><span class="p">,</span> <span class="n">nc_mix</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">])</span>

<span class="c1"># Map event_id to session_id</span>
<span class="n">cohort_df</span><span class="p">[</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort_df</span><span class="p">[</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sessions</span><span class="p">)</span>  
<span class="n">cohort_df</span><span class="p">[</span><span class="s1">&#39;NEXT_VISIT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort_df</span><span class="p">[</span><span class="s1">&#39;NEXT_VISIT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sessions</span><span class="p">)</span>

<span class="n">cohort_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outputs_dir</span><span class="p">,</span> <span class="s2">&quot;cohort.csv&quot;</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">header</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cohort.csv available at&quot;</span><span class="p">,</span> <span class="n">outputs_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cohort.csv available at /Users/andrzej/Documents/Concordia/replications/mak-etal-2015-main/outputs
</pre></div>
</div>
</div>
</div>
<p>We will prepare and structure our directory to store the freesurfer data as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mak-etal-2015   
└───outputs
    │ cohort.csv
    │ missing.csv
    │
    └───freesurfer
        └───hc
        │   └─── follow-up
        │   │      aseg_{id}.stats
        │   │      ...
        │   │
        │   └─── initial
        │          aseg_{id}.stats
        │          ...
        └───pd-mci
        │   └─── follow-up
        │   │      aseg_{id}.stats
        │   │      ...
        │   │
        │   └─── initial
        │          aseg_{id}.stats
        │          ...
        └───pd-nc
            └─── follow-up
            │      aseg_{id}.stats
            │      ...
            │
            └─── initial
                   aseg_{id}.stats
                   ...
        

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohort_first</span> <span class="o">=</span> <span class="n">cohort_df</span>
<span class="n">sessions</span>  <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;BL&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;V04&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;V06&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;V10&quot;</span><span class="p">}</span>
<span class="n">cohort_first</span><span class="p">[</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort_first</span><span class="p">[</span><span class="s1">&#39;EVENT_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sessions</span><span class="p">)</span> 
<span class="n">cohort_first</span><span class="p">[</span><span class="s2">&quot;visit_no&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span>

<span class="n">second_visit</span> <span class="o">=</span> <span class="n">cohort_df</span>
<span class="n">second_visit</span> <span class="o">=</span> <span class="n">second_visit</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">second_visit</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Description_NX&quot;</span><span class="p">:</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID_NX&quot;</span><span class="p">:</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">second_visit</span><span class="p">[</span><span class="s2">&quot;visit_no&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;second&quot;</span>
<span class="n">download_data</span> <span class="o">=</span> <span class="n">cohort_first</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second_visit</span><span class="p">)</span>

<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;visit_no&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will use the LivingPark utils library to download these files from the notebook. If files are already present in the notebook cache, they won’t be downloaded again. Otherwise, you will need to enter your PPMI username and password. <strong>In case you don’t have a PPMI account, you can request one <a class="reference external" href="http://ppmi-info.org">here</a>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download MRI data</span>
<span class="n">utils</span><span class="o">.</span><span class="n">download_missing_nifti_files</span><span class="p">(</span><span class="n">download_data</span><span class="p">,</span> <span class="n">link_in_outputs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Analyses were performed on Compute Canada servers (Advanced Research Computing facilities provided by the Compute Canada Federation). If you don’t have Compute Canada account you may be able to request one <a class="reference external" href="https://ccdb.computecanada.ca/security/login">here</a>.</p>
<p>Otherwise, please use any other available server or your local machine to run the analyses. You may need to adjust the following code depending on the method you use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># upload data to Compute Canada server</span>

<span class="c1"># please provide the following:</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># please change to the hostname you use</span>
<span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># please provide your Compute Canada username</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># please provide your Compute Canada password</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">paramiko</span><span class="w"> </span><span class="kn">import</span> <span class="n">SSHClient</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scp</span><span class="w"> </span><span class="kn">import</span> <span class="n">SCPClient</span>

<span class="n">ssh</span> <span class="o">=</span> <span class="n">SSHClient</span><span class="p">()</span>
<span class="n">ssh</span><span class="o">.</span><span class="n">load_system_host_keys</span><span class="p">()</span>
<span class="n">ssh</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># SCPCLient takes a paramiko transport as its only argument</span>
<span class="n">scp</span> <span class="o">=</span> <span class="n">SCPClient</span><span class="p">(</span><span class="n">ssh</span><span class="o">.</span><span class="n">get_transport</span><span class="p">())</span>

<span class="n">cdir</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
<span class="n">scp</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">cdir</span><span class="p">,</span> <span class="s2">&quot;mak_et_al&quot;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># scp.get(&#39;file_path_on_remote_machine&#39;, &#39;file_path_on_local_machine&#39;)</span>

<span class="n">scp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="preprocessing">
<h1>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h1>
<p>Data are preprocessed using longitudinal stream implemented in Freesurfer. <a href=https://surfer.nmr.mgh.harvard.edu/fswiki/LongitudinalProcessing> Click here for details.</a></p>
<p>Preprocessing is performed on an external server. <a href=https://github.com/boutiques> Boutiques</a> is used to manage Freesurfer’s functions within a container.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> slurm_magic
</pre></div>
</div>
</div>
</div>
<section id="preprocessing-step-1-cross-sectional">
<h2>preprocessing step 1 - cross-sectional<a class="headerlink" href="#preprocessing-step-1-cross-sectional" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare node for computation. it includes downloading the container</span>

<span class="o">!</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>singularity

<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>

<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.4043546&quot;</span>
<span class="n">bosh</span><span class="p">([</span><span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="n">zid</span><span class="p">])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">boutiques</span><span class="o">.</span><span class="n">descriptor2func</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save df with all timepoints as json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="n">data_to_process</span> <span class="o">=</span> <span class="n">download_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">small_df</span> <span class="o">=</span> <span class="n">data_to_process</span><span class="p">[[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">,</span> <span class="s2">&quot;File name&quot;</span><span class="p">]]</span>
<span class="n">json_data</span> <span class="o">=</span> <span class="n">small_df</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;json_data.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">fout</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS.py

<span class="c1"># save proprocessing script to submit jobs to the server later </span>
<span class="c1"># copy your FreeSurfer license to FS_license/license.txt or update the license path below</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.4043546&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="c1">#bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="n">task_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SLURM_ARRAY_TASK_ID&quot;</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;json_data.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="n">subject_map</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>

    
<span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="nb">input</span><span class="o">=</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;File name&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">],</span> <span class="n">qcache_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">subjid</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">]),</span>
                                       <span class="p">)</span>

<span class="c1">#exitcode = out.stdout</span>
<span class="n">exitcode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_fs</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preproc_FS_codes/exitcode_</span><span class="si">{0}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">])),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exitcode</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --array=0-259
#!/bin/bash
#SBATCH --job-name=FS_preproc
#SBATCH --mem=4G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_preproc.out
#SBATCH --error=FS_preproc.err
#SBATCH --time=10:0:0
#SBATCH --account=rrg-glatard

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="preprocessing-step-2-base-template">
<h2>preprocessing step 2 - base template<a class="headerlink" href="#preprocessing-step-2-base-template" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save df with a single input for each subject as json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="n">data_to_process</span> <span class="o">=</span> <span class="n">download_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">small_df</span> <span class="o">=</span> <span class="n">data_to_process</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]]</span>
<span class="n">small_df</span> <span class="o">=</span> <span class="n">small_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">json_data</span> <span class="o">=</span> <span class="n">small_df</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;json_data_base.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">fout</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_base.py

<span class="c1"># Step 2. create an unbiased template from all time points for each subject and process it with recon-all:</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7332026&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="c1">#bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="n">task_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SLURM_ARRAY_TASK_ID&quot;</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;json_data_base.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="n">subject_map</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>

<span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/sokol/projects/rrg-glatard/sokol/mak/freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">tp1</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;_first&quot;</span><span class="p">,</span>
                                        <span class="n">tp2</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;_second&quot;</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">outputdir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span><span class="p">,</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --array=0-130
#!/bin/bash
#SBATCH --job-name=FS_preproc
#SBATCH --mem=4G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_preproc_base.out
#SBATCH --error=FS_preproc_base.err
#SBATCH --time=10:0:0
#SBATCH --account=rrg-glatard

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_base.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="preprocessing-step-3-longitudinally-processed-timepoints">
<h2>preprocessing step 3 - longitudinally processed timepoints<a class="headerlink" href="#preprocessing-step-3-longitudinally-processed-timepoints" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare node for computation</span>
<span class="c1"># this should be run on a server connected to the internet</span>

<span class="o">!</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>singularity

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>

<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7339689&quot;</span>
<span class="c1"># bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">boutiques</span><span class="o">.</span><span class="n">descriptor2func</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save df with all timepoints and base as json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO_base&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span>
<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO_base&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;PATNO_base&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="n">data_to_process</span> <span class="o">=</span> <span class="n">download_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">small_df</span> <span class="o">=</span> <span class="n">data_to_process</span><span class="p">[[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO_base&quot;</span><span class="p">]]</span>
<span class="n">json_data</span> <span class="o">=</span> <span class="n">small_df</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;json_data_long.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">fout</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_long.py

<span class="c1"># Step 3. &quot;-long&quot; longitudinally process all timepoints (recon-all -long):</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7339689&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="c1">#bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="n">task_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SLURM_ARRAY_TASK_ID&quot;</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;json_data_long.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="n">subject_map</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>

<span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">tp</span><span class="o">=</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">],</span>
                                        <span class="n">base</span><span class="o">=</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO_base&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">],</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --array=0-259
#!/bin/bash
#SBATCH --job-name=FS_preproc
#SBATCH --mem=4G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_preproc_long.out
#SBATCH --error=FS_preproc_long.err
#SBATCH --time=10:0:0
#SBATCH --account=rrg-glatard

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_long.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="preprocessing-step-4-qcache">
<h2>preprocessing step 4 - Qcache<a class="headerlink" href="#preprocessing-step-4-qcache" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_long_qcache.py

<span class="c1"># save proprocessing script to submit jobs to the server later </span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7343403&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="c1">#bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="n">task_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SLURM_ARRAY_TASK_ID&quot;</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;json_data_long.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="n">subject_map</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>

    
<span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">tp</span><span class="o">=</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">],</span>
                                        <span class="n">base</span><span class="o">=</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO_base&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">],</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --array=0-259
#!/bin/bash
#SBATCH --job-name=FS_preproc_longQcache
#SBATCH --mem=4G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_preproc_longQcache.out
#SBATCH --error=FS_preproc_longQcache.err
#SBATCH --time=2:0:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_long_qcache.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

<span class="c1"># organize the data for each group </span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">hc_mix</span><span class="p">,</span> <span class="n">nc_mix</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;hc&quot;</span>
    <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;pd-nc&quot;</span>
    <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;pd-mci&quot;</span>
        
    <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">ses</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">]:</span>

            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{group}</span><span class="s1">/</span><span class="si">{ses}</span><span class="s1">/</span><span class="si">{pat}</span><span class="s1">/stats&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pat</span> <span class="o">=</span> <span class="n">pat</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">ses</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{pat}</span><span class="s1">_</span><span class="si">{ses}</span><span class="s1">.long.</span><span class="si">{pat}</span><span class="s1">_base/stats/aseg.stats&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pat</span> <span class="o">=</span> <span class="n">pat</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">ses</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{group}</span><span class="s1">/</span><span class="si">{ses}</span><span class="s1">/aseg-</span><span class="si">{pat}</span><span class="s1">.stats&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pat</span> <span class="o">=</span> <span class="n">pat</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">ses</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">))</span>
        
</pre></div>
</div>
</div>
</div>
</section>
<section id="image-quality-control">
<h2>Image quality control<a class="headerlink" href="#image-quality-control" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">imageio</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">iio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;axial&quot;</span><span class="p">,</span> <span class="s2">&quot;sagittal&quot;</span><span class="p">,</span> <span class="s2">&quot;coronal&quot;</span><span class="p">]:</span>
    <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;segm/baseline/</span><span class="si">{view}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">))</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">continue</span>

        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        <span class="n">iio</span><span class="o">.</span><span class="n">mimsave</span><span class="p">(</span><span class="s2">&quot;segm_baseline_</span><span class="si">{view}</span><span class="s2">.gif&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">),</span> <span class="n">images</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">imageio</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">iio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;axial&quot;</span><span class="p">,</span> <span class="s2">&quot;sagittal&quot;</span><span class="p">,</span> <span class="s2">&quot;coronal&quot;</span><span class="p">]:</span>
    <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;segm/</span><span class="si">{view}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">))</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">continue</span>

        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        <span class="n">iio</span><span class="o">.</span><span class="n">mimsave</span><span class="p">(</span><span class="s2">&quot;segm_long_</span><span class="si">{view}</span><span class="s2">.gif&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">),</span> <span class="n">images</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="axial-baseline">
<h2>Axial - baseline<a class="headerlink" href="#axial-baseline" title="Link to this heading">#</a></h2>
<p><img alt="SegmentLocal" src="../../_images/segm_baseline_axial.gif" /></p>
</section>
<section id="coronal-baseline">
<h2>Coronal - baseline<a class="headerlink" href="#coronal-baseline" title="Link to this heading">#</a></h2>
<p><img alt="SegmentLocal" src="../../_images/segm_baseline_coronal.gif" /></p>
</section>
<section id="sagittal-baseline">
<h2>Sagittal - baseline<a class="headerlink" href="#sagittal-baseline" title="Link to this heading">#</a></h2>
<p><img alt="SegmentLocal" src="../../_images/segm_baseline_sagittal.gif" /></p>
</section>
<section id="axial-longitudinal">
<h2>Axial - longitudinal<a class="headerlink" href="#axial-longitudinal" title="Link to this heading">#</a></h2>
<p><img alt="SegmentLocal" src="../../_images/segm_long_axial.gif" /></p>
</section>
<section id="coronal-longitudinal">
<h2>Coronal - longitudinal<a class="headerlink" href="#coronal-longitudinal" title="Link to this heading">#</a></h2>
<p><img alt="SegmentLocal" src="../../_images/segm_long_coronal.gif" /></p>
</section>
<section id="sagittal-longitudinal">
<h2>Sagittal - longitudinal<a class="headerlink" href="#sagittal-longitudinal" title="Link to this heading">#</a></h2>
<p><img alt="SegmentLocal" src="../../_images/segm_long_sagittal.gif" /></p>
<section id="subcortical-structures-volume-computation">
<h3>Subcortical Structures volume computation<a class="headerlink" href="#subcortical-structures-volume-computation" title="Link to this heading">#</a></h3>
<p>Now that we have all the information that we need, we can use “Volume_mm3” (TableCol  4 ColHeader) and “StructName” (TableCol  5 ColHeader) from <code>aseg.stats</code> to compute the change in volumes for each hemisphere of the following subcortical structures:</p>
<ul class="simple">
<li><p>thalamus</p></li>
<li><p>caudate</p></li>
<li><p>putamen</p></li>
<li><p>pallidum</p></li>
<li><p>hippocampus</p></li>
<li><p>amygdala</p></li>
<li><p>nucleus accumben,</p></li>
</ul>
<p>using this formula, <span class="math notranslate nohighlight">\(\frac{volume_{follow-up} - volume_{baseline}}{volume_{baseline}} \times 100\)</span>.</p>
<p>The table below presents the baseline comparisons of left and right subcortical structures, as well as the percentage change in their volumes between baseline and follow-up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Utility functions to compute volume changes</span>

<span class="n">structName</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Thalamus&#39;</span><span class="p">,</span> <span class="s1">&#39;Caudate&#39;</span><span class="p">,</span> <span class="s1">&#39;Putamen&#39;</span><span class="p">,</span> <span class="s1">&#39;Pallidum&#39;</span><span class="p">,</span> <span class="s1">&#39;Hippocampus&#39;</span><span class="p">,</span> <span class="s1">&#39;Amygdala&#39;</span><span class="p">,</span> <span class="s1">&#39;Accumbens-area&#39;</span><span class="p">]</span>

<span class="n">Item</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">,</span> <span class="s1">&#39;COGSTATE&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Hemisphere&#39;</span><span class="p">,</span><span class="s1">&#39;StructName&#39;</span><span class="p">,</span> <span class="s1">&#39;Volumes&#39;</span><span class="p">,</span> <span class="s1">&#39;TIVs&#39;</span><span class="p">])</span>

<span class="n">visit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;second&#39;</span><span class="p">]</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># returns a list from the iterator that produces a tuple for each combination of elements from sub_id and visit. </span>
<span class="k">def</span><span class="w"> </span><span class="nf">visits</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">visit</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">visit</span><span class="p">))</span>


<span class="c1"># returns a df with columns [PATNO, COGSTATE, AGE, SEX, EDUCYRS, HEM, STRUCT, VOL, VOL_NX, TIV, TIV_NX, % CHANGE]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">subcortical_volume</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">cogstate</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">find_item</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">struct</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">PATNO</span> <span class="o">==</span> <span class="n">sub_id</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">Hemisphere</span> <span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">StructName</span><span class="p">)</span> <span class="o">==</span> <span class="n">struct</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">i</span> 

    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">event</span> <span class="o">=</span> <span class="n">visits</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">visit</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
        <span class="n">freesurfer_dir</span> <span class="o">=</span> <span class="s1">&#39;/Users/andrzej/Documents/Concordia/replications/mak-etal-2015-main/&#39;</span> <span class="o">+</span> <span class="n">cogstate</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">freesurfer_dir</span><span class="p">,</span> <span class="s2">&quot;aseg-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.stats&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="n">cogstate</span> <span class="o">==</span> <span class="s2">&quot;hc&quot;</span><span class="p">:</span>
                    <span class="n">cog</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cog</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">PATNO</span><span class="o">==</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;COGSTATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
                <span class="n">tiv</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">age</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">PATNO</span><span class="o">==</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;AGE_AT_VISIT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sex</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">PATNO</span><span class="o">==</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">educ</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">PATNO</span><span class="o">==</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;EDUCYRS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">80</span><span class="p">:]:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>           
                    <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                    <span class="n">volume</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;second&quot;</span><span class="p">:</span>
                        <span class="n">init</span> <span class="o">=</span> <span class="n">find_item</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">init</span><span class="o">.</span><span class="n">Volumes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
                            <span class="n">init</span><span class="o">.</span><span class="n">TIVs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tiv</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>        
                        <span class="k">if</span> <span class="s1">&#39;Left&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cog</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="n">educ</span><span class="p">,</span> <span class="s1">&#39;Left&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">5</span><span class="p">:],</span> <span class="p">[</span><span class="n">volume</span><span class="p">],</span> <span class="p">[</span><span class="n">tiv</span><span class="p">]))</span>
                        <span class="k">elif</span> <span class="s1">&#39;Right&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cog</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="n">educ</span><span class="p">,</span> <span class="s1">&#39;Right&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="mi">6</span><span class="p">:],</span> <span class="p">[</span><span class="n">volume</span><span class="p">],</span> <span class="p">[</span><span class="n">tiv</span><span class="p">]))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">freesurfer_dir</span><span class="p">,</span> <span class="s2">&quot;aseg-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.stats&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; not found&quot;</span><span class="p">)</span>

    <span class="n">subcortical_seg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">,</span> <span class="s1">&#39;COGSTATE&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;SEX&#39;</span><span class="p">,</span> <span class="s1">&#39;EDUCYRS&#39;</span><span class="p">,</span> <span class="s1">&#39;HEM&#39;</span><span class="p">,</span> <span class="s1">&#39;STRUCT&#39;</span><span class="p">,</span> <span class="s1">&#39;VOLS&#39;</span><span class="p">,</span> <span class="s1">&#39;TIVS&#39;</span><span class="p">])</span>
    <span class="n">subcortical_seg</span> <span class="o">=</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="n">subcortical_seg</span><span class="p">[</span><span class="s2">&quot;STRUCT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">structName</span><span class="p">)]</span>
    <span class="n">subcortical_seg</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">vol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOLS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VOL&#39;</span><span class="p">,</span><span class="s1">&#39;VOL_NX&#39;</span><span class="p">])</span>
    <span class="n">tiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIVS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TIV&#39;</span><span class="p">,</span><span class="s1">&#39;TIV_NX&#39;</span><span class="p">])</span>

    <span class="n">subcortical_seg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">subcortical_seg</span><span class="p">,</span> <span class="n">vol</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    <span class="n">subcortical_seg</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VOLS&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">subcortical_seg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">subcortical_seg</span><span class="p">,</span> <span class="n">tiv</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    <span class="n">subcortical_seg</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TIVS&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL_NX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL_NX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    
    <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV_NX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV_NX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;TIV_NX&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;% CHANGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(((</span><span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL_NX&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL&#39;</span><span class="p">])</span> 
                                            <span class="o">/</span> <span class="n">subcortical_seg</span><span class="p">[</span><span class="s1">&#39;VOL&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">subcortical_seg</span>

<span class="c1"># returns a df to compare volumes between HC, PD-NC and PD-MCI</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compare_subcortical_volume</span><span class="p">(</span><span class="n">hc_vol_df</span><span class="p">,</span> <span class="n">nc_vol_df</span><span class="p">,</span> <span class="n">mci_vol_df</span><span class="p">):</span>
    <span class="c1"># Healthy controls</span>
    <span class="n">hc_vol_df</span> <span class="o">=</span> <span class="n">hc_vol_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;HEM&#39;</span><span class="p">,</span> <span class="s1">&#39;STRUCT&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;VOL&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s1">&#39;% CHANGE&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
    <span class="n">hc_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s2">&quot;Healthy Controls&quot;</span><span class="p">,</span> <span class="s2">&quot;VOL&quot;</span><span class="p">),</span>
                                      <span class="p">(</span><span class="s2">&quot;Healthy Controls&quot;</span><span class="p">,</span> <span class="s2">&quot;% CHANGE&quot;</span><span class="p">)])</span>
    <span class="n">hc_vol_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">hc_cols</span>
    
    <span class="c1"># PD-NC</span>
    <span class="n">nc_vol_df</span> <span class="o">=</span> <span class="n">nc_vol_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;HEM&#39;</span><span class="p">,</span> <span class="s1">&#39;STRUCT&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;VOL&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span><span class="s1">&#39;% CHANGE&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
    <span class="n">nc_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s2">&quot;PD-NC&quot;</span><span class="p">,</span> <span class="s2">&quot;VOL&quot;</span><span class="p">),</span> 
                                      <span class="p">(</span><span class="s2">&quot;PD-NC&quot;</span><span class="p">,</span> <span class="s2">&quot;% CHANGE&quot;</span><span class="p">)])</span>
    <span class="n">nc_vol_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">nc_cols</span>
    
    <span class="c1"># PD-MCI</span>
    <span class="n">mci_vol_df</span> <span class="o">=</span> <span class="n">mci_vol_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;HEM&#39;</span><span class="p">,</span> <span class="s1">&#39;STRUCT&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;VOL&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span><span class="s1">&#39;% CHANGE&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>
    <span class="n">mci_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s2">&quot;PD-MCI&quot;</span><span class="p">,</span> <span class="s2">&quot;VOL&quot;</span><span class="p">),</span> 
                                      <span class="p">(</span><span class="s2">&quot;PD-MCI&quot;</span><span class="p">,</span> <span class="s2">&quot;% CHANGE&quot;</span><span class="p">)])</span>
    <span class="n">mci_vol_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">mci_cols</span>
    
    <span class="c1"># merge all three df together</span>
    <span class="k">return</span> <span class="n">hc_vol_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nc_vol_df</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mci_vol_df</span><span class="p">)</span>

<span class="c1"># performs analysis of covariance and  post-hoc Tukey-Kramer pairwise comparison - % change</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ancova_and_post_hoc_change</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">hem</span><span class="p">):</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">hc_vol</span><span class="p">[</span><span class="s1">&#39;STRUCT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">struct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hc_vol</span><span class="p">[</span><span class="s1">&#39;HEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hem</span><span class="p">)]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">nc_vol</span><span class="p">[</span><span class="s1">&#39;STRUCT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">struct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">nc_vol</span><span class="p">[</span><span class="s1">&#39;HEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hem</span><span class="p">)]</span>
    <span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">mci_vol</span><span class="p">[</span><span class="s1">&#39;STRUCT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">struct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mci_vol</span><span class="p">[</span><span class="s1">&#39;HEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hem</span><span class="p">)]</span>

    <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">hem</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
    
<span class="c1">#    print(ancova(data=result, dv=&#39;% CHANGE&#39;, covar=[&#39;AGE&#39;, &#39;SEX&#39;, &#39;EDUCYRS&#39;,&#39;TIV&#39;,&#39;TIV_NX&#39;], between=&#39;COGSTATE&#39;), &quot;\n&quot;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ancova</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">result</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;% CHANGE&#39;</span><span class="p">,</span> <span class="n">covar</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;SEX&#39;</span><span class="p">,</span> <span class="s1">&#39;EDUCYRS&#39;</span><span class="p">,</span><span class="s1">&#39;TIV_mean&#39;</span><span class="p">],</span> <span class="n">between</span><span class="o">=</span><span class="s1">&#39;COGSTATE&#39;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">tukey</span> <span class="o">=</span> <span class="n">pairwise_tukeyhsd</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;% CHANGE&#39;</span><span class="p">],</span>
                          <span class="n">groups</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;COGSTATE&#39;</span><span class="p">],</span>
                          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
   
    <span class="nb">print</span><span class="p">(</span><span class="n">tukey</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span>

<span class="c1"># performs analysis of covariance and  post-hoc Tukey-Kramer pairwise comparison - baseline volume</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ancova_and_post_hoc_baseline</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">hem</span><span class="p">):</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">hc_vol</span><span class="p">[</span><span class="s1">&#39;STRUCT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">struct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hc_vol</span><span class="p">[</span><span class="s1">&#39;HEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hem</span><span class="p">)]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">nc_vol</span><span class="p">[</span><span class="s1">&#39;STRUCT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">struct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">nc_vol</span><span class="p">[</span><span class="s1">&#39;HEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hem</span><span class="p">)]</span>
    <span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">mci_vol</span><span class="p">[</span><span class="s1">&#39;STRUCT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">struct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mci_vol</span><span class="p">[</span><span class="s1">&#39;HEM&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hem</span><span class="p">)]</span>

    <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">hem</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
    
<span class="c1">#    print(ancova(data=result, dv=&#39;VOL&#39;, covar=[&#39;AGE&#39;, &#39;SEX&#39;, &#39;EDUCYRS&#39;,&#39;TIV&#39;,&#39;TIV_NX&#39;], between=&#39;COGSTATE&#39;), &quot;\n&quot;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ancova</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">result</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="s1">&#39;VOL&#39;</span><span class="p">,</span> <span class="n">covar</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;SEX&#39;</span><span class="p">,</span> <span class="s1">&#39;EDUCYRS&#39;</span><span class="p">,</span><span class="s1">&#39;TIV_mean&#39;</span><span class="p">],</span> <span class="n">between</span><span class="o">=</span><span class="s1">&#39;COGSTATE&#39;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">tukey</span> <span class="o">=</span> <span class="n">pairwise_tukeyhsd</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;VOL&#39;</span><span class="p">],</span>
                          <span class="n">groups</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;COGSTATE&#39;</span><span class="p">],</span>
                          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
   
    <span class="nb">print</span><span class="p">(</span><span class="n">tukey</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span>

<span class="c1"># Remove missing data before proceeding</span>

<span class="n">missing_hc_pat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">missing_nc_pat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">missing_mci_pat</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">filtered_hc</span> <span class="o">=</span> <span class="p">[</span><span class="n">hc_id</span> <span class="k">for</span> <span class="n">hc_id</span> <span class="ow">in</span> <span class="n">hc_mix</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">hc_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_hc_pat</span><span class="p">]</span>
<span class="n">filtered_nc</span> <span class="o">=</span> <span class="p">[</span><span class="n">nc_id</span> <span class="k">for</span> <span class="n">nc_id</span> <span class="ow">in</span> <span class="n">nc_mix</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">nc_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_nc_pat</span><span class="p">]</span>
<span class="n">filtered_mci</span> <span class="o">=</span> <span class="p">[</span><span class="n">mci_id</span> <span class="k">for</span> <span class="n">mci_id</span> <span class="ow">in</span> <span class="n">mci_mix</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">mci_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_mci_pat</span><span class="p">]</span>

<span class="c1"># Generate volume df for HC, PD-NC, PD-MCI</span>
<span class="n">hc_vol</span> <span class="o">=</span> <span class="n">subcortical_volume</span><span class="p">(</span><span class="n">filtered_hc</span><span class="p">,</span> <span class="s2">&quot;hc&quot;</span><span class="p">,</span> <span class="n">hc_mix</span><span class="p">)</span>
<span class="n">nc_vol</span> <span class="o">=</span> <span class="n">subcortical_volume</span><span class="p">(</span><span class="n">filtered_nc</span><span class="p">,</span> <span class="s2">&quot;pd-nc&quot;</span><span class="p">,</span> <span class="n">nc_mix</span><span class="p">)</span>
<span class="n">mci_vol</span> <span class="o">=</span> <span class="n">subcortical_volume</span><span class="p">(</span><span class="n">filtered_mci</span><span class="p">,</span> <span class="s2">&quot;pd-mci&quot;</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">)</span>

<span class="c1"># Generate df to compare volumes between HC, PD-NC and PD-MCI</span>
<span class="n">compare_subcortical_volume</span><span class="p">(</span><span class="n">hc_vol</span><span class="p">,</span> <span class="n">nc_vol</span><span class="p">,</span> <span class="n">mci_vol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Healthy Controls</th>
      <th colspan="2" halign="left">PD-NC</th>
      <th colspan="2" halign="left">PD-MCI</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>VOL</th>
      <th>% CHANGE</th>
      <th>VOL</th>
      <th>% CHANGE</th>
      <th>VOL</th>
      <th>% CHANGE</th>
    </tr>
    <tr>
      <th>HEM</th>
      <th>STRUCT</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">Left</th>
      <th>Thalamus</th>
      <td>7.154200</td>
      <td>-1.021622</td>
      <td>7.305480</td>
      <td>-0.686364</td>
      <td>7.131541</td>
      <td>-0.600000</td>
    </tr>
    <tr>
      <th>Caudate</th>
      <td>3.550954</td>
      <td>-1.075676</td>
      <td>3.506705</td>
      <td>-0.498485</td>
      <td>3.563893</td>
      <td>0.192593</td>
    </tr>
    <tr>
      <th>Putamen</th>
      <td>4.962257</td>
      <td>-1.189189</td>
      <td>4.916405</td>
      <td>-0.048485</td>
      <td>4.822570</td>
      <td>0.200000</td>
    </tr>
    <tr>
      <th>Pallidum</th>
      <td>2.063378</td>
      <td>-0.900000</td>
      <td>2.063986</td>
      <td>-0.539394</td>
      <td>2.122256</td>
      <td>1.170370</td>
    </tr>
    <tr>
      <th>Hippocampus</th>
      <td>3.970173</td>
      <td>-0.640541</td>
      <td>4.031023</td>
      <td>-0.910606</td>
      <td>3.906489</td>
      <td>-0.955556</td>
    </tr>
    <tr>
      <th>Amygdala</th>
      <td>1.648811</td>
      <td>-0.370270</td>
      <td>1.676818</td>
      <td>-0.677273</td>
      <td>1.542996</td>
      <td>-1.740741</td>
    </tr>
    <tr>
      <th>Accumbens-area</th>
      <td>0.483378</td>
      <td>-1.178378</td>
      <td>0.489697</td>
      <td>0.212121</td>
      <td>0.448178</td>
      <td>4.677778</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Right</th>
      <th>Thalamus</th>
      <td>7.388392</td>
      <td>-1.424324</td>
      <td>7.471488</td>
      <td>-0.342424</td>
      <td>7.313437</td>
      <td>-0.374074</td>
    </tr>
    <tr>
      <th>Caudate</th>
      <td>3.640335</td>
      <td>-1.459459</td>
      <td>3.606620</td>
      <td>-0.992424</td>
      <td>3.662493</td>
      <td>0.011111</td>
    </tr>
    <tr>
      <th>Putamen</th>
      <td>4.975916</td>
      <td>-0.924324</td>
      <td>4.948556</td>
      <td>-0.542424</td>
      <td>4.804389</td>
      <td>1.155556</td>
    </tr>
    <tr>
      <th>Pallidum</th>
      <td>1.889468</td>
      <td>0.286486</td>
      <td>1.914836</td>
      <td>0.880303</td>
      <td>1.995444</td>
      <td>1.262963</td>
    </tr>
    <tr>
      <th>Hippocampus</th>
      <td>4.044184</td>
      <td>-0.881081</td>
      <td>4.133721</td>
      <td>-0.924242</td>
      <td>4.022593</td>
      <td>-1.707407</td>
    </tr>
    <tr>
      <th>Amygdala</th>
      <td>1.791932</td>
      <td>-0.259459</td>
      <td>1.849459</td>
      <td>-0.313636</td>
      <td>1.754093</td>
      <td>-1.355556</td>
    </tr>
    <tr>
      <th>Accumbens-area</th>
      <td>0.574389</td>
      <td>-0.386486</td>
      <td>0.589242</td>
      <td>-0.303030</td>
      <td>0.530689</td>
      <td>1.974074</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em>Values are expressed as mean.</em></p>
</section>
<section id="volumetric-analysis-of-subcortical-structures">
<h3>Volumetric analysis of subcortical structures<a class="headerlink" href="#volumetric-analysis-of-subcortical-structures" title="Link to this heading">#</a></h3>
<p>To assess group differences in the percentage change of subcortical volumes, the analysis of covariance (ANCOVA) was used while controlling for age, gender, education, and the average of total intracranial volumes at both time points. Pairwise comparisons between each group were then conducted using the Tukey-Kramer method.</p>
<p><b>ANCOVA variables:</b></p>
<ul class="simple">
<li><p>Independent variable: cognitive state (HC, PD-NC, PD-MCI)</p></li>
<li><p>Covariate: age, gender, education, and intracerebral volume (baseline &amp; follow-up)</p></li>
<li><p>Dependent variables: baseline volume and % change in volume</p></li>
</ul>
<p>A probability value of less than 0.05 for each test statistic was considered to be statistically significant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># baseline volume</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">structName</span><span class="p">:</span>
    <span class="n">ancova_and_post_hoc_baseline</span><span class="p">(</span><span class="n">hc_vol</span><span class="p">,</span> <span class="n">nc_vol</span><span class="p">,</span> <span class="n">mci_vol</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;Left&quot;</span><span class="p">)</span>
    <span class="n">ancova_and_post_hoc_baseline</span><span class="p">(</span><span class="n">hc_vol</span><span class="p">,</span> <span class="n">nc_vol</span><span class="p">,</span> <span class="n">mci_vol</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;Right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Left Thalamus :
     Source         SS   DF           F         p-unc       np2
0  COGSTATE   0.088340    2    0.142572  8.672682e-01  0.002313
1       AGE  35.080564    1  113.233276  3.808728e-19  0.479328
2       SEX   0.069823    1    0.225374  6.358173e-01  0.001829
3   EDUCYRS   0.125512    1    0.405129  5.256349e-01  0.003283
4  TIV_mean  17.868339    1   57.675544  6.711037e-12  0.319222
5  Residual  38.106372  123         NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.1513 0.6842 -0.2801 0.5827  False
   0.0    2.0  -0.0227 0.9944 -0.5544  0.509  False
   1.0    2.0  -0.1739 0.6667 -0.6538 0.3059  False
--------------------------------------------------- 

Right Thalamus :
     Source         SS   DF          F         p-unc       np2
0  COGSTATE   0.124893    2   0.167827  8.456934e-01  0.002721
1       AGE  34.124078    1  91.709720  1.434050e-16  0.427134
2       SEX   0.001284    1   0.003450  9.532561e-01  0.000028
3   EDUCYRS   0.211350    1   0.568011  4.524908e-01  0.004597
4  TIV_mean  18.286394    1  49.145359  1.385508e-10  0.285488
5  Residual  45.766813  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0831 0.9007 -0.3691 0.5353  False
   0.0    2.0   -0.075 0.9455 -0.6322 0.4823  False
   1.0    2.0  -0.1581 0.7371  -0.661 0.3449  False
--------------------------------------------------- 

Left Caudate :
     Source         SS   DF          F         p-unc           np2
0  COGSTATE   0.365080    2   1.284843  2.803811e-01  2.046422e-02
1       AGE   1.341762    1   9.444255  2.608985e-03  7.130740e-02
2       SEX   0.000004    1   0.000025  9.960168e-01  2.034494e-07
3   EDUCYRS   0.134023    1   0.943345  3.333253e-01  7.611095e-03
4  TIV_mean   4.482173    1  31.548649  1.230732e-07  2.041341e-01
5  Residual  17.474830  123        NaN           NaN           NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.0442 0.8852 -0.2672 0.1787  False
   0.0    2.0   0.0129 0.9932 -0.2619 0.2877  False
   1.0    2.0   0.0572 0.8483 -0.1908 0.3052  False
--------------------------------------------------- 

Right Caudate :
     Source         SS   DF          F         p-unc       np2
0  COGSTATE   0.278079    2   1.046925  3.541220e-01  0.016738
1       AGE   1.490438    1  11.222535  1.073403e-03  0.083611
2       SEX   0.000998    1   0.007516  9.310551e-01  0.000061
3   EDUCYRS   0.068822    1   0.518207  4.729732e-01  0.004195
4  TIV_mean   4.069857    1  30.644763  1.784521e-07  0.199452
5  Residual  16.335335  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.0337 0.9271 -0.2494  0.182  False
   0.0    2.0   0.0222 0.9787 -0.2437  0.288  False
   1.0    2.0   0.0559 0.8455 -0.1841 0.2958  False
--------------------------------------------------- 

Left Putamen :
     Source         SS   DF          F         p-unc       np2
0  COGSTATE   0.671093    2   1.676382  1.912946e-01  0.026535
1       AGE   5.270395    1  26.330753  1.088873e-06  0.176325
2       SEX   0.092313    1   0.461191  4.983437e-01  0.003736
3   EDUCYRS   0.044721    1   0.223426  6.372793e-01  0.001813
4  TIV_mean   6.349185    1  31.720362  1.147179e-07  0.205017
5  Residual  24.619826  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.0459 0.9205 -0.3262 0.2345  False
   0.0    2.0  -0.1397 0.6042 -0.4852 0.2058  False
   1.0    2.0  -0.0938 0.7559 -0.4057  0.218  False
--------------------------------------------------- 

Right Putamen :
     Source         SS   DF          F     p-unc       np2
0  COGSTATE   0.620974    2   1.372336  0.257368  0.021827
1       AGE   5.464379    1  24.152280  0.000003  0.164131
2       SEX   0.038137    1   0.168564  0.682105  0.001369
3   EDUCYRS   0.145593    1   0.643514  0.423988  0.005205
4  TIV_mean   4.831636    1  21.355589  0.000009  0.147937
5  Residual  27.828370  123        NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.0274  0.971 -0.3083 0.2535  False
   0.0    2.0  -0.1715 0.4702 -0.5177 0.1747  False
   1.0    2.0  -0.1442 0.5194 -0.4566 0.1683  False
--------------------------------------------------- 

Left Pallidum :
     Source        SS   DF          F         p-unc       np2
0  COGSTATE  0.135359    2   1.703371  1.863352e-01  0.026951
1       AGE  0.822814    1  20.708726  1.264947e-05  0.144102
2       SEX  0.076554    1   1.926722  1.676266e-01  0.015423
3   EDUCYRS  0.127283    1   3.203480  7.594223e-02  0.025383
4  TIV_mean  1.739586    1  43.782230  1.009744e-09  0.262511
5  Residual  4.887122  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0006 0.9999 -0.1225 0.1238  False
   0.0    2.0   0.0589 0.6287 -0.0929 0.2106  False
   1.0    2.0   0.0583 0.5727 -0.0787 0.1953  False
--------------------------------------------------- 

Right Pallidum :
     Source        SS   DF          F     p-unc       np2
0  COGSTATE  0.130477    2   1.561225  0.214009  0.024757
1       AGE  0.218790    1   5.235889  0.023832  0.040830
2       SEX  0.004336    1   0.103762  0.747908  0.000843
3   EDUCYRS  0.149754    1   3.583767  0.060696  0.028311
4  TIV_mean  1.079610    1  25.836227  0.000001  0.173588
5  Residual  5.139763  123        NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0254 0.8641 -0.0914 0.1422  False
   0.0    2.0    0.106 0.1923  -0.038 0.2499  False
   1.0    2.0   0.0806 0.3081 -0.0493 0.2105  False
--------------------------------------------------- 

Left Hippocampus :
     Source         SS   DF          F         p-unc       np2
0  COGSTATE   0.116412    2   0.447245  6.404231e-01  0.007220
1       AGE   4.359476    1  33.497403  5.570343e-08  0.214044
2       SEX   0.024833    1   0.190810  6.630090e-01  0.001549
3   EDUCYRS   0.043380    1   0.333325  5.647629e-01  0.002703
4  TIV_mean   1.486266    1  11.420194  9.737936e-04  0.084959
5  Residual  16.007674  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0608 0.7671 -0.1469 0.2686  False
   0.0    2.0  -0.0637 0.8258 -0.3198 0.1924  False
   1.0    2.0  -0.1245 0.4103 -0.3557 0.1066  False
--------------------------------------------------- 

Right Hippocampus :
     Source         SS   DF          F         p-unc       np2
0  COGSTATE   0.108686    2   0.429483  6.518176e-01  0.006935
1       AGE   5.373018    1  42.463810  1.662757e-09  0.256635
2       SEX   0.009445    1   0.074647  7.851460e-01  0.000607
3   EDUCYRS   0.064578    1   0.510371  4.763321e-01  0.004132
4  TIV_mean   1.617410    1  12.782647  5.009263e-04  0.094141
5  Residual  15.563399  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0895 0.5726 -0.1209    0.3  False
   0.0    2.0  -0.0216 0.9787  -0.281 0.2378  False
   1.0    2.0  -0.1111    0.5 -0.3452  0.123  False
--------------------------------------------------- 

Left Amygdala :
     Source        SS   DF          F     p-unc       np2
0  COGSTATE  0.296081    2   3.861716  0.023628  0.059082
1       AGE  0.710898    1  18.544164  0.000034  0.131013
2       SEX  0.157853    1   4.117673  0.044596  0.032393
3   EDUCYRS  0.003258    1   0.084991  0.771135  0.000691
4  TIV_mean  0.154594    1   4.032679  0.046818  0.031745
5  Residual  4.715253  123        NaN       NaN       NaN 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiple Comparison of Means - Tukey HSD, FWER=0.05 
====================================================
group1 group2 meandiff p-adj   lower   upper  reject
----------------------------------------------------
   0.0    1.0    0.028 0.8119 -0.0799  0.1359  False
   0.0    2.0  -0.1058 0.1465 -0.2388  0.0272  False
   1.0    2.0  -0.1338 0.0248 -0.2538 -0.0138   True
---------------------------------------------------- 

Right Amygdala :
     Source        SS   DF          F     p-unc       np2
0  COGSTATE  0.205795    2   3.169966  0.045458  0.049018
1       AGE  0.605561    1  18.655509  0.000032  0.131696
2       SEX  0.199993    1   6.161178  0.014407  0.047701
3   EDUCYRS  0.006769    1   0.208529  0.648728  0.001692
4  TIV_mean  0.559814    1  17.246192  0.000061  0.122971
5  Residual  3.992600  123        NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0575 0.4339 -0.0528 0.1678  False
   0.0    2.0  -0.0378  0.787 -0.1738 0.0981  False
   1.0    2.0  -0.0954 0.1599 -0.2181 0.0273  False
--------------------------------------------------- 

Left Accumbens-area :
     Source        SS   DF          F         p-unc       np2
0  COGSTATE  0.008946    2   0.441006  6.444020e-01  0.007120
1       AGE  0.337103    1  33.237465  6.187638e-08  0.212737
2       SEX  0.003827    1   0.377365  5.401514e-01  0.003059
3   EDUCYRS  0.003872    1   0.381727  5.378226e-01  0.003094
4  TIV_mean  0.008179    1   0.806396  3.709425e-01  0.006513
5  Residual  1.247497  123        NaN           NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0063   0.96 -0.0488 0.0614  False
   0.0    2.0  -0.0352  0.438 -0.1031 0.0327  False
   1.0    2.0  -0.0415 0.2464 -0.1028 0.0198  False
--------------------------------------------------- 

Right Accumbens-area :
     Source        SS   DF          F     p-unc       np2
0  COGSTATE  0.034237    2   1.549656  0.216437  0.024578
1       AGE  0.279049    1  25.260704  0.000002  0.170380
2       SEX  0.000531    1   0.048091  0.826783  0.000391
3   EDUCYRS  0.000116    1   0.010535  0.918415  0.000086
4  TIV_mean  0.053520    1   4.844822  0.029596  0.037896
5  Residual  1.358751  123        NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0149 0.8078 -0.0417 0.0714  False
   0.0    2.0  -0.0437 0.3005 -0.1134  0.026  False
   1.0    2.0  -0.0586 0.0737 -0.1215 0.0043  False
--------------------------------------------------- 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># % change </span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">structName</span><span class="p">:</span>
    <span class="n">ancova_and_post_hoc_change</span><span class="p">(</span><span class="n">hc_vol</span><span class="p">,</span> <span class="n">nc_vol</span><span class="p">,</span> <span class="n">mci_vol</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;Left&quot;</span><span class="p">)</span>
    <span class="n">ancova_and_post_hoc_change</span><span class="p">(</span><span class="n">hc_vol</span><span class="p">,</span> <span class="n">nc_vol</span><span class="p">,</span> <span class="n">mci_vol</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;Right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Left Thalamus :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE     4.426895    2  0.185889  0.830598  0.003013
1       AGE     5.178725    1  0.434919  0.510818  0.003523
2       SEX     7.729872    1  0.649169  0.421965  0.005250
3   EDUCYRS     0.091710    1  0.007702  0.930209  0.000063
4  TIV_mean     2.047798    1  0.171978  0.679082  0.001396
5  Residual  1464.602035  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.3353 0.8827 -1.3352 2.0057  False
   0.0    2.0   0.4216 0.8782 -1.6371 2.4803  False
   1.0    2.0   0.0864 0.9933 -1.7718 1.9445  False
--------------------------------------------------- 

Right Thalamus :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    32.325560    2  1.141987  0.322545  0.018230
1       AGE     7.593089    1  0.536492  0.465283  0.004343
2       SEX    15.474575    1  1.093362  0.297778  0.008811
3   EDUCYRS    42.036921    1  2.970134  0.087328  0.023578
4  TIV_mean     1.323654    1  0.093523  0.760262  0.000760
5  Residual  1740.844647  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   1.0819 0.3439 -0.7507 2.9145  False
   0.0    2.0   1.0503 0.5141 -1.2083 3.3088  False
   1.0    2.0  -0.0316 0.9993 -2.0701 2.0068  False
--------------------------------------------------- 

Left Caudate :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    28.717716    2  1.522394  0.222271  0.024156
1       AGE     8.260868    1  0.875856  0.351173  0.007070
2       SEX     3.054317    1  0.323833  0.570351  0.002626
3   EDUCYRS     1.734671    1  0.183918  0.668778  0.001493
4  TIV_mean    21.235807    1  2.251521  0.136046  0.017976
5  Residual  1160.106643  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.5772 0.6306 -0.9157   2.07  False
   0.0    2.0   1.2683 0.2349 -0.5716 3.1081  False
   1.0    2.0   0.6911 0.5864 -0.9695 2.3517  False
--------------------------------------------------- 

Right Caudate :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    26.868032    2  1.087295  0.340345  0.017372
1       AGE    22.474302    1  1.818980  0.179913  0.014573
2       SEX    12.365482    1  1.000812  0.319078  0.008071
3   EDUCYRS     0.593733    1  0.048054  0.826847  0.000391
4  TIV_mean     0.353736    1  0.028630  0.865914  0.000233
5  Residual  1519.719580  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0    0.467 0.7932 -1.2391 2.1732  False
   0.0    2.0   1.4706 0.2252 -0.6321 3.5733  False
   1.0    2.0   1.0035 0.4239 -0.8943 2.9014  False
--------------------------------------------------- 

Left Putamen :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    49.585256    2  2.522272  0.084422  0.039397
1       AGE     7.790847    1  0.792600  0.375053  0.006403
2       SEX     0.504184    1  0.051293  0.821204  0.000417
3   EDUCYRS    26.238447    1  2.669362  0.104854  0.021241
4  TIV_mean     3.174974    1  0.323005  0.570843  0.002619
5  Residual  1209.026479  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   1.1407 0.1815 -0.3817 2.6631  False
   0.0    2.0   1.3892 0.1888  -0.487 3.2654  False
   1.0    2.0   0.2485 0.9355 -1.4449 1.9419  False
--------------------------------------------------- 

Right Putamen :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    66.008405    2  3.272636  0.041232  0.050525
1       AGE     8.988606    1  0.891294  0.346978  0.007194
2       SEX    37.313516    1  3.699939  0.056725  0.029202
3   EDUCYRS    11.405859    1  1.130984  0.289649  0.009111
4  TIV_mean    26.290678    1  2.606935  0.108960  0.020755
5  Residual  1240.442583  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.3819 0.8308 -1.1781 1.9419  False
   0.0    2.0   2.0799 0.0306  0.1572 4.0025   True
   1.0    2.0    1.698 0.0566 -0.0373 3.4333  False
--------------------------------------------------- 

Left Pallidum :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    72.233529    2  2.141917  0.121789  0.033656
1       AGE    13.802907    1  0.818586  0.367363  0.006611
2       SEX     2.543786    1  0.150860  0.698386  0.001225
3   EDUCYRS    10.181249    1  0.603802  0.438623  0.004885
4  TIV_mean    15.470685    1  0.917494  0.340013  0.007404
5  Residual  2074.012115  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.3606 0.9032 -1.6277 2.3489  False
   0.0    2.0   2.0704 0.1155 -0.3801 4.5208  False
   1.0    2.0   1.7098 0.1629  -0.502 3.9215  False
--------------------------------------------------- 

Right Pallidum :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE     7.379084    2  0.131168  0.877193  0.002128
1       AGE     6.988738    1  0.248458  0.619053  0.002016
2       SEX     3.644260    1  0.129558  0.719508  0.001052
3   EDUCYRS     3.479946    1  0.123716  0.725640  0.001005
4  TIV_mean     2.786347    1  0.099058  0.753496  0.000805
5  Residual  3459.800491  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.5938 0.8457 -1.9578 3.1454  False
   0.0    2.0   0.9765 0.7424 -2.1682 4.1212  False
   1.0    2.0   0.3827 0.9452 -2.4556  3.221  False
--------------------------------------------------- 

Left Hippocampus :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE     2.630118    2  0.152905  0.858374  0.002480
1       AGE     2.446196    1  0.284425  0.594778  0.002307
2       SEX     4.429756    1  0.515059  0.474318  0.004170
3   EDUCYRS    16.937676    1  1.969386  0.163033  0.015759
4  TIV_mean     0.672965    1  0.078247  0.780157  0.000636
5  Residual  1057.859899  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.2701  0.894 -1.6895 1.1494  False
   0.0    2.0   -0.315 0.9044 -2.0644 1.4343  False
   1.0    2.0  -0.0449 0.9975 -1.6239  1.534  False
--------------------------------------------------- 

Right Hippocampus :
     Source          SS   DF         F     p-unc       np2
0  COGSTATE    8.749932    2  0.748111  0.475401  0.012018
1       AGE   13.143072    1  2.247440  0.136398  0.017944
2       SEX    9.026881    1  1.543579  0.216449  0.012394
3   EDUCYRS    0.929210    1  0.158893  0.690869  0.001290
4  TIV_mean    4.991793    1  0.853587  0.357348  0.006892
5  Residual  719.306359  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.0432 0.9958 -1.2198 1.1335  False
   0.0    2.0  -0.8263 0.3697 -2.2765 0.6238  False
   1.0    2.0  -0.7832 0.3342  -2.092 0.5257  False
--------------------------------------------------- 

Left Amygdala :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    24.389538    2  0.319408  0.727180  0.005167
1       AGE    90.605980    1  2.373173  0.126005  0.018929
2       SEX    24.792253    1  0.649364  0.421895  0.005252
3   EDUCYRS     3.570846    1  0.093528  0.760256  0.000760
4  TIV_mean    10.116215    1  0.264966  0.607652  0.002150
5  Residual  4696.048495  123       NaN       NaN       NaN 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   -0.307 0.9684 -3.3249 2.7109  False
   0.0    2.0  -1.3705 0.6578 -5.0898 2.3489  False
   1.0    2.0  -1.0635 0.7334 -4.4204 2.2935  False
--------------------------------------------------- 

Right Amygdala :
     Source           SS   DF         F     p-unc       np2
0  COGSTATE    21.179026    2  0.477426  0.621523  0.007703
1       AGE     6.853969    1  0.309010  0.579298  0.002506
2       SEX     5.922879    1  0.267032  0.606258  0.002166
3   EDUCYRS     0.860057    1  0.038775  0.844219  0.000315
4  TIV_mean    19.416922    1  0.875407  0.351296  0.007067
5  Residual  2728.194166  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0  -0.0542 0.9982 -2.3228 2.2144  False
   0.0    2.0  -1.0961 0.6226  -3.892 1.6998  False
   1.0    2.0  -1.0419 0.5913 -3.5654 1.4816  False
--------------------------------------------------- 

Left Accumbens-area :
     Source            SS   DF         F     p-unc       np2
0  COGSTATE    550.373064    2  1.205071  0.303184  0.019218
1       AGE     22.362612    1  0.097928  0.754860  0.000796
2       SEX     60.091825    1  0.263148  0.608885  0.002135
3   EDUCYRS     43.750672    1  0.191589  0.662365  0.001555
4  TIV_mean     86.811641    1  0.380157  0.538659  0.003081
5  Residual  28087.927522  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05 
====================================================
group1 group2 meandiff p-adj   lower   upper  reject
----------------------------------------------------
   0.0    1.0   1.3905 0.8928 -5.8749  8.6559  False
   0.0    2.0   5.8562 0.2708 -3.0979 14.8102  False
   1.0    2.0   4.4657  0.392  -3.616 12.5473  False
---------------------------------------------------- 

Right Accumbens-area :
     Source            SS   DF         F     p-unc       np2
0  COGSTATE     93.847670    2  0.440152  0.644949  0.007106
1       AGE      3.591340    1  0.033687  0.854676  0.000274
2       SEX      0.140506    1  0.001318  0.971099  0.000011
3   EDUCYRS      0.948759    1  0.008899  0.924995  0.000072
4  TIV_mean      4.194115    1  0.039341  0.843101  0.000320
5  Residual  13112.811901  123       NaN       NaN       NaN 

Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
   0.0    1.0   0.0835 0.9991 -4.8679 5.0349  False
   0.0    2.0   2.3606 0.6303 -3.7417 8.4628  False
   1.0    2.0   2.2771 0.5905 -3.2306 7.7848  False
--------------------------------------------------- 
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis-of-covariance-ancova">
<h3>Analysis of covariance (ANCOVA)<a class="headerlink" href="#analysis-of-covariance-ancova" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Hem</p></th>
<th class="head text-left"><p>Struct</p></th>
<th class="head text-left"><p>Significant Difference (baseline)</p></th>
<th class="head text-left"><p>Posthoc (baseline)</p></th>
<th class="head text-left"><p>Sign. Diff. (% change)</p></th>
<th class="head text-left"><p>Posthoc (% change)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Left</p></td>
<td class="text-left"><p>Thalamus-Proper</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Caudate</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>Putamen</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Pallidum</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>Hippocampus</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Amygdala</p></td>
<td class="text-left"><p>COGSTATE (p=.02)</p></td>
<td class="text-left"><p>PD-non-MCI &gt; PD-MCI</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>Accumbens-area</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Right</p></td>
<td class="text-left"><p>Thalamus-Proper</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>Caudate</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Putamen</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p>COGSTATE (p=.04)</p></td>
<td class="text-left"><p>HC &lt; PD-MCI</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>Pallidum</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Hippocampus</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>Amygdala</p></td>
<td class="text-left"><p>COGSTATE (p=.05)</p></td>
<td class="text-left"><p>ns</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>Accumbens-area</p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>There is a significant difference in the baseline volume of the left amygdala between the cognitive states of patients.</p>
<p>There is a significant difference in the percent of volumetric change between the cognitive states of patients - the change of the volume of the right putamen differ between the groups.</p>
</section>
<section id="post-hoc-tukey-kramer-pairwise-comparisons">
<h3>Post hoc Tukey-Kramer pairwise comparisons<a class="headerlink" href="#post-hoc-tukey-kramer-pairwise-comparisons" title="Link to this heading">#</a></h3>
<section id="baseline-volumes">
<h4>Baseline volumes<a class="headerlink" href="#baseline-volumes" title="Link to this heading">#</a></h4>
<p>The baseline volume of the left amygdala was significantly higher in the PD-non-MCI group than in the PD-MCI one.</p>
<p>We were unable to reproduce the findings in the original paper. The original study found group differences in the baseline volumes in the left hippocampus and the left nucleus accumbens. We found group differences in the baseline volume of the left amygdala.</p>
</section>
<section id="change">
<h4>% change<a class="headerlink" href="#change" title="Link to this heading">#</a></h4>
<p>Average change of volumes of the right putamen differed between cognitive states. Post hoc test showed that the PD-MCI group has a higher change in the volume of the right putamen than the HC group.</p>
<p>We were unable to reproduce the findings of the original paper. The original study found group differences in the change of volumes in the left caudate and the right hippocampus. We found group differences in the change of the right caudate and putamen volumes.</p>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="vertex-wise-analysis">
<h1>Vertex-wise analysis<a class="headerlink" href="#vertex-wise-analysis" title="Link to this heading">#</a></h1>
<p>The original study doesn’t specify whether ANCOVA or t-tests were used to analyze the group differences. Hence, we tested both models: ANCOVA with three groups and t-tests with an additional covariate (levadopa equivalent daily dose).</p>
<section id="prepare-the-vertex-data-with-long-mris-slopes-for-longitudinal-two-stage-model">
<h2>Prepare the vertex data with long_mris_slopes for longitudinal two stage model<a class="headerlink" href="#prepare-the-vertex-data-with-long-mris-slopes-for-longitudinal-two-stage-model" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate Duration T2-T1 (years)</span>
<span class="c1"># based on MoCA assessment</span>

<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;INFODT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;INFODT&quot;</span><span class="p">])</span>
<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;INFODT_NX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;INFODT_NX&quot;</span><span class="p">])</span>

<span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;durationT2_T1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;INFODT_NX&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">download_data</span><span class="p">[</span><span class="s2">&quot;INFODT&quot;</span><span class="p">]</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>


<span class="c1"># Create longitudinal QDEC table</span>

<span class="n">download_data</span> <span class="o">=</span> <span class="n">download_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">)</span>
<span class="n">download_data</span> <span class="o">=</span> <span class="n">download_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_dup</span> <span class="o">=</span> <span class="n">download_data</span>
<span class="n">qdec_table</span> <span class="o">=</span> <span class="n">data_dup</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]]</span>
<span class="n">qdec_table</span><span class="p">[</span><span class="s2">&quot;fsid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dup</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">]</span>
<span class="n">qdec_table</span><span class="p">[</span><span class="s2">&quot;fsid-base&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dup</span><span class="p">[</span><span class="s2">&quot;PATNO_base&quot;</span><span class="p">]</span>
<span class="n">qdec_table</span><span class="p">[</span><span class="s2">&quot;years&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">qdec_table</span><span class="o">.</span><span class="n">index</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_dup</span><span class="p">[</span><span class="s2">&quot;durationT2_T1&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">qdec_table</span> <span class="o">=</span> <span class="n">qdec_table</span><span class="p">[[</span><span class="s2">&quot;fsid&quot;</span><span class="p">,</span> <span class="s2">&quot;fsid-base&quot;</span><span class="p">,</span> <span class="s2">&quot;years&quot;</span><span class="p">]]</span>

<span class="n">qdec_table</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;qdec_long_groups.dat&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare node for computation. it includes downloading the container</span>
<span class="c1"># this should be run on a server connected to the internet</span>

<span class="o">!</span><span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>singularity

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>

<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7378416&quot;</span>
<span class="c1"># bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">boutiques</span><span class="o">.</span><span class="n">descriptor2func</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_long_mris_slopes.py

<span class="c1"># Prepare the data with long_mris_slopes for longitudinal two stage model</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7378416&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="c1">#bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">qdec</span><span class="o">=</span><span class="s1">&#39;qdec_long_groups.dat&#39;</span><span class="p">,</span>
                                        <span class="n">meas</span><span class="o">=</span><span class="s1">&#39;thickness&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">time</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">stack_avg</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{hemi}</span><span class="s1">.long.thickness-avg.stack.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">stack_rate</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{hemi}</span><span class="s1">.long.thickness-rate.stack.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">stack_pc1fit</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{hemi}</span><span class="s1">.long.thickness-pc1fit.stack.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">stack_pc1</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{hemi}</span><span class="s1">.long.thickness-pc1.stack.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">stack_spc</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{hemi}</span><span class="s1">.long.thickness-spc.stack.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=FS_mris_slopes
#SBATCH --mem=4G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_slopes.out
#SBATCH --error=FS_mris_slopes.err
#SBATCH --time=20:0:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_long_mris_slopes.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-fsgd-file-for-the-group-analysis-baseline-t-test">
<h2>Create FSGD file for the group analysis - baseline - t-test<a class="headerlink" href="#create-fsgd-file-for-the-group-analysis-baseline-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hc_mix</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HC&quot;</span>
<span class="n">nc_mix</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PD-non-MCI&quot;</span>
<span class="n">mci_mix</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PD-MCI&quot;</span>

<span class="n">cohort_df_PDall</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">nc_mix</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">])</span>
<span class="n">cohort_df_PDMCI_HC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hc_mix</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">])</span>
<span class="n">cohort_df_PDnonMCI_HC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hc_mix</span><span class="p">,</span> <span class="n">nc_mix</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PD all group</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df_PDall</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;LEDD&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_first&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_PDall_baseline.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_PDall_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class PD-non-MCI</span><span class="se">\n</span><span class="s2">Class PD-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education LDopa</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_PDnonMCI_PDMCI_baseline.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_PDall_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_PDall_baseline.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1"># PD-MCI and HC group</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df_PDMCI_HC</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_first&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_PDMCI_HC_baseline.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_PDMCI_HC_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class HC</span><span class="se">\n</span><span class="s2">Class PD-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_HC_PDMCI_baseline.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_PDMCI_HC_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_PDMCI_HC_baseline.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            
<span class="c1"># PD-non-MCI and HC group</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df_PDnonMCI_HC</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_first&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_PDnonMCI_HC_baseline.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_PDnonMCI_HC_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class HC</span><span class="se">\n</span><span class="s2">Class PD-non-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_HC_PDnonMCI_baseline.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_PDnonMCI_HC_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_PDnonMCI_HC_baseline.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stack-images-for-group-analyses-baseline-t-test">
<h2>Stack images for group analyses - baseline - t-test<a class="headerlink" href="#stack-images-for-group-analyses-baseline-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_mris_preproc_group_baseline_ttest.py

<span class="c1"># Concatenate images from group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7387748&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">cachein</span><span class="o">=</span><span class="s2">&quot;thickness.fwhm15.fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_</span><span class="si">{group}</span><span class="s1">_baseline.fsgd&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">out</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.</span><span class="si">{group}</span><span class="s1">.thickness.15.baseline.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=FS_mris_preproc_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_preproc_group_baseline_ttest.out
#SBATCH --error=FS_mris_preproc_group_baseline_ttest.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_mris_preproc_group_baseline_ttest.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-fsgd-file-for-the-group-analysis-longitudinal-t-test">
<h2>Create FSGD file for the group analysis - longitudinal - t-test<a class="headerlink" href="#create-fsgd-file-for-the-group-analysis-longitudinal-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PD all group</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df_PDall</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;LEDD&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;LEDD&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_PDall_long.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_PDall_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class PD-non-MCI</span><span class="se">\n</span><span class="s2">Class PD-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education LDopa</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_PDnonMCI_PDMCI_long.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_PDall_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_PDall_long.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1"># PD-MCI and HC group</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df_PDMCI_HC</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_PDMCI_HC_long.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_PDMCI_HC_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class HC</span><span class="se">\n</span><span class="s2">Class PD-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_HC_PDMCI_long.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_PDMCI_HC_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_PDMCI_HC_long.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            
<span class="c1"># PD-non-MCI and HC group</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df_PDnonMCI_HC</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_PDnonMCI_HC_long.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_PDnonMCI_HC_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class HC</span><span class="se">\n</span><span class="s2">Class PD-non-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_HC_PDnonMCI_long.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_PDnonMCI_HC_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_PDnonMCI_HC_long.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stack-images-for-group-analyses-longitudinal-t-test">
<h2>Stack images for group analyses - longitudinal - t-test<a class="headerlink" href="#stack-images-for-group-analyses-longitudinal-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_mris_preproc_group_long_ttest.py

<span class="c1"># Concatenate images from group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7387748&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">cachein</span><span class="o">=</span><span class="s2">&quot;long.thickness-rate.fwhm15.fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_</span><span class="si">{group}</span><span class="s1">_long.fsgd&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">out</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.</span><span class="si">{group}</span><span class="s1">.thickness.rate.15.long.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=FS_mris_preproc_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_preproc_group_long_ttest.out
#SBATCH --error=FS_mris_preproc_group_long_ttest.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_mris_preproc_group_long_ttest.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-glm-model-for-the-group-analysis-baseline-t-test">
<h2>Run GLM model for the group analysis - baseline - t-test<a class="headerlink" href="#run-glm-model-for-the-group-analysis-baseline-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create group contrasts</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_PDnonMCI_PDMCI.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1 -1 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_HC_PDMCI.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1 -1 0 0 0 0 0 0&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_HC_PDnonMCI.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1 -1 0 0 0 0 0 0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_base_ttest.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411854&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>  
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;results_group_baseline_</span><span class="si">{group}</span><span class="s1">_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">inputdata</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.</span><span class="si">{group}</span><span class="s1">.thickness.15.baseline.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_</span><span class="si">{group}</span><span class="s1">_baseline.fsgd&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">con</span><span class="o">=</span><span class="s1">&#39;con_group_</span><span class="si">{group}</span><span class="s1">.mtx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">)</span> 
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_group_base_ttest.out
#SBATCH --error=FS_glm_group_base_test.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_base_ttest.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-glm-model-for-the-group-analysis-longitudinal-t-test">
<h2>Run GLM model for the group analysis - longitudinal - t-test<a class="headerlink" href="#run-glm-model-for-the-group-analysis-longitudinal-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_long_ttest.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411854&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>  
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;results_group_long_</span><span class="si">{group}</span><span class="s1">_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">inputdata</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.</span><span class="si">{group}</span><span class="s1">.thickness.rate.15.long.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_</span><span class="si">{group}</span><span class="s1">_long.fsgd&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">con</span><span class="o">=</span><span class="s1">&#39;con_group_</span><span class="si">{group}</span><span class="s1">.mtx&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">)</span> 
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_group_long_ttest.out
#SBATCH --error=FS_glm_group_long_ttest.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_long_ttest.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="correction-for-multiple-comparison-with-mri-glmfit-sim-t-test">
<h2>Correction for multiple comparison (with mri_glmfit-sim) - t-test<a class="headerlink" href="#correction-for-multiple-comparison-with-mri-glmfit-sim-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_sim_ttest.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411893&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span> <span class="s2">&quot;long&quot;</span><span class="p">]:</span>
            <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;results_group_</span><span class="si">{time}</span><span class="s1">_</span><span class="si">{group}</span><span class="s1">_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">CACHE_abs</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">,</span>
                                        <span class="n">cwp</span><span class="o">=</span><span class="s2">&quot;0.05&quot;</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_group_sim
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_sim_group_ttest.out
#SBATCH --error=FS_glm_sim_group_ttest.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_sim_ttest.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-fsgd-file-for-the-group-analysis-baseline-ancova">
<h2>Create FSGD file for the group analysis - baseline - ANCOVA<a class="headerlink" href="#create-fsgd-file-for-the-group-analysis-baseline-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hc_mix</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HC&quot;</span>
<span class="n">nc_mix</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PD-non-MCI&quot;</span>
<span class="n">mci_mix</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PD-MCI&quot;</span>

<span class="n">cohort_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hc_mix</span><span class="p">,</span> <span class="n">nc_mix</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_first&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_baseline.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class HC</span><span class="se">\n</span><span class="s2">Class PD-non-MCI</span><span class="se">\n</span><span class="s2">Class PD-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_baseline.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_baseline.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stack-images-for-group-analyses-baseline-ancova">
<h2>Stack images for group analyses - baseline - ANCOVA<a class="headerlink" href="#stack-images-for-group-analyses-baseline-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_mris_preproc_group_baseline.py

<span class="c1"># Concatenate images from group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7387748&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">cachein</span><span class="o">=</span><span class="s2">&quot;thickness.fwhm15.fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_baseline.fsgd&#39;</span><span class="p">,</span>
                                        <span class="n">out</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.thickness.15.baseline.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=FS_mris_preproc_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_preproc_group_baseline.out
#SBATCH --error=FS_mris_preproc_group_baseline.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_mris_preproc_group_baseline.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-fsgd-file-for-the-group-analysis-longitudinal-ancova">
<h2>Create FSGD file for the group analysis - longitudinal - ANCOVA<a class="headerlink" href="#create-fsgd-file-for-the-group-analysis-longitudinal-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">cohort_df</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort_long.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class HC</span><span class="se">\n</span><span class="s2">Class PD-non-MCI</span><span class="se">\n</span><span class="s2">Class PD-MCI</span><span class="se">\n</span><span class="s2">Variables age sex education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group_long.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort_long.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stack-images-for-group-analyses-longitudinal-ancova">
<h2>Stack images for group analyses - longitudinal - ANCOVA<a class="headerlink" href="#stack-images-for-group-analyses-longitudinal-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_mris_preproc_group_long.py

<span class="c1"># Concatenate images from group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7387748&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">cachein</span><span class="o">=</span><span class="s2">&quot;long.thickness-rate.fwhm15.fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_long.fsgd&#39;</span><span class="p">,</span>
                                        <span class="n">out</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.thickness.rate.15.long.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=FS_mris_preproc_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_preproc_group_long.out
#SBATCH --error=FS_mris_preproc_group_long.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_mris_preproc_group_long.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-fsgd-file-for-the-correlational-analysis-baseline">
<h2>Create FSGD file for the correlational analysis - baseline<a class="headerlink" href="#create-fsgd-file-for-the-correlational-analysis-baseline" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohort_df_PD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">nc_mix</span><span class="p">,</span> <span class="n">mci_mix</span><span class="p">])</span>

<span class="n">fsgd_cortThick_mcat</span> <span class="o">=</span> <span class="n">cohort_df_PD</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span><span class="s2">&quot;MCATOT&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_mcat</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_mcat</span><span class="p">[</span><span class="s2">&quot;dx_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PDall&quot;</span>
<span class="n">fsgd_cortThick_mcat</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_mcat</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_first&quot;</span>
<span class="n">fsgd_cortThick_mcat</span> <span class="o">=</span> <span class="n">fsgd_cortThick_mcat</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;dx_group&quot;</span><span class="p">,</span> <span class="s2">&quot;MCATOT&quot;</span><span class="p">,</span><span class="s2">&quot;AGE_AT_VISIT&quot;</span><span class="p">,</span><span class="s2">&quot;SEX&quot;</span><span class="p">,</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate fsgd files for correlational analysis</span>
<span class="c1"># make sure that the order of subjects in each FSGD file is the same as in long.qdec table</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDall&quot;</span><span class="p">]:</span>

    <span class="c1"># generate sample matrix</span>
    <span class="n">exec</span><span class="p">(</span>
        <span class="s2">&quot;fsgd_cortThick_mcat.to_csv(&#39;fsgd_corr_</span><span class="si">%s</span><span class="s2">_cort.txt&#39;, sep=&#39;</span><span class="se">\t</span><span class="s2">&#39;, index=False, header=None)&quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># generate file header</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_corr_</span><span class="si">{group}</span><span class="s2">_desc.txt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">MeasurementName MoCA</span><span class="se">\n</span><span class="s2">Class </span><span class="si">{group}</span><span class="se">\n</span><span class="s2">Variables MoCA age sex education</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">group</span><span class="o">=</span><span class="n">group</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># generate fsgd file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_corr_</span><span class="si">{group}</span><span class="s2">_group.fsgd&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;fsgd_corr_</span><span class="si">{group}</span><span class="s2">_desc.txt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
            <span class="s2">&quot;fsgd_corr_</span><span class="si">{group}</span><span class="s2">_cort.txt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
        <span class="p">]:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stack-images-for-correlational-analyses-baseline">
<h2>Stack images for correlational analyses - baseline<a class="headerlink" href="#stack-images-for-correlational-analyses-baseline" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_mris_preproc_corr.py

<span class="c1"># Concatenate images from correlation analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7387748&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDall&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">cachein</span><span class="o">=</span><span class="s2">&quot;thickness.fwhm15.fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_corr_</span><span class="si">{group}</span><span class="s1">_group.fsgd&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">out</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.corr.</span><span class="si">{group}</span><span class="s1">.thickness.rate.15.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=FS_mris_preproc_corr
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_preproc_corr.out
#SBATCH --error=FS_mris_preproc_corr.err
#SBATCH --time=0:10:0
#SBATCH --account=rrg-glatard

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_mris_preproc_corr.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-glm-model-for-the-correlational-analysis-baseline">
<h2>Run GLM model for the correlational analysis - baseline<a class="headerlink" href="#run-glm-model-for-the-correlational-analysis-baseline" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create contrast for MoCA scores</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_corr_MoCA.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0 1 0 0 0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_corr.py

<span class="c1"># GLM model for the correlational analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411854&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDall&quot;</span><span class="p">]:</span>   
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;results_corr_</span><span class="si">{group}</span><span class="s1">_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">inputdata</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.corr.</span><span class="si">{group}</span><span class="s1">.thickness.rate.15.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_corr_</span><span class="si">{group}</span><span class="s1">_group.fsgd&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">),</span>
                                        <span class="n">con</span><span class="o">=</span><span class="s1">&#39;con_corr_MoCA.mtx&#39;</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_corr
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_corr.out
#SBATCH --error=FS_glm_corr.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_corr.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-glm-model-for-the-group-analysis-baseline-ancova">
<h2>Run GLM model for the group analysis - baseline - ANCOVA<a class="headerlink" href="#run-glm-model-for-the-group-analysis-baseline-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create group contrasts</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_PDMCI_PDnonMCI.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0 -1 1 0 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_PDMCI_HC.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-1 0 1 0 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_PDnonMCI_HC.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-1 1 0 0 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_base.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411856&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>  
    <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;results_group_baseline_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">inputdata</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.thickness.15.baseline.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_baseline.fsgd&#39;</span><span class="p">,</span>
                                        <span class="n">con1</span><span class="o">=</span><span class="s2">&quot;con_group_PDMCI_PDnonMCI.mtx&quot;</span><span class="p">,</span> 
                                        <span class="n">con2</span><span class="o">=</span><span class="s2">&quot;con_group_PDMCI_HC.mtx&quot;</span><span class="p">,</span> 
                                        <span class="n">con3</span><span class="o">=</span><span class="s2">&quot;con_group_PDnonMCI_HC.mtx&quot;</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_group_base.out
#SBATCH --error=FS_glm_group_base.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_base.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-glm-model-for-the-group-analysis-longitudinal-ancova">
<h2>Run GLM model for the group analysis - longitudinal - ANCOVA<a class="headerlink" href="#run-glm-model-for-the-group-analysis-longitudinal-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_long.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411856&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>  
    <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;results_group_long_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">inputdata</span><span class="o">=</span><span class="s1">&#39;stack.</span><span class="si">{hemi}</span><span class="s1">.group.thickness.rate.15.long.mgh&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group_long.fsgd&#39;</span><span class="p">,</span>
                                        <span class="n">con1</span><span class="o">=</span><span class="s2">&quot;con_group_PDMCI_PDnonMCI.mtx&quot;</span><span class="p">,</span> 
                                        <span class="n">con2</span><span class="o">=</span><span class="s2">&quot;con_group_PDMCI_HC.mtx&quot;</span><span class="p">,</span> 
                                        <span class="n">con3</span><span class="o">=</span><span class="s2">&quot;con_group_PDnonMCI_HC.mtx&quot;</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_group_long.out
#SBATCH --error=FS_glm_group_long.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_long.py
</pre></div>
</div>
</div>
</div>
</section>
<section id="correction-for-multiple-comparison-with-mri-glmfit-sim">
<h2>Correction for multiple comparison (with mri_glmfit-sim)<a class="headerlink" href="#correction-for-multiple-comparison-with-mri-glmfit-sim" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_sim.py

<span class="c1"># GLM model for the group analysis - ANCOVA</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411893&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span> <span class="s2">&quot;long&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;results_group_</span><span class="si">{time}</span><span class="s1">_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">CACHE_abs</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">,</span>
                                        <span class="n">cwp</span><span class="o">=</span><span class="s2">&quot;0.05&quot;</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_group_sim
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_sim_group.out
#SBATCH --error=FS_glm_sim_group.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_sim.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_corr_sim.py

<span class="c1"># GLM model for the correlational analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411893&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDall&quot;</span><span class="p">]:</span> 
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;results_corr_</span><span class="si">{group}</span><span class="s1">_</span><span class="si">{hemi}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">),</span>
                                        <span class="n">CACHE_abs</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">,</span>
                                        <span class="n">cwp</span><span class="o">=</span><span class="s2">&quot;0.05&quot;</span>
                                       <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span>
#!/bin/bash
#SBATCH --job-name=glm_corr_sim
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_sim_corr.out
#SBATCH --error=FS_glm_sim_corr.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_corr_sim.py
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="vertex-wise-results">
<h1>Vertex-wise results<a class="headerlink" href="#vertex-wise-results" title="Link to this heading">#</a></h1>
<section id="correlation-with-moca-baseline">
<h2>correlation with MoCA - baseline<a class="headerlink" href="#correlation-with-moca-baseline" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># correlation results</span>

<span class="n">result_corr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_corr.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># print(&quot;Correlation analysis&quot;)</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDall&quot;</span><span class="p">]:</span>
    <span class="c1"># print(&quot;Significant correlation with MoCA in {group} group\n&quot;.format(group=group))</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="c1"># print(&quot;Hemisphere {hemi}\n&quot;.format(hemi=hemi))</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_corr_</span><span class="si">{group}</span><span class="s2">_</span><span class="si">{hemi}</span><span class="s2">/con_corr_MoCA/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_corr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">group</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_corr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;result_corr.txt&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span>
    <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;ClusterNo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VtxMax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Size(mm^2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPLow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPHi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NVtxs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;WghtVtx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Annot&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">results_corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PDall_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>PDall_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="group-differences-baseline-ancova">
<h2>group differences - baseline - ANCOVA<a class="headerlink" href="#group-differences-baseline-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># print(&quot;Group analysis\n&quot;)</span>
<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDMCI_PDnonMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;PDMCI_HC&quot;</span><span class="p">,</span> <span class="s2">&quot;PDnonMCI_HC&quot;</span><span class="p">]:</span>
    <span class="c1"># print(&quot;** Significant group differences between {pair} **\n&quot;.format(pair=pair))</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="c1"># print(&quot;Hemisphere {hemi}\n&quot;.format(hemi=hemi))</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_baseline_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_group</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;result_group_baseline.txt&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span>
    <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;ClusterNo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VtxMax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Size(mm^2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPLow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPHi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NVtxs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;WghtVtx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Annot&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">results_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PDMCI_PDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>PDMCI_PDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>PDMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>PDMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>PDnonMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>PDnonMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="differences-in-baseline-cortical-thickness-in-patients-with-parkinsons-disease">
<h3>Differences in baseline cortical thickness in patients with Parkinson’s disease.<a class="headerlink" href="#differences-in-baseline-cortical-thickness-in-patients-with-parkinsons-disease" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="group-differences-longitudinal-data-ancova">
<h2>group differences - longitudinal data - ANCOVA<a class="headerlink" href="#group-differences-longitudinal-data-ancova" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># print(&quot;Group analysis\n&quot;)</span>
<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDMCI_PDnonMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;PDMCI_HC&quot;</span><span class="p">,</span> <span class="s2">&quot;PDnonMCI_HC&quot;</span><span class="p">]:</span>
    <span class="c1"># print(&quot;** Significant group differences between {pair} **\n&quot;.format(pair=pair))</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="c1"># print(&quot;Hemisphere {hemi}\n&quot;.format(hemi=hemi))</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_long_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_group</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;result_group_long.txt&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span>
    <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;ClusterNo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VtxMax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Size(mm^2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPLow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPHi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NVtxs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;WghtVtx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Annot&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">results_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PDMCI_PDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2.4495</td>
      <td>3925</td>
      <td>1370.43</td>
      <td>-25.4</td>
      <td>-81.6</td>
      <td>-9.4</td>
      <td>0.00360</td>
      <td>0.00260</td>
      <td>0.00479</td>
      <td>1757</td>
      <td>2986.58</td>
      <td>lateraloccipital</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PDMCI_PDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>PDMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>PDMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>PDnonMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>PDnonMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="longitudinal-differences-in-the-cortical-thickness-in-patients-with-parkinsons-disease">
<h3>Longitudinal differences in the cortical thickness in patients with Parkinson’s disease.<a class="headerlink" href="#longitudinal-differences-in-the-cortical-thickness-in-patients-with-parkinsons-disease" title="Link to this heading">#</a></h3>
<p>PD-MCI versus PD-non-MCI, left hemisphere</p>
<img src="images/img_group_long_PDMCI_PDnonMCI_lh_mid.jpg"/></section>
</section>
<section id="group-differences-baseline-t-test">
<h2>group differences - baseline - t-test<a class="headerlink" href="#group-differences-baseline-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_baseline.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># print(&quot;Group analysis\n&quot;)</span>
<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="c1"># print(&quot;** Significant group differences between {pair} **\n&quot;.format(pair=pair))</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="c1"># print(&quot;Hemisphere {hemi}\n&quot;.format(hemi=hemi))</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_baseline_</span><span class="si">{pair}</span><span class="s2">_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_group</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;result_group_baseline.txt&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span>
    <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;ClusterNo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VtxMax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Size(mm^2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPLow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPHi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NVtxs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;WghtVtx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Annot&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">results_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PDnonMCI_PDMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>PDnonMCI_PDMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>HC_PDMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>HC_PDMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>HC_PDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>HC_PDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="differences-in-the-baseline-cortical-thickness-in-patients-with-parkinsons-disease">
<h3>Differences in the baseline cortical thickness in patients with Parkinson’s disease.<a class="headerlink" href="#differences-in-the-baseline-cortical-thickness-in-patients-with-parkinsons-disease" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="group-differences-longitudinal-t-test">
<h2>group differences - longitudinal - t-test<a class="headerlink" href="#group-differences-longitudinal-t-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_long.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># print(&quot;Group analysis\n&quot;)</span>
<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PDnonMCI_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;HC_PDnonMCI&quot;</span><span class="p">]:</span>
    <span class="c1"># print(&quot;** Significant group differences between {pair} **\n&quot;.format(pair=pair))</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="c1"># print(&quot;Hemisphere {hemi}\n&quot;.format(hemi=hemi))</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_long_</span><span class="si">{pair}</span><span class="s2">_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_group</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;result_group_long.txt&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span>
    <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;ClusterNo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VtxMax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Size(mm^2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MNIZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPLow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CWPHi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NVtxs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;WghtVtx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Annot&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">results_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PDnonMCI_PDMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>-2.5817</td>
      <td>114641</td>
      <td>1482.38</td>
      <td>-17.4</td>
      <td>-83.2</td>
      <td>-9.2</td>
      <td>0.00320</td>
      <td>0.00220</td>
      <td>0.00420</td>
      <td>1900</td>
      <td>-3350.08</td>
      <td>lingual</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PDnonMCI_PDMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>HC_PDMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>HC_PDMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>HC_PDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>HC_PDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h3>Longitudinal differences in the cortical thickness in patients with Parkinson’s disease.<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>PD-non-MCI versus PD-MCI, left hemisphere</p>
<img src="images/img_group_ttest_long_PDnonMCI_PDMCI_lh_mid.jpg"/></section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>Based on the results obtained, we were unable to reproduce the findings of the original paper. While the original study found greater atrophy in PD-MCI in the left hippocampus and left nucleus accumbens, our results showed significant group differences in the volume of the left amygdala. The original study found group differences in the change of volumes in the left caudate and the right hippocampus. We found group differences in the change of the right putamen volume.</p>
<p>We did not replicate voxel-wise correlation analysis. We found no correlation between the MoCA scores and the cortical thickness at baseline.</p>
<p>We did not replicate voxel-wise group differences in baseline and longitudinal analysis.</p>
<p>However, there is still room for improvement. For example, we could try preprocessing the images using the freesurfer version from the original study, as this may affect the results. Additionally, the small number of PD-MCI patients and the use of a mix of 12 and 24 month follow-up data instead of 18 month follow-up data could have influenced the results of the analysis.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./replications/mak-etal-2015"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Replication of [E. Mak et al., 2015]</p>
      </div>
    </a>
    <a class="right-next"
       href="../mak-etal-2017/README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Replication of [E. Mak et al., 2017]</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Mak et al, 2015</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-modules">Importing modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-preparation">Cohort Preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ppmi-study-data-files-download">PPMI study data files download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#livingpark-utility-notebook-download">LivingPark utility notebook download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data Exploration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demographics-characteristics">Demographics Characteristics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-definition">Cohort Definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cognitive-state">Cognitive State</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#age-at-visit">Age at visit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gender">Gender</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#education">Education</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disease-duration">Disease duration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clinical-characteristics">Clinical Characteristics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#levodopa-equivalent-daily-dose-ledd">Levodopa equivalent daily dose (LEDD)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hoehn-and-yahr-staging-h-y">Hoehn and Yahr staging (H&amp;Y)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unified-parkinsons-disease-rating-scale-updrs-iii">Unified Parkinson’s Disease Rating Scale (UPDRS III)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#montreal-cognitive-assessment-moca">Montreal Cognitive Assessment (MoCA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-mental-state-examination-mmse">Mini-Mental State Examination (MMSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geriatric-depression-scale-gds">Geriatric Depression Scale (GDS)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mri-availabilty">MRI Availabilty</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-aggregation">Data aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acceptable-visit-pairs">Acceptable visit pairs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-summary">Cohort Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-with-follow-up-after-12-months">Cohort with follow-up after 12 months</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-with-follow-up-after-24-months">Cohort with follow-up after 24 months</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-follow-up-after-both-12-and-24-months">Cohort follow up after both 12 and 24 months</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paper-replication">Paper replication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-processing">Image Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subcortical-structures">Subcortical Structures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-1-cross-sectional">preprocessing step 1 - cross-sectional</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-2-base-template">preprocessing step 2 - base template</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-3-longitudinally-processed-timepoints">preprocessing step 3 - longitudinally processed timepoints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step-4-qcache">preprocessing step 4 - Qcache</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-quality-control">Image quality control</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axial-baseline">Axial - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coronal-baseline">Coronal - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sagittal-baseline">Sagittal - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axial-longitudinal">Axial - longitudinal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coronal-longitudinal">Coronal - longitudinal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sagittal-longitudinal">Sagittal - longitudinal</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subcortical-structures-volume-computation">Subcortical Structures volume computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volumetric-analysis-of-subcortical-structures">Volumetric analysis of subcortical structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-covariance-ancova">Analysis of covariance (ANCOVA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-hoc-tukey-kramer-pairwise-comparisons">Post hoc Tukey-Kramer pairwise comparisons</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline-volumes">Baseline volumes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change">% change</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-analysis">Vertex-wise analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-the-vertex-data-with-long-mris-slopes-for-longitudinal-two-stage-model">Prepare the vertex data with long_mris_slopes for longitudinal two stage model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-baseline-t-test">Create FSGD file for the group analysis - baseline - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-baseline-t-test">Stack images for group analyses - baseline - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-longitudinal-t-test">Create FSGD file for the group analysis - longitudinal - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-longitudinal-t-test">Stack images for group analyses - longitudinal - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-baseline-t-test">Run GLM model for the group analysis - baseline - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-longitudinal-t-test">Run GLM model for the group analysis - longitudinal - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-for-multiple-comparison-with-mri-glmfit-sim-t-test">Correction for multiple comparison (with mri_glmfit-sim) - t-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-baseline-ancova">Create FSGD file for the group analysis - baseline - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-baseline-ancova">Stack images for group analyses - baseline - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis-longitudinal-ancova">Create FSGD file for the group analysis - longitudinal - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses-longitudinal-ancova">Stack images for group analyses - longitudinal - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-correlational-analysis-baseline">Create FSGD file for the correlational analysis - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-correlational-analyses-baseline">Stack images for correlational analyses - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-correlational-analysis-baseline">Run GLM model for the correlational analysis - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-baseline-ancova">Run GLM model for the group analysis - baseline - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis-longitudinal-ancova">Run GLM model for the group analysis - longitudinal - ANCOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-for-multiple-comparison-with-mri-glmfit-sim">Correction for multiple comparison (with mri_glmfit-sim)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-results">Vertex-wise results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-with-moca-baseline">correlation with MoCA - baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-baseline-ancova">group differences - baseline - ANCOVA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differences-in-baseline-cortical-thickness-in-patients-with-parkinsons-disease">Differences in baseline cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-longitudinal-data-ancova">group differences - longitudinal data - ANCOVA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#longitudinal-differences-in-the-cortical-thickness-in-patients-with-parkinsons-disease">Longitudinal differences in the cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-baseline-t-test">group differences - baseline - t-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differences-in-the-baseline-cortical-thickness-in-patients-with-parkinsons-disease">Differences in the baseline cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences-longitudinal-t-test">group differences - longitudinal - t-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Longitudinal differences in the cortical thickness in patients with Parkinson’s disease.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The LivingPark Project
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>