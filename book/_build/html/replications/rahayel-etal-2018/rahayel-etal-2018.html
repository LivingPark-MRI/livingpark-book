
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Replication: Rahayel et al, 2018 &#8212; LivingPark Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'replications/rahayel-etal-2018/rahayel-etal-2018';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Replication of [Paper name &amp; link]" href="../scherfler-etal-2011/README.html" />
    <link rel="prev" title="Replication of [Paper name &amp; link]" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="LivingPark Book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="LivingPark Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    LivingPark
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">A note on Reproducibility vs. Replicability</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../technical_challenges.html">Data Usage Agreement</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reproducibility studies (Harmonization [WIP])</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../agosta-etal-2013/README.html">F. Agosta et al., 2013</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../agosta-etal-2013/agosta-etal.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hanganu-etal-2014/README.html">A. Hanganu et al., 2014</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hanganu-etal-2014/hanganu-etal-2014.html">Replication: Hanganu <em>et al.</em>, 2014</a></li>














</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mak-etal-2015/README.html">E. Mak et al., 2015</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2015/mak-etal-2015.html">Mak et al, 2015</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mak-etal-2017/README.html">E. Mak et al., 2017</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2017/cohort_definition.html">Replication: Mak et al., 2017</a></li>



<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2017/fsl_siena.html">Failed DICOM to NIfTI conversion</a></li>

<li class="toctree-l2"><a class="reference internal" href="../mak-etal-2017/stat_analysis.html">Comparisons of percentage brain volume change and ventricular enlargement</a></li>

</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">S. Rahayel et al., 2018</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scherfler-etal-2011/README.html">C. Scherfler et al., 2011</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../scherfler-etal-2011/scherfler-etal.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shu-etal-2021/README.html">Z. Shu et al., 2021</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shu-etal-2021/shu-etal.html">Replication: Shu <em>et al</em>, 2020</a></li>




</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sterling-etal-2016/README.html">N. W. Sterling et al., 2016</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sterling-etal-2016/sterling-etal-2016.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tessa-etal-2014/README.html">C. Tessa et al., 2014</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tessa-etal-2014/Replication%20-%20%20Tessa%20et%20al.%202014.html">Introduction</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../zeighami-etal-2015/README.html">Y. Zeighami et al., 2015</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../zeighami-etal-2015/Yashar%20et.%20al%202015.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../zeighami-etal-2019/README.html">Y. Zeighami et al., 2019</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../zeighami-etal-2019/zeighami-etal-2019.html">Replication</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Utility packages</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../packages/ppmi_downloader.html">PPMI_Downloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../packages/livingpark_utils.html">LivingPark_Utils</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About LivingPark</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/LivingPark-MRI/">Organization repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/LivingPark-MRI/livingpark-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/LivingPark-MRI/livingpark-book/issues/new?title=Issue%20on%20page%20%2Freplications/rahayel-etal-2018/rahayel-etal-2018.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/replications/rahayel-etal-2018/rahayel-etal-2018.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Replication: Rahayel et al, 2018</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ppmi-cohort-preparation">PPMI cohort preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#study-data-download">Study data download</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rbd-score-computation">RBD Score computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusion-criteria">Inclusion criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-matching">Cohort matching</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paper-replication">Paper replication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-processing">Image Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing">Post Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis">Create FSGD file for the group analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses">1. Stack images for group analyses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis">2. Run GLM model for the group analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-for-multiple-comparison-with-mri-glmfit-sim">3. Correction for multiple comparison (with mri_glmfit-sim)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-analysis">4. Correlation Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences">4. Group differences</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thickness">Thickness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volume">Volume</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#area">Area</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="replication-rahayel-et-al-2018">
<h1>Replication: Rahayel <em>et al</em>, 2018<a class="headerlink" href="#replication-rahayel-et-al-2018" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This notebook attempts to replicate the following paper with the <a class="reference external" href="http://ppmi-info.org">PPMI</a> dataset:</p>
<div class="alert alert-block alert-success">
Shady Rahayel, et al. <a href=https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5957304/>Cortical and subcortical gray matter bases of cognitive deficits in REM sleep behavior disorder</a> Neurology, vol. 90, no. 20, pp. e1759–e1770, 2018.
</div><p>This study involved 52 patients with polysomnography confirmed RBD, including 17 with MCI and 35 without MCI. They were compared to 41 controls.</p>
<p>The demographics and clinical characteristics were as follows (table extracted from the paper):</p>
<img src="images/table1.png"/><p>The main results of the paper are:</p>
<ol class="arabic simple">
<li><p><strong>Montreal Cognitive Assessment</strong></p>
<ul class="simple">
<li><p>RBD patients with MCI scored lower vs RBD patients without MCI and controls. (Table 1)</p></li>
</ul>
</li>
<li><p><strong>FM100 performance and composite cognitive scores</strong></p>
<ul class="simple">
<li><p>RBD patients with MCI scored lower vs RBD patients without MCI and controls. (Table 1)</p></li>
</ul>
</li>
<li><p><strong>Systolic blood pressure drop</strong></p>
<ul class="simple">
<li><p>RBD patients with MCI had greater systolic blood pressure drop compared to RBD patients without MCI. (Table 1)</p></li>
</ul>
</li>
<li><p><strong>Domain subtype among RBD patients with MCI</strong></p>
<ul class="simple">
<li><p>single-domain subtype</p>
<ul>
<li><p>65% (11/17)</p></li>
</ul>
</li>
<li><p>multi-domain subtype</p>
<ul>
<li><p>35% (6/17)</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Cortical thickness difference between groups</strong></p>
<ul class="simple">
<li><p>MCI showed an increased rate of overall cortical thinning compared with both Non-MCI and HC (Table 2).</p>
<ul>
<li><p><strong>RBD patients with MCI vs RBD patients without MCI</strong></p>
<ul>
<li><p>RBD patients with MCI exhibited a more extensive pattern of cortical thinning compared to RBD patients without MCI</p></li>
<li><p>the left and right temporal lobe, the insula, the occipital cortex, the left medial superior frontal and anterior and posterior cingulate cortices, and the right temporal, superior frontal, posterior (table 2, figure 1A).</p></li>
</ul>
</li>
<li><p><strong>RBD patients with MCI vs controls</strong></p>
<ul>
<li><p>MCI - regions affected included the anterior temporal lobe, insula, middle and inferior frontal cortices, superior medial frontal and cingulate cortices, posterior temporal lobe and fusiform cortex, among others. (table 2, figure 1B)</p></li>
<li><p>Significant reduction was found in the precentral and postcentral cortices in RBD patients with MCI compared to controls.</p></li>
</ul>
</li>
<li><p><strong>RBD patients without MCI vs controls</strong></p>
<ul>
<li><p>without MCI presented cortical thinning in the left superior medial frontal and paracentral cortices and in the right precentral and paracentral cortices (table 2, figure 1C)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Cortical volume difference between groups</strong></p>
<ul class="simple">
<li><p>Looking at where RBD patients with MCI showed decreased cortical volume vs controls, significant reduction was found in the precentral and postcentral cortices (table 2, figure 1D).</p></li>
</ul>
</li>
</ol>
 <img src="images/table2.png"/>
 <img src="images/figure1.png"/>            
<ol class="arabic simple" start="7">
<li><p><strong>Subcortical surface difference between groups</strong></p>
<ul class="simple">
<li><p>Compared to RBD patients without MCI, RBD patients with MCI showed abnormal surface contraction (Table 3)</p>
<ul>
<li><p>RBD patients with MCI vs RBD patients without MCI</p>
<ul>
<li><p>MCI showed abnormal surface contraction in the left putamen and thalamus  (table 3, figure 1E)</p></li>
<li><p>No surface expansion was found in RBD patients with MCI.</p></li>
</ul>
</li>
<li><p>RBD patients with MCI vs controls</p>
<ul>
<li><p>MCI had abnormal surface contraction in the bilateral putamen and thalamus and in the left pallidum (table 3, figure 1F)</p></li>
<li><p>No surface expansion was found in RBD patients with MCI.</p></li>
</ul>
</li>
<li><p>RBD patients without MCI vs controls</p>
<ul>
<li><p>There were no significant between-group differences in subcortical surfaces.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
 <img src="images/table3.png"/>
<!--  
<img src="images/table4.png"/> 
<img src="images/table5.png"/>
<img src="images/table5-continued.png"/>
<img src="images/figure2.png"/> 
--></section>
<section id="initial-setup">
<h2>Initial setup<a class="headerlink" href="#initial-setup" title="Link to this heading">#</a></h2>
<!-- LivingPark notebooks use a *cache* directory to store analysis inputs and outputs. Inputs typically include PPMI Study Data and imaging data whereas outputs include processed images and other derivatives. Cache directories allow LivingPark notebooks to run in a few minutes as they reuse previously computed results. However, cache directories cannot be made public due to the PPMI Data Usage Agreement (DUA). Instead, they are stored on `login.bic.mni.mcgill.ca`, which requires a specific user name and password. In case you don't have access to the cache directory of this notebook, the next sections will download all the required imaging data from PPMI and recompute the results, which will take a few hours depending on your computer configuration. In the future, we will aim at storing this cache dataset on PPMI servers so that they can be accessed with a PPMI account. -->
<p>Let’s initialize the notebook directory and software dependencies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">livingpark_utils</span>

<span class="n">utils</span> <span class="o">=</span> <span class="n">livingpark_utils</span><span class="o">.</span><span class="n">LivingParkUtils</span><span class="p">()</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">utils</span><span class="o">.</span><span class="n">notebook_init</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This notebook was run on 2023-06-17 20:04:26 UTC +0000
</pre></div>
</div>
<div class="output text_html"><script>
    code_show = true;
    function code_toggle() {
        if (code_show) {
            $("div.input").hide();
        } else {
            $("div.input").show();
        }
        code_show = !code_show
    }
    $(document).ready(code_toggle);
</script>
<form action="javascript:code_toggle()">
    <input type="submit" value="Click here to toggle on/off the Python code.">
</form>
</div></div>
</div>
</section>
<section id="ppmi-cohort-preparation">
<h2>PPMI cohort preparation<a class="headerlink" href="#ppmi-cohort-preparation" title="Link to this heading">#</a></h2>
<p>We will build a PPMI cohort that matches the one used in the original study as much as possible. As in other LivingPark replications, we will use the same sample size as the original study. Our cohort will be built directly from PPMI Study Data files so that it can be replicated and updated whenever necessary.</p>
<section id="study-data-download">
<h3>Study data download<a class="headerlink" href="#study-data-download" title="Link to this heading">#</a></h3>
<p>We will start by downloading the PPMI Study Data files required to build our cohort:</p>
<ul class="simple">
<li><p>Demographics (to retrieve sex)</p></li>
<li><p>REM Sleep Behavior Disorder Questionnaire (for RBD score)</p></li>
<li><p>Prodromal History (for polysomnographies)</p></li>
<li><p>Primary Clinical Diagnosis (to include only healthy subjects)</p></li>
<li><p>Cognitive Categorization (to exclude subjects with dementia)</p></li>
<li><p>Medical Condition (to exclude neurological and psychiatric disorders)</p></li>
<li><p>Concomitant Medication Log (to exclude medication known to modify REM sleep architecture and muscle tone)</p></li>
<li><p>Montreal Cognitive Assessment MoCa (MoCA and MMSE scores)</p></li>
</ul>
<p>We will use the LivingPark utils library to download these files from the notebook. If files are already present in the notebook cache, they won’t be downloaded again. Otherwise, you will need to enter your PPMI username and password. In case you don’t have a PPMI account, you can request one <a class="reference external" href="http://ppmi-info.org">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">required_files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Demographics.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;REM_Sleep_Behavior_Disorder_Questionnaire.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Primary_Clinical_Diagnosis.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cognitive_Categorization.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Medical_Conditions_Log.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Concomitant_Medication_Log.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Prodromal_History.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Montreal_Cognitive_Assessment__MoCA_.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Socio-Economics.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Vital_Signs.csv&quot;</span>
<span class="p">]</span>

<span class="n">utils</span><span class="o">.</span><span class="n">download_ppmi_metadata</span><span class="p">(</span><span class="n">required_files</span><span class="p">,</span> <span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_3349853/2843202684.py:14: DeprecationWarning: Call to deprecated function download_ppmi_metadata.
This function will be remove in future version.
Moved to function `livinpark_utils::LivingParkUtils::get_study_files`.
  utils.download_ppmi_metadata(required_files, headless=False)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download skipped: No missing files!
</pre></div>
</div>
</div>
</div>
<p>We will also need file <code class="docutils literal notranslate"><span class="pre">MRI_info.csv</span></code> produced by another LivingPark notebook available at <a class="github reference external" href="https://github.com/LivingPark-MRI/livingpark-utils/blob/main/livingpark_utils/notebooks/mri_metadata.ipynb">LivingPark-MRI/livingpark-utils</a>. This file contains a list of T1-weighted MRIs usable for VBM.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # %%capture</span>
<span class="c1"># from livingpark_utils.scripts import (</span>
<span class="c1">#     mri_metadata,</span>
<span class="c1">#     pd_status,</span>
<span class="c1"># )</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rbd-score-computation">
<h3>RBD Score computation<a class="headerlink" href="#rbd-score-computation" title="Link to this heading">#</a></h3>
<p>The original study used polysomnography to diagnose REM Sleep Behavior Disorder.</p>
<p>While polysomnography is available in the PPMI prodromal cohort, as of July 2022 the number of subjects matching the inclusion/exclusion criteria in this cohort is not enough to replicate the original study (see also Section “Inclusion criteria”).</p>
<p>Instead, we will use the REM Sleep Behavior Disorder Screening Questionnaire (RSBDSQ) <a class="reference external" href="https://movementdisorders.onlinelibrary.wiley.com/doi/10.1002/mds.21740">[1]</a> to discriminate RBD patients from controls. This questionnaire consists of 13 yes/no questions that are summed to produce an RBD score. We computed the RBD score by summing the answers to each of the 13 questions. The answers to questions Q1 to Q9 (12 questions as Q6 is sub-divided in 4 parts) are directly availble in the RSBDSQ Study Data file. We computed the answer to Q10 (“I have/had a disease of the nervous system (e.g., stroke, head trauma, parkinsonism, RLS, narcolepsy, depression, epilepsy, inflammatory disease of the brain), which?”) by taking the max of the 8 corresponding disease variables in the RSBDSQ Study Data file. We also computed the answer to Q6 as the sum of Q6.1 to Q6.4 as it will use as inclusion criterion for controls.</p>
<p>Update: There are enough polysomnography subjects now.</p>
<p>We obtain the following distribution of RBD scores in the PPMI dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Load PPMI RSBDQ data</span>
<span class="n">rbdsq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;REM_Sleep_Behavior_Disorder_Questionnaire.csv&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Compute RBDSQ score</span>
<span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;RBDSQ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMVIVID&quot;</span><span class="p">]</span>  <span class="c1"># Q1</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMAGRAC&quot;</span><span class="p">]</span>  <span class="c1"># Q2</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMNOCTB&quot;</span><span class="p">]</span>  <span class="c1"># Q3</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;SLPLMBMV&quot;</span><span class="p">]</span>  <span class="c1"># Q4</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;SLPINJUR&quot;</span><span class="p">]</span>  <span class="c1"># Q5</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMVERBL&quot;</span><span class="p">]</span>  <span class="c1"># Q6.1</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMFIGHT&quot;</span><span class="p">]</span>  <span class="c1"># Q6.2</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMUMV&quot;</span><span class="p">]</span>  <span class="c1"># Q6.3</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMOBJFL&quot;</span><span class="p">]</span>  <span class="c1"># Q6.4</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;MVAWAKEN&quot;</span><span class="p">]</span>  <span class="c1"># Q7</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMREMEM&quot;</span><span class="p">]</span>  <span class="c1"># Q8</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;SLPDSTRB&quot;</span><span class="p">]</span>  <span class="c1"># Q9</span>
    <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span>  <span class="c1"># Q10</span>
        <span class="p">[</span>
            <span class="s2">&quot;BRNINFM&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DEPRS&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EPILEPSY&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HETRA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NARCLPSY&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PARKISM&quot;</span><span class="p">,</span>
            <span class="s2">&quot;RLS&quot;</span><span class="p">,</span>
            <span class="s2">&quot;STROKE&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;Q6&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMVERBL&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMFIGHT&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMUMV&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;DRMOBJFL&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Note: CNSOTHCM isn&#39;t present in data</span>

<span class="c1"># Check that max RBDSQ score is &lt;= 13</span>
<span class="k">assert</span> <span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;RBDSQ&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">13</span>

<span class="n">rbdsq</span> <span class="o">=</span> <span class="n">rbdsq</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Q6&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDSQ&quot;</span><span class="p">,</span> <span class="s2">&quot;STROKE&quot;</span><span class="p">,</span> <span class="s2">&quot;EPILEPSY&quot;</span><span class="p">]]</span>

<span class="n">rbdsq</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;RBDSQ&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of records&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5c22e741b3f85b2e2b6b43ad0eeced71f7890ebd04861d17e030e3d1cf47cb48.png" src="../../_images/5c22e741b3f85b2e2b6b43ad0eeced71f7890ebd04861d17e030e3d1cf47cb48.png" />
</div>
</div>
</section>
<section id="inclusion-criteria">
<h3>Inclusion criteria<a class="headerlink" href="#inclusion-criteria" title="Link to this heading">#</a></h3>
<p>To replicate the cohort in the original study, we used the following inclusion and exclusion criteria among PPMI subjects.</p>
<ul class="simple">
<li><p>Inclusion</p>
<ul>
<li><p>RBD Group</p>
<ol class="arabic simple">
<li><p>If not enough subjects with polysomnography, RBD Score &gt;= 5</p></li>
<li><p>Patients with polysomnography confirmed RBD according to the International Classification of Sleep Disorders</p></li>
<li><p>T1-weighted MRI available and usable for VBM (see <a class="reference external" href="https://github.com/LivingPark-MRI/livingpark-utils/blob/main/livingpark_utils/notebooks/mri_metadata.ipynb">MRI metadata notebook</a>).</p></li>
</ol>
</li>
<li><p>Control group</p>
<ol class="arabic simple">
<li><p>RBD Score &lt; 5</p></li>
<li><p>Score to Q6 of the RSBDSQ is 0.</p></li>
</ol>
</li>
</ul>
</li>
<li><p>Exclusion</p>
<ul>
<li><p>Participants with a history of:</p>
<ul>
<li><p>parkinsonism -&gt; PRIMDIAG = 17 (no PD nor other neurological disorder) or PRIMDIAG = 25 (prodromal)</p></li>
<li><p>dementia -&gt; COGSTATE = 3</p></li>
<li><p>stroke -&gt; REMSLEEP</p></li>
<li><p>head trauma</p></li>
<li><p>brain injury</p></li>
<li><p>unstable hypertension or diabetes -&gt; Concomittent log - CMINDC - 14 (hypertension) - 11 (diabetes)</p></li>
<li><p>chronic obstructive pulmonary disease -&gt; MHCAT 105 - 1G</p></li>
<li><p>claustrophobia</p></li>
<li><p>EEG abnormalities suggesting epilepsy -&gt; REMSLEEP</p></li>
<li><p>encephalitis</p></li>
<li><p>or any other neurologic disorders -&gt; MHCAT 114 - 1P + PRIMDIAG 17 or 97</p></li>
<li><p>or with artifacts on brain scans</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>In case multiple visits of a given subject are included in the RBD or Control group, we randomly select one of them for inclusion in the group and exclude the other ones. This selection ensures that a given subject is included at most once in the RBD group and at most once in the control group. In Section “Cohort matching”, we will ensure that a given subjet is included in at most one group.</p>
<p>We obtain the following group sizes:</p>
<!-- and a cutoff score of 6 to identify RBD subjects among PD subjects, consistently with the results presented in [[2]](https://www.sciencedirect.com#/science/article/pii/S138994571100164X). --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read data files</span>

<span class="c1"># TODO: FM-100, Domain Sub type, handedness (HANDED	SCREEN), Tonic activity (REM Sleep)</span>

<span class="c1"># Tonic - means that muscle contains mostly slow-contraction, long-duralibity fibers. These mucles have tendency to over-tension and to shorten (for example in spasticity). </span>
<span class="c1"># Phasic - means that muscle contains mostly quick-contraction, hi-power, short-duralibity fibers.</span>

<span class="c1"># Blood pressure</span>
<span class="c1"># was measured manually in supine position and after standing</span>
<span class="c1"># for 1 minute, and systolic blood pressure drop was calculated</span>
<span class="c1"># by subtracting supine from the standing measure</span>

<span class="c1"># Prodromal history</span>
<span class="n">prodr_hist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s1">&#39;Prodromal_History.csv&#39;</span><span class="p">))[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDDIAG&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDPSG&quot;</span><span class="p">]]</span>

<span class="c1"># MRI info</span>
<span class="n">mri</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;MRI_info.csv&quot;</span><span class="p">))[</span>
    <span class="p">[</span><span class="s2">&quot;Subject ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Visit code&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">mri</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Subject ID&quot;</span><span class="p">:</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;Visit code&quot;</span><span class="p">:</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Demographics</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Demographics.csv&quot;</span><span class="p">))[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;SEX&quot;</span><span class="p">]]</span>

<span class="c1"># Education</span>
<span class="n">edu</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Socio-Economics.csv&quot;</span><span class="p">))[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span>

<span class="c1"># Diagnosis</span>
<span class="n">diag</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Primary_Clinical_Diagnosis.csv&quot;</span><span class="p">))[</span>
    <span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;PRIMDIAG&quot;</span><span class="p">,</span> <span class="s2">&quot;OTHNEURO&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Vital Signs</span>
<span class="n">vital</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Vital_Signs.csv&quot;</span><span class="p">))[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;SYSSTND&quot;</span><span class="p">,</span> <span class="s2">&quot;SYSSUP&quot;</span><span class="p">]]</span>
<span class="n">vital</span><span class="p">[</span><span class="s2">&quot;SYSDROP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vital</span><span class="p">[</span><span class="s2">&quot;SYSSUP&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">vital</span><span class="p">[</span><span class="s2">&quot;SYSSTND&quot;</span><span class="p">]</span>

<span class="c1"># Cognitive Categorization</span>
<span class="n">cog_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Cognitive_Categorization.csv&quot;</span><span class="p">))[</span>
    <span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Medical condition</span>
<span class="n">med_cond</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Medical_Conditions_Log.csv&quot;</span><span class="p">))[</span>
    <span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;MHCAT&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;PATNO&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENT_ID&#39;</span><span class="p">])[[</span><span class="s1">&#39;MHCAT&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="c1"># aggregate all codes in a tuple</span>

<span class="c1"># Medication</span>
<span class="n">meds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Concomitant_Medication_Log.csv&quot;</span><span class="p">))[</span>
    <span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;CMTRT&quot;</span><span class="p">,</span> <span class="s2">&quot;CMINDC&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;PATNO&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENT_ID&#39;</span><span class="p">])[[</span><span class="s1">&#39;CMTRT&#39;</span><span class="p">,</span> <span class="s1">&#39;CMINDC&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># aggregate all meds in a tuple</span>

<span class="c1"># MoCA TODO: Screening vs baseline?</span>
<span class="n">moca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;Montreal_Cognitive_Assessment__MoCA_.csv&quot;</span><span class="p">)</span>
<span class="p">)[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;MCATOT&quot;</span><span class="p">,</span> <span class="s2">&quot;INFODT&quot;</span><span class="p">]]</span>
<span class="c1"># MoCA - Use screening instead of baseline.</span>
<span class="n">moca</span> <span class="o">=</span> <span class="n">moca</span><span class="p">[</span><span class="n">moca</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;BL&quot;</span><span class="p">]</span>
<span class="n">moca</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">moca</span><span class="p">[</span><span class="s2">&quot;EVENT_ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SC&quot;</span><span class="p">,</span> <span class="s2">&quot;BL&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Clean UPDRS file. Impute missing ON/OFF values.</span>
<span class="c1"># It produces MDS_UPDRS_Part_III_clean.csv file</span>
<span class="c1"># from livingpark_utils.scripts import pd_status</span>

<span class="n">updrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">study_files_dir</span><span class="p">,</span> <span class="s2">&quot;MDS_UPDRS_Part_III_clean.csv&quot;</span><span class="p">)</span>
<span class="p">)[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;NP3TOT&quot;</span><span class="p">]]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">included</span><span class="p">(</span><span class="n">subjects</span><span class="p">,</span> <span class="n">with_mci</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return subjects complying to the inclusion criteria mentioned before.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    subjects: DataFrame. Has to contain columns PATNO and EVENT_ID and PRIMDIAG</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">temp</span> <span class="o">=</span>  <span class="p">(</span>
        <span class="n">subjects</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span> <span class="c1"># Sex is available</span>
             <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;PRIMDIAG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">])],</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span> <span class="c1"># Subject is healthy or prodromal</span>
             <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">mri</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>  <span class="c1"># MRI usable for VBM is available</span>
             <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cog_cat</span><span class="p">[</span><span class="n">cog_cat</span><span class="p">[</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">with_mci</span> <span class="k">else</span> <span class="n">cog_cat</span><span class="p">[</span><span class="s2">&quot;COGSTATE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">])</span>  <span class="c1"># No dementia - with MCI or without MCI</span>
             <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">med_cond</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
             <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">meds</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">edu</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">moca</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">vital</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">updrs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
                 <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;EVENT_ID&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;RBDSQ&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Q6&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;SEX&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Age&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Description&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;PRIMDIAG&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;COGSTATE&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;MHCAT&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;CMTRT&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;CMINDC&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;EDUCYRS&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;MCATOT&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;SYSDROP&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;NP3TOT&quot;</span>
                    <span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>
    
    <span class="c1"># Check medical condition and return</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_mhcat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="c1"># no neurologic disorders or chronic obstructive pulmonary disease</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;1P&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">or</span> <span class="s2">&quot;1G&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
    <span class="c1"># Check concomitant medication log indication and return</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_indication</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="c1"># no hypertension or diabetes</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">14</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">or</span> <span class="mi">11</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">temp</span><span class="p">[</span>
                <span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="s2">&quot;MHCAT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_mhcat</span><span class="p">))</span> 
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="s2">&quot;CMINDC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_indication</span><span class="p">))</span> 
<span class="c1">#                 &amp; (temp[&quot;MCATOT&quot;].notnull())</span>
               <span class="p">]</span>  <span class="c1"># No neurological or psychiatric illness and no evidence of central nervous system (CNS) comorbidities</span>

<span class="c1"># Extract RBD subjects and controls according to inclusion criteria</span>
<span class="c1"># Sample one entry (event and T1 description) per subject in each group so that a subject happens at most once in a group (between-group consistency will be ensured in cohort matching)</span>
<span class="c1"># Sort entries by PATNO to improve reproducibility of this notebook</span>
    
<span class="c1"># RBD with Polynosomgraphy</span>
<span class="n">rbds_poly_mci</span> <span class="o">=</span>  <span class="n">included</span><span class="p">((</span><span class="n">prodr_hist</span><span class="p">[(</span><span class="n">prodr_hist</span><span class="p">[</span><span class="s1">&#39;RBDDIAG&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">prodr_hist</span><span class="p">[</span><span class="s1">&#39;RBDPSG&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rbdsq</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)),</span> <span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rbds_poly_mci</span><span class="p">)</span> <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span> 
    <span class="n">rbds_poly_mci</span> <span class="o">=</span> <span class="p">(</span><span class="n">rbds_poly_mci</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;PATNO&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">))</span>
    
<span class="n">rbds_poly_wo_mci</span> <span class="o">=</span>  <span class="n">included</span><span class="p">((</span><span class="n">prodr_hist</span><span class="p">[(</span><span class="n">prodr_hist</span><span class="p">[</span><span class="s1">&#39;RBDDIAG&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">prodr_hist</span><span class="p">[</span><span class="s1">&#39;RBDPSG&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rbdsq</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)))</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rbds_poly_wo_mci</span><span class="p">)</span> <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span> 
    <span class="n">rbds_poly_wo_mci</span> <span class="o">=</span> <span class="p">(</span><span class="n">rbds_poly_wo_mci</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;PATNO&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">))</span>
    
<span class="c1"># RBD with SQ</span>
<span class="n">rbds_sq_mci</span> <span class="o">=</span> <span class="p">(</span><span class="n">included</span><span class="p">(</span><span class="n">rbdsq</span><span class="p">[(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;RBDSQ&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;STROKE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;EPILEPSY&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)],</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;PATNO&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">))</span>
<span class="n">rbds_sq_wo_mci</span> <span class="o">=</span> <span class="p">(</span><span class="n">included</span><span class="p">(</span><span class="n">rbdsq</span><span class="p">[(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;RBDSQ&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;STROKE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;EPILEPSY&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;PATNO&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">))</span>

<span class="c1"># Controls</span>
<span class="n">controls</span> <span class="o">=</span> <span class="p">(</span><span class="n">included</span><span class="p">(</span><span class="n">rbdsq</span><span class="p">[(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;RBDSQ&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;Q6&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;STROKE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rbdsq</span><span class="p">[</span><span class="s2">&quot;EPILEPSY&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;PATNO&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of RBD subjects w/ polysomnography w/o MCI: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_poly_wo_mci</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of RBD subjects w/ polysomnography w/ MCI: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_poly_mci</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of RBD subjects w/ RBD Score computation w/o MCI: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_sq_wo_mci</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of RBD subjects w/ RBD Score computation w/ MCI: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_sq_mci</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of control subjects: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rbds_poly_wo_mci</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">35</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">rbds_poly_mci</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We don&#39;t have enough RBD subjects with polysomnography. Let&#39;s use RBD subjects without polysomnography in this replication.&quot;</span><span class="p">)</span>
    <span class="n">rbds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbds_sq_mci</span><span class="p">,</span><span class="n">rbds_sq_wo_mci</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We have enough RBD subjects with polysomnography to use in this replication.&quot;</span><span class="p">)</span>
    <span class="n">rbds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbds_poly_mci</span><span class="p">,</span><span class="n">rbds_poly_wo_mci</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of RBD subjects w/ polysomnography w/o MCI: 55
Number of RBD subjects w/ polysomnography w/ MCI: 4
Number of RBD subjects w/ RBD Score computation w/o MCI: 128
Number of RBD subjects w/ RBD Score computation w/ MCI: 11
Number of control subjects: 220

We don&#39;t have enough RBD subjects with polysomnography. Let&#39;s use RBD subjects without polysomnography in this replication.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rbds_mci</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbds_sq_mci</span><span class="p">,</span><span class="n">rbds_poly_mci</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">])</span>
<span class="n">rbds_wo_mci</span> <span class="o">=</span> <span class="n">rbds_sq_wo_mci</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>128
</pre></div>
</div>
</div>
</div>
</section>
<section id="cohort-matching">
<h3>Cohort matching<a class="headerlink" href="#cohort-matching" title="Link to this heading">#</a></h3>
<p>While the RBD group has a good number of subjects without MCI, it lacks subjects with MCI. So we will not be able to reproduce the ratio of subjects with MCI and non MCI.</p>
<p>On the other hand, the Control group built previously give us a lot of flexibility to build a cohort that matches the one in the original study, due to their large sample size compared to the original cohort. We adopted the following approach to construct a matching cohort:</p>
<ol class="arabic simple">
<li><p>Randomly select 16 control women and 25 control men, to reproduce the F/M balance in the original study</p></li>
<li><p>Find 48 subjects from the RBD group without MCI that best match age and sex in the selected control group. We matched sex by direct sampling of males and females using the same proportion as in the original study. We matched age using a nearest-neighbor approach.</p></li>
</ol>
<!-- ---

- controls 61% men - 25 | 65.5 (6.6) 
- RBD 81% men - 42 | 67.9 (4.4) 
- RBD w MCI 71% men - 12 | 64.4 (7.2)
- RBC wo MCI 86% men - 30 | 63.2 (8.2)

--- -->
<p>We obtain the following cohort:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">nn_match</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">df_2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">cat_variables</span><span class="p">,</span> <span class="n">num_variables</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find len(sample1) rows in df_2 such that variables are matched with sample1.</span>

<span class="sd">    sample1: samples in group1</span>
<span class="sd">    df_2: dataframe with subjects in group 2</span>
<span class="sd">    n2: desired sample size for group 2</span>
<span class="sd">    cat_variables: categorical variables to match</span>
<span class="sd">    num_variables: numerical variables to match</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find index of nearest neighbor of x in df</span>

<span class="sd">        * x: a dataframe row</span>
<span class="sd">        * df: a dataframe</span>
<span class="sd">        * variables: variables to match. Should be normalized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;dist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">var</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;dist&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[</span>
            <span class="mi">0</span>
        <span class="p">]</span>  <span class="c1">## there&#39;s probably a better way to do it but it works</span>

    <span class="c1"># Check assumptions</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="c1">#     assert n1 &lt;= n2</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">num_variables</span> <span class="o">+</span> <span class="n">cat_variables</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample1</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">df_2</span>

    <span class="c1"># Copy original dataframe to leave it untouched</span>
    <span class="n">df_2_</span> <span class="o">=</span> <span class="n">df_2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">sample1_</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Remove from df_2 all subjects that are in sample1</span>
    <span class="n">df_2_</span> <span class="o">=</span> <span class="n">df_2_</span><span class="p">[</span><span class="o">~</span><span class="n">df_2_</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sample1</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])]</span>

    <span class="c1"># Normalize variables to match to compute meaningful distances</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">num_variables</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">df_2_</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">df_2_</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">(</span><span class="n">df_2_</span><span class="p">,</span> <span class="n">sample1_</span><span class="p">):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span>

    <span class="c1"># For each subject in sampled group 1,</span>
    <span class="c1"># find one or more subject in sampled group 2, without replacement.</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">n1</span>  <span class="c1"># loop over sample1</span>
        <span class="n">df_2_cat</span> <span class="o">=</span> <span class="n">df_2_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_2_cat</span><span class="p">[</span><span class="n">df_2_cat</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="n">sample1_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">]])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">df_2_cat</span> <span class="o">=</span> <span class="n">df_2_cat</span><span class="p">[</span><span class="n">df_2_cat</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="n">sample1_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Warning: cannot find subject with </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">==</span><span class="si">{</span><span class="n">sample1_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="si">}</span><span class="s2"> in sample 2. Removing constraint.&quot;</span>
                <span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">nn</span><span class="p">(</span><span class="n">sample1_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">df_2_cat</span><span class="p">,</span> <span class="n">num_variables</span><span class="p">)</span>
        <span class="n">df_2_</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="n">sample2</span> <span class="o">=</span> <span class="n">df_2</span><span class="p">[</span><span class="n">df_2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">indices</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">sample2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rbds_mci_ids_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;rbds_mci.csv&#39;</span><span class="p">)</span>
<span class="n">rbds_wo_mci_ids_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;rbds_wo_mci.csv&#39;</span><span class="p">)</span>
<span class="n">controls_ids_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;controls.csv&#39;</span><span class="p">)</span>

<span class="n">controls</span> <span class="o">=</span> <span class="n">controls</span><span class="p">[</span><span class="n">controls</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">controls_ids_file</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])]</span>

<span class="n">rbds_mci</span> <span class="o">=</span> <span class="n">rbds_mci</span><span class="p">[</span><span class="n">rbds_mci</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rbds_mci_ids_file</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])]</span>

<span class="n">rbds_wo_mci</span> <span class="o">=</span> <span class="n">rbds_wo_mci</span><span class="p">[</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rbds_wo_mci_ids_file</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])]</span>
<span class="n">rbds_wo_mci</span> <span class="o">=</span> <span class="n">rbds_wo_mci</span><span class="p">[</span><span class="o">~</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])]</span>

<span class="n">rbds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbds_mci</span><span class="p">,</span> <span class="n">rbds_wo_mci</span><span class="p">])</span>

<span class="c1"># Randomly select 16 control women and 25 control men, to reproduce F/M balance in original paper</span>
<span class="c1"># controls = pd.concat(</span>
<span class="c1">#     [</span>
<span class="c1">#         controls[controls[&quot;SEX&quot;] == 0].sample(</span>
<span class="c1">#             n=16, random_state=random_seed</span>
<span class="c1">#         ),</span>
<span class="c1">#         controls[controls[&quot;SEX&quot;] == 1].sample(n=25, random_state=random_seed),</span>
<span class="c1">#     ]</span>
<span class="c1"># )</span>

<span class="c1"># # Match with RBD subjects</span>
<span class="c1"># rbds_wo_mci = nn_match(controls, rbds_wo_mci, 35, [&quot;SEX&quot;], [&quot;Age&quot;], random_state=random_seed)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">cohort_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;RBD Patients w/ MCI&quot;</span><span class="p">,</span> <span class="s2">&quot;RBD Patients w/o MCI&quot;</span><span class="p">,</span> <span class="s2">&quot;Controls&quot;</span><span class="p">])</span>

<span class="n">cohort_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Subjects, No.&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_mci</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="p">)]</span>
<span class="n">cohort_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;F/M, No.&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_mci</span><span class="p">[</span><span class="n">rbds_mci</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_mci</span><span class="p">[</span><span class="n">rbds_mci</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="n">controls</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="n">controls</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">cohort_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Age, mean +/- SD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rbds_mci</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rbds_mci</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">cohort_stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RBD Patients w/ MCI</th>
      <th>RBD Patients w/o MCI</th>
      <th>Controls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Subjects, No.</th>
      <td>11</td>
      <td>35</td>
      <td>41</td>
    </tr>
    <tr>
      <th>F/M, No.</th>
      <td>5/6</td>
      <td>16/19</td>
      <td>16/25</td>
    </tr>
    <tr>
      <th>Age, mean +/- SD</th>
      <td>69.0 +/- 4.2</td>
      <td>64.1 +/- 8.0</td>
      <td>63.9 +/- 8.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The demographics parameters of the selected PPMI subjects seem comparable to the ones in the initial study.</p>
<p>Let’s do basic sanity checks in this cohort:</p>
<ul class="simple">
<li><p>A subject appears at most once in each group</p></li>
<li><p>A subject does not appear in more than one group</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rbds_mci</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">rbds_mci</span>
<span class="p">),</span> <span class="s2">&quot;Some subjects are present more than once in RBD MCI group&quot;</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">rbds_wo_mci</span>
<span class="p">),</span> <span class="s2">&quot;Some subjects are present more than once in RBD Non-MCI group&quot;</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">controls</span>
<span class="p">),</span> <span class="s2">&quot;Some subjects are present more than once in controls&quot;</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">rbds</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">0</span>
<span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Some subjects are present in controls and rbd group </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">controls</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="n">rbds</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All sanity checks passed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All sanity checks passed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenate both groups in cohort DataFrame</span>
<span class="n">rbds_wo_mci</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;RBD&quot;</span>
<span class="n">rbds_mci</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;RBD-MCI&quot;</span>
<span class="n">controls</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Control&quot;</span>
<span class="n">cohort</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbds_mci</span><span class="p">,</span> <span class="n">rbds_wo_mci</span><span class="p">,</span> <span class="n">controls</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rbds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbds_mci</span><span class="p">,</span> <span class="n">rbds_wo_mci</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we generate a cohort id that uniquely identifies the cohort built previously. We will use this id to avoid recomputing the same results multiple times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cohort_id = utils.cohort_id(cohort)</span>
<span class="c1"># print(f&quot;Cohort id: {cohort_id}&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Save patient ids</span>
<span class="c1"># filename = f&quot;rahayel-etal-patnos-{cohort_id}.csv&quot;</span>
<span class="c1"># cohort[&quot;PATNO&quot;].to_csv(filename, index=False)</span>
<span class="c1"># print(f&quot;Cohort patient ids saved in {filename}. Do not share this file publicly!&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>The following concommittant medication have been found in the cohort. Make sure that they don’t violate the following exclusion criteria from the original paper:</p>
<p>No current treatment with medications known to modify REM sleep architecture and muscle tone such as serotonin reuptake inhibitors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Iterable</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">rich</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rich.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cohort_summary</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">hc</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">mci</span><span class="p">,</span> <span class="n">rbds</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">agg</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s2">&quot;4.1f&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; ± &quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agg</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agg</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="si">:{</span><span class="n">f</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">agg</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">D</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">agg</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="si">:{</span><span class="n">f</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">D</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">gender_ratio</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
        <span class="n">male_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;SEX&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">male_count</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">male_count</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PATNO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span>

    <span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="n">rbds</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">mci</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">nc</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">hc</span><span class="o">.</span><span class="n">describe</span><span class="p">()]</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">rich</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">SIMPLE_HEAVY</span><span class="p">,</span> <span class="n">show_footer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Subject groups&quot;</span><span class="p">,</span> <span class="n">footer</span><span class="o">=</span><span class="s2">&quot;Values expressed as mean ± SD.&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;RBD&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;RBD-MCI&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;RBD-non-MCI&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;HC&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s2">&quot;.0f&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Age (y)&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;Age range&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; - &quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;Gender (male, %)&quot;</span><span class="p">,</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">rbds</span><span class="p">),</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">mci</span><span class="p">),</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">nc</span><span class="p">),</span> <span class="n">gender_ratio</span><span class="p">(</span><span class="n">hc</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Education (y)&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;UPDRS-III, total&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;NP3TOT&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;MoCA score, /30&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;MCATOT&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
        <span class="s2">&quot;Systolic blood pressure drop, mm Hg&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">gen_row</span><span class="p">(</span><span class="n">D</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">agg</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;SYSDROP&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohort_summary</span><span class="p">(</span>
    <span class="n">hc</span><span class="o">=</span><span class="n">controls</span><span class="p">,</span>
    <span class="n">nc</span><span class="o">=</span><span class="n">rbds_wo_mci</span><span class="p">,</span>
    <span class="n">mci</span><span class="o">=</span><span class="n">rbds_mci</span><span class="p">,</span>
    <span class="n">rbds</span><span class="o">=</span><span class="n">rbds</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Demographic and clinical characteristics&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">                           Demographic and clinical characteristics                            </span>
                                                                                               
 <span style="font-weight: bold"> Subject groups                      </span> <span style="font-weight: bold"> RBD         </span> <span style="font-weight: bold"> RBD-MCI     </span> <span style="font-weight: bold"> RBD-non-MCI </span> <span style="font-weight: bold"> HC          </span> 
 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 
  n                                     46            11            35            41           
  Age (y)                               65.3 ±  7.5   69.0 ±  4.2   64.1 ±  8.0   63.9 ±  8.3  
  Age range                             46.3 - 80.0   63.1 - 76.0   46.3 - 80.0   45.9 - 80.9  
  Gender (male, %)                      25, 54.3%     6, 54.5%      19, 54.3%     25, 61.0%    
  Education (y)                         16.2 ±  3.2   16.8 ±  4.5   16.1 ±  2.9   18.2 ±  3.8  
  UPDRS-III, total                       3.2 ±  3.7    4.8 ±  4.3    2.7 ±  3.5                
  MoCA score, /30                       27.5 ±  2.3   26.0 ±  4.2   27.7 ±  2.0                
  Systolic blood pressure drop, mm Hg    6.1 ± 14.9    9.1 ± 17.9    5.1 ± 13.9                
 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 
 <span style="font-weight: bold"> Values expressed as mean ± SD.      </span> <span style="font-weight: bold">             </span> <span style="font-weight: bold">             </span> <span style="font-weight: bold">             </span> <span style="font-weight: bold">             </span> 
                                                                                               
</pre>
</div></div>
</div>
</section>
</section>
<section id="paper-replication">
<h2>Paper replication<a class="headerlink" href="#paper-replication" title="Link to this heading">#</a></h2>
<p>Having our cohort is ready, we will now proceed to reproduce the MRI-based results of the paper.</p>
</section>
<section id="image-processing">
<h2>Image Processing<a class="headerlink" href="#image-processing" title="Link to this heading">#</a></h2>
<p>The authors conducted cortical reconstruction and volumetric segmentation on the MRI data using the Freesurfer 5.3 image analysis software, following standard procedures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # copy working directory to Compute Canada server</span>

<span class="c1"># # please provide the following:</span>
<span class="c1"># hostname = &quot;narval1.computecanada.ca&quot;  # please change to the hostname you use</span>
<span class="c1"># username = &quot;niyonx&quot;  # please provide your Compute Canada username</span>
<span class="c1"># password = &quot;&quot;  # please provide your Compute Canada password</span>

<span class="c1"># from paramiko import SSHClient</span>
<span class="c1"># from scp import SCPClient</span>

<span class="c1"># ssh = SSHClient()</span>
<span class="c1"># ssh.load_system_host_keys()</span>
<span class="c1"># ssh.connect(</span>
<span class="c1">#     hostname=hostname,</span>
<span class="c1">#     username=username,</span>
<span class="c1">#     password=password,</span>
<span class="c1"># )</span>


<span class="c1"># # SCPCLient takes a paramiko transport as its only argument</span>
<span class="c1"># scp = SCPClient(ssh.get_transport())</span>

<span class="c1"># cdir = &quot;./&quot;</span>
<span class="c1"># scp.put(cdir, &quot;rahayel&quot;, recursive=True)</span>

<span class="c1"># # scp.get(&#39;file_path_on_remote_machine&#39;, &#39;file_path_on_local_machine&#39;)</span>

<span class="c1"># scp.close()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # download MRI data</span>
<span class="c1"># downloader = livingpark_utils.download.ppmi.Downloader(utils.study_files_dir, headless=False)</span>

<span class="c1"># utils.get_T1_nifti_files(cohort, default=downloader, symlink=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> slurm_magic
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # # prepare node for computation. it includes downloading the container</span>

<span class="c1"># ! module load singularity</span>

<span class="c1"># from boutiques import bosh</span>

<span class="c1"># zid = &quot;zenodo.7411893&quot;</span>
<span class="c1"># bosh([&quot;exec&quot;, &quot;prepare&quot;, zid])</span>
<span class="c1"># # freesurfer = boutiques.descriptor2func.function(zid)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # exclude subjects from the dataset if the image was already preprocessed</span>

<span class="c1"># import os.path</span>

<span class="c1"># data_to_process = cohort</span>

<span class="c1"># for patno in data_to_process[&quot;PATNO&quot;]:</span>

<span class="c1">#     if os.path.exists(&quot;preproc_FS_codes/exitcode_{0}.txt&quot;.format(patno)) == True:</span>
<span class="c1">#         exitcode = open(&quot;preproc_FS_codes/exitcode_{0}.txt&quot;.format(patno), &quot;r&quot;)</span>

<span class="c1">#         if exitcode.read() == &quot;0&quot;:</span>
<span class="c1">#             data = data_to_process.drop[&quot;[0]&quot;.format(patno)]</span>
<span class="c1">#             print(&quot;The image ID&quot;, patno, &quot;has been preprocessed.&quot;)</span>
<span class="c1">#         elif exitcode.read() != &quot;0&quot;:</span>
<span class="c1">#             print(&quot;The image ID&quot;, patno, &quot;has not been preprocessed successfully.&quot;)</span>

<span class="c1">#     else:</span>
<span class="c1">#         print(&quot;The image ID&quot;, patno, &quot;has not been preprocessed at all.&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from livingpark_utils.dataset import ppmi</span>

<span class="c1"># ppmi.find_nifti_file_in_cache(cohort[&quot;PATNO&quot;], cohort[&quot;EVENT_ID&quot;], cohort[&quot;Description&quot;])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save df with all timepoints as json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="n">cohort</span><span class="p">[</span><span class="s2">&quot;PATNO_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="n">data_to_process</span> <span class="o">=</span> <span class="n">cohort</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">small_df</span> <span class="o">=</span> <span class="n">data_to_process</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;File name&quot;</span><span class="p">]]</span>
<span class="n">json_data</span> <span class="o">=</span> <span class="n">small_df</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;json_data.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">fout</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS.py


<span class="c1"># save proprocessing script to submit jobs to the server later </span>
<span class="c1"># copy your FreeSurfer license to FS_license/license.txt or update the license path below</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.4043546&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>

<span class="n">task_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SLURM_ARRAY_TASK_ID&quot;</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;json_data.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="n">subject_map</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>

    
<span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/niyonx/projects/rrg-glatard/niyonx/freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                        <span class="nb">input</span><span class="o">=</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;File name&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">],</span> <span class="n">qcache_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                        <span class="n">subjid</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">]),</span>
                                       <span class="p">)</span>

<span class="n">exitcode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_fs</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;preproc_FS_codes/exitcode_</span><span class="si">{0}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">subject_map</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">][</span><span class="n">task_id</span><span class="p">])),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exitcode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting preprocess_FS.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --array=0-86 --job-name=FS_preproc --account=rrg-glatard --mem=16G --cpus-per-task=4 --nodes=1 --output=FS_preproc.out --error=FS_preproc.err --time=168:0:0
#!/bin/bash
# SBATCH --job-name=FS_preproc
# SBATCH --account=rrg-glatard
# SBATCH --mem=4G
# SBATCH --cpus-per-task=2
# SBATCH --nodes=1
# SBATCH --output=FS_preproc.out
# SBATCH --error=FS_preproc.err
# SBATCH --time=10:0:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Submitted batch job 16203801\n&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="post-processing">
<h2>Post Processing<a class="headerlink" href="#post-processing" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract cortical thickness and volumes</span>

<span class="n">aseg_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span>

<span class="n">ROIsThickness</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;G_and_S_cingul-Mid-Ant&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S_circular_insula_ant&quot;</span><span class="p">,</span>
    <span class="s2">&quot;G&amp;S_cingul-Mid-Post&quot;</span><span class="p">,</span>
    <span class="s2">&quot;G_temporal_middle&quot;</span><span class="p">,</span>
    <span class="s2">&quot;G_precentral&quot;</span><span class="p">,</span>
    <span class="s2">&quot;G_postcentral&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S_precentral-inf-part&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S_precentral-sup-part&quot;</span>
<span class="p">]</span>


<span class="n">ROIs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Left-Thalamus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Left-Caudate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Left-Putamen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Left-Pallidum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Left-Hippocampus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Left-Amygdala&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Left-Accumbens-area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Thalamus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Caudate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Putamen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Pallidum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Hippocampus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Amygdala&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Right-Accumbens-area&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">for</span> <span class="n">subj</span> <span class="ow">in</span> <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
        <span class="c1"># extract TIV</span>
        <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{subidd}</span><span class="s2">/stats/aseg.stats&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">subidd</span><span class="o">=</span><span class="n">subj</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">session</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="c1"># read all lines in a list</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="c1"># check if string present on a current line</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Estimated Total Intracranial Volume&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">aseg_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                        <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">subj</span><span class="p">,</span> <span class="s2">&quot;TIV</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">])</span>


        <span class="c1"># extract cortical thickness</span>
        <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{subidd}</span><span class="s2">/stats/</span><span class="si">{hemisphere}</span><span class="s2">.aparc.a2009s.stats&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">subidd</span><span class="o">=</span><span class="n">subj</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">,</span> <span class="n">hemisphere</span><span class="o">=</span><span class="n">hemi</span>
            <span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="c1"># read all lines in a list</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Mean Thickness&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">aseg_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                            <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">subj</span><span class="p">,</span>
                            <span class="s2">&quot;thickness_</span><span class="si">{hemi}{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">])</span>

        <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;thickness_bil</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;thickness_lh</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">)]</span>
            <span class="o">+</span> <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;thickness_rh</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">)]</span>
        <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># extract ROIs volume</span>
        <span class="k">for</span> <span class="n">roi</span> <span class="ow">in</span> <span class="n">ROIs</span><span class="p">:</span>

            <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{subidd}</span><span class="s2">/stats/aseg.stats&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">subidd</span><span class="o">=</span><span class="n">subj</span><span class="p">,</span> <span class="n">ses</span><span class="o">=</span><span class="n">session</span>
            <span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">aseg_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                            <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">subj</span><span class="p">,</span>
                            <span class="n">roi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1"># calculate bilateral volume</span>

        <span class="n">ROIs_bil</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Thalamus</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
            <span class="s2">&quot;Caudate</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
            <span class="s2">&quot;Putamen</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
            <span class="s2">&quot;Pallidum</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
            <span class="s2">&quot;Hippocampus</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
            <span class="s2">&quot;Amygdala</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
            <span class="s2">&quot;Accumbens-area</span><span class="si">{ses}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ses</span><span class="o">=</span><span class="n">session</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">roi_bil</span> <span class="ow">in</span> <span class="n">ROIs_bil</span><span class="p">:</span>
            <span class="n">aseg_table</span><span class="p">[</span><span class="n">roi_bil</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;Right-</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roi_bil</span><span class="p">)]</span>
                <span class="o">+</span> <span class="n">aseg_table</span><span class="p">[</span><span class="s2">&quot;Left-</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">roi_bil</span><span class="p">)]</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ROI_data</span> <span class="o">=</span> <span class="n">cohort</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">aseg_table</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ROI_MCI</span> <span class="o">=</span> <span class="n">ROI_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ROI_data</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;RBD-MCI&quot;</span><span class="p">]</span>
<span class="n">ROI_nonMCI</span> <span class="o">=</span> <span class="n">ROI_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ROI_data</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;RBD&quot;</span><span class="p">]</span>
<span class="n">ROI_HC</span> <span class="o">=</span> <span class="n">ROI_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ROI_data</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Control&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># variables = [</span>
<span class="c1">#     &quot;Thalamus&quot;,</span>
<span class="c1">#     &quot;Caudate&quot;,</span>
<span class="c1">#     &quot;Putamen&quot;,</span>
<span class="c1">#     &quot;Pallidum&quot;,</span>
<span class="c1">#     &quot;Hippocampus&quot;,</span>
<span class="c1">#     &quot;Amygdala&quot;,</span>
<span class="c1">#     &quot;Accumbens-area&quot;,</span>
<span class="c1">#     # &quot;thickness&quot;,</span>
<span class="c1"># ]</span>

<span class="c1"># from scipy.stats import ttest_ind</span>

<span class="c1"># ROI_MCI = ROI_data.loc[ROI_data[&quot;group&quot;] == &quot;RBD-MCI&quot;]</span>
<span class="c1"># ROI_nonMCI = ROI_data.loc[ROI_data[&quot;group&quot;] == &quot;RBD&quot;]</span>
<span class="c1"># ROI_HC = ROI_data.loc[ROI_data[&quot;group&quot;] == &quot;Control&quot;]</span>
<span class="c1"># ttest = {}</span>

<span class="c1"># for var in variables:</span>
<span class="c1">#     [</span>
<span class="c1">#         ttest[&quot;ttest_t_&quot; + var + &quot;_PDMCI_HC&quot;],</span>
<span class="c1">#         ttest[&quot;ttest_p_&quot; + var + &quot;_PDMCI_HC&quot;],</span>
<span class="c1">#     ] = ttest_ind(ROI_PDMCI[var], ROI_HC[var])</span>
<span class="c1">#     [</span>
<span class="c1">#         ttest[&quot;ttest_t_&quot; + var + &quot;_PDMCI_PDnonMCI&quot;],</span>
<span class="c1">#         ttest[&quot;ttest_p_&quot; + var + &quot;_PDMCI_PDnonMCI&quot;],</span>
<span class="c1">#     ] = ttest_ind(ROI_PDMCI[var], ROI_PDnonMCI[var])</span>
<span class="c1">#     [</span>
<span class="c1">#         ttest[&quot;ttest_t_&quot; + var + &quot;_PDnonMCI_HC&quot;],</span>
<span class="c1">#         ttest[&quot;ttest_p_&quot; + var + &quot;_PDnonMCI_HC&quot;],</span>
<span class="c1">#     ] = ttest_ind(ROI_PDnonMCI[var], ROI_HC[var])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-fsgd-file-for-the-group-analysis">
<h2>Create FSGD file for the group analysis<a class="headerlink" href="#create-fsgd-file-for-the-group-analysis" title="Link to this heading">#</a></h2>
<!-- In summary, our study replicated the findings of [original study] that showed significant gray matter atrophy in individuals with PD+RBD compared to those with PD alone. Our voxel-wise analysis revealed significant clusters of decreased gray matter volume in [regions], which were further confirmed by ROI analyses. Moreover, we found that gray matter atrophy in [regions] was associated with worse [clinical measure] in PD+RBD.

These findings have important implications for understanding the neuropathological mechanisms underlying cognitive deficits in PD+RBD. Our results suggest that gray matter atrophy in specific brain regions may be a useful biomarker for identifying individuals at risk of developing cognitive impairment in PD+RBD. This information could be used to inform early interventions and prevent or slow the progression of cognitive decline in this population.

Overall, our study provides further evidence for the importance of examining the neurobiological basis of cognitive impairment in PD+RBD, and underscores the potential value of neuroimaging biomarkers for identifying at-risk individuals and developing targeted interventions. --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Finding the mean of the column having NaN</span>
<span class="n">mean_value</span><span class="o">=</span><span class="n">ROI_data</span><span class="p">[[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">ROI_data</span><span class="p">[[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ROI_data</span><span class="p">[[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">mean_value</span><span class="p">)</span>
<span class="n">ROI_data</span><span class="p">[[</span><span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span>

<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">ROI_data</span><span class="p">[[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;SEX&quot;</span><span class="p">,</span> <span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]]</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Input&quot;</span>
<span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span><span class="s2">&quot;PATNO&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">fsgd_cortThick_diff</span> <span class="o">=</span> <span class="n">fsgd_cortThick_diff</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Input&quot;</span><span class="p">,</span> <span class="s2">&quot;PATNO&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;SEX&quot;</span><span class="p">,</span> <span class="s2">&quot;EDUCYRS&quot;</span><span class="p">]</span>
<span class="p">]</span>


<span class="c1"># generate sample matrix</span>
<span class="n">fsgd_cortThick_diff</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;fsgd_group_cort.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># generate file header</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_group_desc.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">&quot;GroupDescriptorFile 1</span><span class="se">\n</span><span class="s2">Title GroupDifferences</span><span class="se">\n</span><span class="s2">Class RBD-MCI</span><span class="se">\n</span><span class="s2">Class RBD</span><span class="se">\n</span><span class="s2">Class Control</span><span class="se">\n</span><span class="s2">Variables Age Sex Education</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;fsgd_cort_group.fsgd&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fsgd_group_desc.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;fsgd_group_cort.txt&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1"># make sure that the order of subjects in FSGD file is the same as in long.qdec table</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stack-images-for-group-analyses">
<h2>1. Stack images for group analyses<a class="headerlink" href="#stack-images-for-group-analyses" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bosh exec launch -x --imagepath /home/niyonx/projects/rrg-glatard/niyonx/freesurfer-freesurfer-7.1.1.simg.tmp zenodo.7387748 invocation.json</span>

<span class="c1"># bosh exec launch -x --imagepath /home/niyonx/projects/rrg-glatard/niyonx/freesurfer-freesurfer-7.1.1.simg.tmp zenodo.7411856 invocation2.json </span>

<span class="c1"># salloc --time=1:0:0 --mem-per-cpu=1G --ntasks=2 --account=rrg-glatard</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> preprocess_FS_mris_preproc_group.py

<span class="c1"># Concatenate images from group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7387748&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/niyonx/projects/rrg-glatard/niyonx/freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                            <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                            <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                            <span class="n">cachein</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">.fwhm10.fsaverage&quot;</span><span class="p">,</span>
                                            <span class="n">target</span><span class="o">=</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span>
                                            <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group.fsgd&#39;</span><span class="p">,</span>
                                            <span class="n">out</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;stack.</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">.group.</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">.rate.10.mgh&#39;</span><span class="p">,</span>
                                        <span class="p">)</span>


        <span class="n">exitcode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_fs</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>


        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;preproc_FS_codes/exitcode_mris_preproc_group_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exitcode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting preprocess_FS_mris_preproc_group.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --job-name=FS_mris_preproc_group --account=rrg-glatard --mem=1G --cpus-per-task=2 --nodes=1 --output=FS_mris_preproc_group.out --error=FS_mris_preproc_group.err --time=0:10:0
#!/bin/bash
#SBATCH --job-name=FS_mris_preproc_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_mris_preproc_group.out
#SBATCH --error=FS_mris_preproc_group.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python preprocess_FS_mris_preproc_group.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Submitted batch job 17973821\n&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-glm-model-for-the-group-analysis">
<h2>2. Run GLM model for the group analysis<a class="headerlink" href="#run-glm-model-for-the-group-analysis" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create group contrasts</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_RBDMCI_RBDnonMCI.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1 -1 0 0 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_RBDMCI_HC.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1 0 -1 0 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;con_group_RBDnonMCI_HC.mtx&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0 1 -1 0 0 0 0 0 0 0 0 0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411856&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>  
    <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/niyonx/projects/rrg-glatard/niyonx/freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                            <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span>
                                            <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                            <span class="n">outdir</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;results_group_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                            <span class="n">inputdata</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;stack.</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">.group.</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">.rate.10.mgh&#39;</span><span class="p">,</span>
                                            <span class="n">fsgd</span><span class="o">=</span><span class="s1">&#39;fsgd_cort_group.fsgd&#39;</span><span class="p">,</span>
                                            <span class="n">con1</span><span class="o">=</span><span class="s2">&quot;con_group_RBDMCI_RBDnonMCI.mtx&quot;</span><span class="p">,</span> 
                                            <span class="n">con2</span><span class="o">=</span><span class="s2">&quot;con_group_RBDMCI_HC.mtx&quot;</span><span class="p">,</span> 
                                            <span class="n">con3</span><span class="o">=</span><span class="s2">&quot;con_group_RBDnonMCI_HC.mtx&quot;</span>
                                        <span class="p">)</span>


        <span class="n">exitcode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_fs</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>


        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;preproc_FS_codes/exitcode_glm_group_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exitcode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting glm_group.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --job-name=glm_group --account=rrg-glatard --mem=1G --cpus-per-task=2 --nodes=1 --output=FS_glm_group.out --error=FS_glm_group.err --time=0:10:0
#!/bin/bash
#SBATCH --job-name=glm_group
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_group.out
#SBATCH --error=FS_glm_group.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Submitted batch job 17974801\n&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="correction-for-multiple-comparison-with-mri-glmfit-sim">
<h2>3. Correction for multiple comparison (with mri_glmfit-sim)<a class="headerlink" href="#correction-for-multiple-comparison-with-mri-glmfit-sim" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_group_sim.py

<span class="c1"># GLM model for the group analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411893&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>  
    <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">]:</span>
        <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                            <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                            <span class="nb">dir</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;results_group_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                            <span class="n">CACHE_abs</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">,</span>
                                            <span class="n">cwp</span><span class="o">=</span><span class="s2">&quot;0.05&quot;</span>
                                        <span class="p">)</span>


        <span class="n">exitcode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_fs</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>


        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;preproc_FS_codes/exitcode_glm_sim_group_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exitcode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting glm_group_sim.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --job-name=glm_group_sim --account=rrg-glatard --mem=1G --cpus-per-task=2 --nodes=1 --output=FS_glm_sim_group.out --error=FS_glm_sim_group.err --time=0:10:0
#!/bin/bash
#SBATCH --job-name=glm_group_sim
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_sim_group.out
#SBATCH --error=FS_glm_sim_group.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_group_sim.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Submitted batch job 17975008\n&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="correlation-analysis">
<h2>4. Correlation Analysis<a class="headerlink" href="#correlation-analysis" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> glm_corr_sim.py

<span class="c1"># GLM model for the correlational analysis</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boutiques</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques</span><span class="w"> </span><span class="kn">import</span> <span class="n">bosh</span>
<span class="n">zid</span> <span class="o">=</span> <span class="s2">&quot;zenodo.7411893&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">boutiques.descriptor2func</span><span class="w"> </span><span class="kn">import</span> <span class="n">function</span>
<span class="n">freesurfer</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">zid</span><span class="p">)</span>


<span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;RBD-MCI&quot;</span><span class="p">,</span> <span class="s2">&quot;RBD&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">]:</span> 
        <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">]:</span>
            <span class="n">out_fs</span> <span class="o">=</span> <span class="n">freesurfer</span><span class="p">(</span><span class="s1">&#39;--imagepath&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer-freesurfer-7.1.1.simg.tmp&#39;</span><span class="p">,</span>
                                            <span class="n">license</span><span class="o">=</span><span class="s2">&quot;FS_license/license.txt&quot;</span><span class="p">,</span>
                                            <span class="nb">dir</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;results_corr_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                            <span class="n">CACHE_abs</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">,</span>
                                            <span class="n">cwp</span><span class="o">=</span><span class="s2">&quot;0.05&quot;</span>
                                        <span class="p">)</span>


            <span class="n">exitcode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_fs</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>


            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;preproc_FS_codes/exitcode_glm_sim_corr_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exitcode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting glm_corr_sim.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sbatch</span> --job-name=glm_corr_sim --account=rrg-glatard --mem=1G --cpus-per-task=2 --nodes=1 --output=FS_glm_sim_corr.out --error=FS_glm_sim_corr.err --time=0:10:0
#!/bin/bash
#SBATCH --job-name=glm_corr_sim
#SBATCH --mem=1G
#SBATCH --cpus-per-task=2
#SBATCH --nodes=1
#SBATCH --output=FS_glm_sim_corr.out
#SBATCH --error=FS_glm_sim_corr.err
#SBATCH --time=0:10:0

. venv/bin/activate # opens virtual environment. change depending where you proprocess the data  

module load singularity

python glm_corr_sim.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Submitted batch job 17974715\n&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="group-differences">
<h2>4. Group differences<a class="headerlink" href="#group-differences" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_thickness.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;RBDMCI_RBDnonMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDMCI_HC&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDnonMCI_HC&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_thickness_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_area.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;RBDMCI_RBDnonMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDMCI_HC&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDnonMCI_HC&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_area_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group differences</span>

<span class="n">result_group</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result_group_volume.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;RBDMCI_RBDnonMCI&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDMCI_HC&quot;</span><span class="p">,</span> <span class="s2">&quot;RBDnonMCI_HC&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">hemi</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lh&quot;</span><span class="p">,</span> <span class="s2">&quot;rh&quot;</span><span class="p">]:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
            <span class="s2">&quot;results_group_volume_</span><span class="si">{hemi}</span><span class="s2">/con_group_</span><span class="si">{pair}</span><span class="s2">/cache.th13.abs.sig.cluster.summary&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">hemi</span><span class="o">=</span><span class="n">hemi</span><span class="p">,</span> <span class="n">pair</span><span class="o">=</span><span class="n">pair</span>
            <span class="p">),</span>
            <span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">always_print</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pair</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">hemi</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">always_print</span> <span class="ow">or</span> <span class="s2">&quot;ClusterNo&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># print(line)</span>
                <span class="n">result_group</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">always_print</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_group_differences</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="n">results_group</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
      <span class="sa">f</span><span class="s2">&quot;result_group_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span>
      <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span>
      <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
      <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
      <span class="n">names</span><span class="o">=</span><span class="p">[</span>
          <span class="s2">&quot;ClusterNo&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
          <span class="s2">&quot;VtxMax&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Size(mm^2)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;MNIX&quot;</span><span class="p">,</span>
          <span class="s2">&quot;MNIY&quot;</span><span class="p">,</span>
          <span class="s2">&quot;MNIZ&quot;</span><span class="p">,</span>
          <span class="s2">&quot;CWP&quot;</span><span class="p">,</span>
          <span class="s2">&quot;CWPLow&quot;</span><span class="p">,</span>
          <span class="s2">&quot;CWPHi&quot;</span><span class="p">,</span>
          <span class="s2">&quot;NVtxs&quot;</span><span class="p">,</span>
          <span class="s2">&quot;WghtVtx&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Annot&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">results_group</span>
</pre></div>
</div>
</div>
</div>
<section id="thickness">
<h3>Thickness<a class="headerlink" href="#thickness" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_group_differences</span><span class="p">(</span><span class="s2">&quot;thickness&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RBDMCI_RBDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>RBDMCI_RBDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>RBDMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>RBDMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>RBDnonMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>3.7051</td>
      <td>82672</td>
      <td>1886.75</td>
      <td>-23.2</td>
      <td>9.0</td>
      <td>48.6</td>
      <td>0.00020</td>
      <td>0.00000</td>
      <td>0.00040</td>
      <td>3760</td>
      <td>7260.87</td>
      <td>superiorfrontal</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>3.9012</td>
      <td>44439</td>
      <td>1457.59</td>
      <td>-7.9</td>
      <td>29.9</td>
      <td>44.8</td>
      <td>0.00060</td>
      <td>0.00020</td>
      <td>0.00100</td>
      <td>3431</td>
      <td>6611.69</td>
      <td>superiorfrontal</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>3.0922</td>
      <td>15249</td>
      <td>962.00</td>
      <td>-24.9</td>
      <td>-61.6</td>
      <td>33.6</td>
      <td>0.01792</td>
      <td>0.01554</td>
      <td>0.02030</td>
      <td>1786</td>
      <td>3364.37</td>
      <td>superiorparietal</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>4.2766</td>
      <td>94834</td>
      <td>844.34</td>
      <td>-14.9</td>
      <td>-31.5</td>
      <td>57.2</td>
      <td>0.04918</td>
      <td>0.04528</td>
      <td>0.05308</td>
      <td>2123</td>
      <td>4170.69</td>
      <td>precentral</td>
    </tr>
    <tr>
      <th>9</th>
      <td>RBDnonMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>6.2425</td>
      <td>57976</td>
      <td>2600.27</td>
      <td>21.0</td>
      <td>12.1</td>
      <td>58.0</td>
      <td>0.00020</td>
      <td>0.00000</td>
      <td>0.00040</td>
      <td>5504</td>
      <td>11961.02</td>
      <td>superiorfrontal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="volume">
<h3>Volume<a class="headerlink" href="#volume" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_group_differences</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RBDMCI_RBDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>-4.2435</td>
      <td>73650</td>
      <td>1224.98</td>
      <td>-32.9</td>
      <td>0.5</td>
      <td>12.1</td>
      <td>0.00818</td>
      <td>0.00659</td>
      <td>0.00978</td>
      <td>3144</td>
      <td>-6544.42</td>
      <td>insula</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RBDMCI_RBDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>-5.2369</td>
      <td>20395</td>
      <td>1185.73</td>
      <td>33.9</td>
      <td>5.3</td>
      <td>6.6</td>
      <td>0.00818</td>
      <td>0.00659</td>
      <td>0.00978</td>
      <td>3419</td>
      <td>-7534.96</td>
      <td>insula</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>-2.5417</td>
      <td>131414</td>
      <td>1031.29</td>
      <td>37.8</td>
      <td>21.6</td>
      <td>23.0</td>
      <td>0.02504</td>
      <td>0.02227</td>
      <td>0.02780</td>
      <td>1871</td>
      <td>-3148.36</td>
      <td>rostralmiddlefrontal</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RBDMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>-3.4755</td>
      <td>1645</td>
      <td>1153.77</td>
      <td>-33.2</td>
      <td>-0.1</td>
      <td>13.2</td>
      <td>0.01077</td>
      <td>0.00898</td>
      <td>0.01256</td>
      <td>2959</td>
      <td>-5655.41</td>
      <td>insula</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RBDMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>RBDnonMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>RBDnonMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>3.3167</td>
      <td>94688</td>
      <td>1339.71</td>
      <td>21.1</td>
      <td>9.8</td>
      <td>58.7</td>
      <td>0.00300</td>
      <td>0.00200</td>
      <td>0.00400</td>
      <td>2512</td>
      <td>4478.70</td>
      <td>superiorfrontal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="area">
<h3>Area<a class="headerlink" href="#area" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_group_differences</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ClusterNo</th>
      <th>Max</th>
      <th>VtxMax</th>
      <th>Size(mm^2)</th>
      <th>MNIX</th>
      <th>MNIY</th>
      <th>MNIZ</th>
      <th>CWP</th>
      <th>CWPLow</th>
      <th>CWPHi</th>
      <th>NVtxs</th>
      <th>WghtVtx</th>
      <th>Annot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RBDMCI_RBDnonMCI_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>RBDMCI_RBDnonMCI_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>-3.1031</td>
      <td>64622</td>
      <td>1833.18</td>
      <td>46.7</td>
      <td>-53.5</td>
      <td>30.1</td>
      <td>0.02840</td>
      <td>0.02544</td>
      <td>0.03135</td>
      <td>4439</td>
      <td>-7891.18</td>
      <td>inferiorparietal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RBDMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>RBDMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>-3.4467</td>
      <td>43806</td>
      <td>1810.55</td>
      <td>65.6</td>
      <td>-30.7</td>
      <td>3.3</td>
      <td>0.03096</td>
      <td>0.02780</td>
      <td>0.03410</td>
      <td>4318</td>
      <td>-8120.79</td>
      <td>superiortemporal</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RBDnonMCI_HC_lh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>RBDnonMCI_HC_rh</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>Based on the table above, we notice that most of the results were different. The only result which match is the cortical thinning in the left superior medial frontal in RBD patients without MCI presented when compared to Controls.</p>
<p>For the most part, we were not able to reproduce the results and got some additional significant differences in surface area and volume, as opposed to the paper.</p>
<p>Compared to the paper, we had 11 subjects for the RBD MCI patients instead of 17 subjects. If we are able to gather more subjects, there might be room for improvement.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./replications/rahayel-etal-2018"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Replication of [Paper name &amp; link]</p>
      </div>
    </a>
    <a class="right-next"
       href="../scherfler-etal-2011/README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Replication of [Paper name &amp; link]</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ppmi-cohort-preparation">PPMI cohort preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#study-data-download">Study data download</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rbd-score-computation">RBD Score computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusion-criteria">Inclusion criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohort-matching">Cohort matching</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paper-replication">Paper replication</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image-processing">Image Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing">Post Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-fsgd-file-for-the-group-analysis">Create FSGD file for the group analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stack-images-for-group-analyses">1. Stack images for group analyses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-glm-model-for-the-group-analysis">2. Run GLM model for the group analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correction-for-multiple-comparison-with-mri-glmfit-sim">3. Correction for multiple comparison (with mri_glmfit-sim)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-analysis">4. Correlation Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-differences">4. Group differences</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thickness">Thickness</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volume">Volume</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#area">Area</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The LivingPark Project
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>